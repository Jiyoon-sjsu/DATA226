[0m14:56:41.527564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8f78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e669220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e668ec0>]}


============================== 14:56:41.534134 | e3a7b1f8-b6ad-4ccf-9413-c44df08966cf ==============================
[0m14:56:41.534134 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:56:41.535683 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'no_print': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'printer_width': '80', 'warn_error': 'None', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'quiet': 'False', 'use_colors': 'True', 'debug': 'False', 'empty': 'False', 'write_json': 'True'}
[0m14:56:44.836754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3a7b1f8-b6ad-4ccf-9413-c44df08966cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119d7290>]}
[0m14:56:44.934613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3a7b1f8-b6ad-4ccf-9413-c44df08966cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a99b080>]}
[0m14:56:44.936739 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:56:44.984793 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:56:44.986765 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:56:44.987833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e3a7b1f8-b6ad-4ccf-9413-c44df08966cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13aa96000>]}
[0m14:56:46.635075 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.example
[0m14:56:46.651319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3a7b1f8-b6ad-4ccf-9413-c44df08966cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3b64e0>]}
[0m14:56:46.791710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3a7b1f8-b6ad-4ccf-9413-c44df08966cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13abe44a0>]}
[0m14:56:46.792536 [info ] [MainThread]: Found 1 model, 2 sources, 459 macros
[0m14:56:46.793130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3a7b1f8-b6ad-4ccf-9413-c44df08966cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ad8bd10>]}
[0m14:56:46.795831 [info ] [MainThread]: 
[0m14:56:46.796714 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:56:46.798083 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m14:56:46.817510 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m14:56:46.818177 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m14:56:46.818663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:47.575902 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.757 seconds
[0m14:56:47.580182 [debug] [ThreadPool]: On list_lab2: Close
[0m14:56:47.731888 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m14:56:47.750848 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m14:56:47.751560 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m14:56:47.752168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:56:48.374845 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.622 seconds
[0m14:56:48.381957 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m14:56:48.551591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3a7b1f8-b6ad-4ccf-9413-c44df08966cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0bfb60>]}
[0m14:56:48.553299 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:56:48.554258 [info ] [MainThread]: 
[0m14:56:48.562144 [debug] [Thread-1 (]: Began running node model.stock_calc.data_cleaned
[0m14:56:48.564051 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics.data_cleaned ............................. [RUN]
[0m14:56:48.565206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.stock_calc.data_cleaned)
[0m14:56:48.566076 [debug] [Thread-1 (]: Began compiling node model.stock_calc.data_cleaned
[0m14:56:48.583492 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.data_cleaned"
[0m14:56:48.586904 [debug] [Thread-1 (]: Began executing node model.stock_calc.data_cleaned
[0m14:56:48.653542 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.data_cleaned"
[0m14:56:48.655661 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.data_cleaned"
[0m14:56:48.656375 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.data_cleaned"} */
create or replace   view lab2.analytics.data_cleaned
  
   as (
    SELECT
	date,
	close,
	symbol
FROM lab2.raw_data.stock_price
  );
[0m14:56:48.657020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:49.447597 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.790 seconds
[0m14:56:49.491405 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: Close
[0m14:56:49.669563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3a7b1f8-b6ad-4ccf-9413-c44df08966cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ad32270>]}
[0m14:56:49.671296 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics.data_cleaned ........................ [[32mSUCCESS 1[0m in 1.10s]
[0m14:56:49.676150 [debug] [Thread-1 (]: Finished running node model.stock_calc.data_cleaned
[0m14:56:49.680169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:49.681173 [debug] [MainThread]: Connection 'model.stock_calc.data_cleaned' was properly closed.
[0m14:56:49.682106 [info ] [MainThread]: 
[0m14:56:49.682871 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m14:56:49.684739 [debug] [MainThread]: Command end result
[0m14:56:49.725079 [info ] [MainThread]: 
[0m14:56:49.725975 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:56:49.726525 [info ] [MainThread]: 
[0m14:56:49.727059 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:56:49.731785 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.322827, "process_user_time": 6.478806, "process_kernel_time": 1.400195, "process_mem_max_rss": "178262016", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:56:49.732780 [debug] [MainThread]: Command `dbt run` succeeded at 14:56:49.732596 after 8.32 seconds
[0m14:56:49.733391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ae2bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13af60350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ac490a0>]}
[0m14:56:49.734013 [debug] [MainThread]: Flushing usage events
[0m14:58:47.728838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108129940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087b9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d0d40>]}


============================== 14:58:47.737190 | 286040bb-9321-4d4a-a288-146c7df6117e ==============================
[0m14:58:47.737190 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:58:47.738307 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'no_print': 'None', 'invocation_command': 'dbt run', 'warn_error': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'quiet': 'False', 'use_colors': 'True', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'target_path': 'None'}
[0m14:58:50.986996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '286040bb-9321-4d4a-a288-146c7df6117e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1355de2a0>]}
[0m14:58:51.080027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '286040bb-9321-4d4a-a288-146c7df6117e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108817290>]}
[0m14:58:51.082292 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:58:51.113523 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:58:51.280116 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:58:51.280919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '286040bb-9321-4d4a-a288-146c7df6117e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088780b0>]}
[0m14:58:52.992889 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.stock_calc.intput
- models.stock_calc.output
[0m14:58:53.008729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '286040bb-9321-4d4a-a288-146c7df6117e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135956db0>]}
[0m14:58:53.232278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '286040bb-9321-4d4a-a288-146c7df6117e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135a56f60>]}
[0m14:58:53.233073 [info ] [MainThread]: Found 1 model, 2 sources, 459 macros
[0m14:58:53.233658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '286040bb-9321-4d4a-a288-146c7df6117e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135b22ae0>]}
[0m14:58:53.236284 [info ] [MainThread]: 
[0m14:58:53.237274 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:58:53.238711 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m14:58:53.259502 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m14:58:53.260099 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m14:58:53.260715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:54.009687 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.747 seconds
[0m14:58:54.014541 [debug] [ThreadPool]: On list_lab2: Close
[0m14:58:54.194549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m14:58:54.214592 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m14:58:54.215259 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m14:58:54.215772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:54.825911 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.610 seconds
[0m14:58:54.831052 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m14:58:54.976287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '286040bb-9321-4d4a-a288-146c7df6117e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135a834a0>]}
[0m14:58:54.978018 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:58:54.979133 [info ] [MainThread]: 
[0m14:58:54.985279 [debug] [Thread-1 (]: Began running node model.stock_calc.data_cleaned
[0m14:58:54.986629 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics.data_cleaned ............................. [RUN]
[0m14:58:54.987604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.stock_calc.data_cleaned)
[0m14:58:54.988382 [debug] [Thread-1 (]: Began compiling node model.stock_calc.data_cleaned
[0m14:58:55.001510 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.data_cleaned"
[0m14:58:55.002942 [debug] [Thread-1 (]: Began executing node model.stock_calc.data_cleaned
[0m14:58:55.062695 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.data_cleaned"
[0m14:58:55.064433 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.data_cleaned"
[0m14:58:55.065140 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.data_cleaned"} */
create or replace   view lab2.analytics.data_cleaned
  
   as (
    SELECT
	date,
	close,
	symbol
FROM lab2.raw_data.stock_price
  );
[0m14:58:55.066071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:55.780080 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.714 seconds
[0m14:58:55.824839 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: Close
[0m14:58:55.984712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '286040bb-9321-4d4a-a288-146c7df6117e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135550710>]}
[0m14:58:55.986663 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics.data_cleaned ........................ [[32mSUCCESS 1[0m in 0.99s]
[0m14:58:55.989350 [debug] [Thread-1 (]: Finished running node model.stock_calc.data_cleaned
[0m14:58:55.992343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:55.993128 [debug] [MainThread]: Connection 'model.stock_calc.data_cleaned' was properly closed.
[0m14:58:55.993910 [info ] [MainThread]: 
[0m14:58:55.994798 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.76 seconds (2.76s).
[0m14:58:55.996094 [debug] [MainThread]: Command end result
[0m14:58:56.030775 [info ] [MainThread]: 
[0m14:58:56.031548 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:58:56.032889 [info ] [MainThread]: 
[0m14:58:56.033879 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:58:56.038762 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.442301, "process_user_time": 6.687162, "process_kernel_time": 1.373697, "process_mem_max_rss": "178253824", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:58:56.039684 [debug] [MainThread]: Command `dbt run` succeeded at 14:58:56.039513 after 8.44 seconds
[0m14:58:56.040256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d0ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e27830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaa29f0>]}
[0m14:58:56.040776 [debug] [MainThread]: Flushing usage events
[0m14:59:50.296048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109608da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097393a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109739070>]}


============================== 14:59:50.302210 | 8b401e2c-36d3-4c7e-bff3-7090bb7e0f07 ==============================
[0m14:59:50.302210 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:59:50.303149 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'invocation_command': 'dbt run', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_format': 'default', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'debug': 'False', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'printer_width': '80', 'quiet': 'False', 'write_json': 'True', 'introspect': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'version_check': 'True', 'static_parser': 'True'}
[0m14:59:53.088452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b401e2c-36d3-4c7e-bff3-7090bb7e0f07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135654a70>]}
[0m14:59:53.175562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b401e2c-36d3-4c7e-bff3-7090bb7e0f07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3af8f0>]}
[0m14:59:53.178121 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:59:53.209667 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:59:53.446628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m14:59:53.447476 [debug] [MainThread]: Partial parsing: added file: stock_calc://models/output/stock_moving_avg.sql
[0m14:59:53.448016 [debug] [MainThread]: Partial parsing: added file: stock_calc://models/output/stock_rsi.sql
[0m14:59:53.806027 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m14:59:53.824606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b401e2c-36d3-4c7e-bff3-7090bb7e0f07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135f6b920>]}
[0m14:59:53.966432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b401e2c-36d3-4c7e-bff3-7090bb7e0f07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135d326c0>]}
[0m14:59:53.967250 [info ] [MainThread]: Found 3 models, 2 sources, 459 macros
[0m14:59:53.967846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b401e2c-36d3-4c7e-bff3-7090bb7e0f07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109597ef0>]}
[0m14:59:53.970813 [info ] [MainThread]: 
[0m14:59:53.971679 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:59:53.978180 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m14:59:53.996924 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m14:59:53.997553 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m14:59:53.998013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:54.714500 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.715 seconds
[0m14:59:54.719703 [debug] [ThreadPool]: On list_lab2: Close
[0m14:59:54.900924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m14:59:54.919279 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m14:59:54.919996 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m14:59:54.920514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:59:55.554025 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.633 seconds
[0m14:59:55.557510 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m14:59:55.708856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b401e2c-36d3-4c7e-bff3-7090bb7e0f07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108044fe0>]}
[0m14:59:55.710483 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:59:55.711763 [info ] [MainThread]: 
[0m14:59:55.718510 [debug] [Thread-1 (]: Began running node model.stock_calc.data_cleaned
[0m14:59:55.720203 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.data_cleaned ............................. [RUN]
[0m14:59:55.721279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.stock_calc.data_cleaned)
[0m14:59:55.722235 [debug] [Thread-1 (]: Began compiling node model.stock_calc.data_cleaned
[0m14:59:55.736228 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.data_cleaned"
[0m14:59:55.737697 [debug] [Thread-1 (]: Began executing node model.stock_calc.data_cleaned
[0m14:59:55.790764 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.data_cleaned"
[0m14:59:55.792682 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.data_cleaned"
[0m14:59:55.793424 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.data_cleaned"} */
create or replace   view lab2.analytics.data_cleaned
  
   as (
    SELECT
	date,
	close,
	symbol
FROM lab2.raw_data.stock_price
  );
[0m14:59:55.794036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:59:56.539407 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.745 seconds
[0m14:59:56.583318 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: Close
[0m14:59:56.733774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b401e2c-36d3-4c7e-bff3-7090bb7e0f07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cdd7f0>]}
[0m14:59:56.735712 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.data_cleaned ........................ [[32mSUCCESS 1[0m in 1.01s]
[0m14:59:56.739789 [debug] [Thread-1 (]: Finished running node model.stock_calc.data_cleaned
[0m14:59:56.741299 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_rsi
[0m14:59:56.742837 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.stock_rsi ............................... [RUN]
[0m14:59:56.743786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.data_cleaned, now model.stock_calc.stock_rsi)
[0m14:59:56.744489 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_rsi
[0m14:59:56.747584 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_rsi"
[0m14:59:56.749143 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_rsi
[0m14:59:56.781823 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_rsi"
[0m14:59:56.785334 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_rsi"
[0m14:59:56.786326 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_rsi"} */
create or replace transient table lab2.analytics.stock_rsi
         as
        (WITH price_changes AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM analytics.data_cleaned
),
gains_losses AS (
    SELECT 
        symbol,
        date,
        close,
        previous_close,
        close - previous_close AS price_change,
        CASE 
            WHEN close - previous_close > 0 THEN close - previous_close 
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close - previous_close < 0 THEN ABS(close - previous_close) 
            ELSE 0 
        END AS loss
    FROM price_changes
    WHERE previous_close IS NOT NULL
),
average_gain_loss AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_losses
),
relative_strength AS (
    SELECT
        symbol,
        date,
        avg_gain,
        avg_loss,
        CASE 
            WHEN avg_loss = 0 THEN NULL
            ELSE avg_gain / avg_loss 
        END AS rs
    FROM average_gain_loss
),
rsi_values AS (
    SELECT
        symbol,
        date,
        CASE
            WHEN rs IS NULL THEN NULL
            ELSE 100 - (100 / (1 + rs))
        END AS rsi
    FROM relative_strength
)

SELECT symbol, date, rsi
FROM rsi_values
WHERE rsi IS NOT NULL
ORDER BY symbol, date DESC
        );
[0m14:59:56.787146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:01.657404 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.870 seconds
[0m15:00:01.662831 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: Close
[0m15:00:01.854141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b401e2c-36d3-4c7e-bff3-7090bb7e0f07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136209880>]}
[0m15:00:01.855979 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.stock_rsi .......................... [[32mSUCCESS 1[0m in 5.11s]
[0m15:00:01.857724 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_rsi
[0m15:00:01.858933 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_moving_avg
[0m15:00:01.859939 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.stock_moving_avg ........................ [RUN]
[0m15:00:01.861111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.stock_rsi, now model.stock_calc.stock_moving_avg)
[0m15:00:01.862100 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_moving_avg
[0m15:00:01.867465 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_moving_avg"
[0m15:00:01.868902 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_moving_avg
[0m15:00:01.874996 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_moving_avg"
[0m15:00:01.876790 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_moving_avg"
[0m15:00:01.877408 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_moving_avg"} */
create or replace transient table lab2.analytics.stock_moving_avg
         as
        (SELECT
	symbol,
	date,
	AVG(close) OVER (
		PARTITION BY symbol
		ORDER BY date
		ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
	) AS moving_avg
FROM
	lab2.analytics.data_cleaned
        );
[0m15:00:01.877938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:03.501092 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.623 seconds
[0m15:00:03.504328 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: Close
[0m15:00:03.662079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b401e2c-36d3-4c7e-bff3-7090bb7e0f07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136220ec0>]}
[0m15:00:03.663968 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.stock_moving_avg ................... [[32mSUCCESS 1[0m in 1.80s]
[0m15:00:03.665793 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_moving_avg
[0m15:00:03.669010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:03.670292 [debug] [MainThread]: Connection 'model.stock_calc.stock_moving_avg' was properly closed.
[0m15:00:03.671556 [info ] [MainThread]: 
[0m15:00:03.672537 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 9.70 seconds (9.70s).
[0m15:00:03.674489 [debug] [MainThread]: Command end result
[0m15:00:03.713996 [info ] [MainThread]: 
[0m15:00:03.714863 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:00:03.715459 [info ] [MainThread]: 
[0m15:00:03.716023 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:00:03.721252 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.537865, "process_user_time": 5.779044, "process_kernel_time": 1.293588, "process_mem_max_rss": "179666944", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:00:03.722308 [debug] [MainThread]: Command `dbt run` succeeded at 15:00:03.722102 after 13.54 seconds
[0m15:00:03.722986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135dfca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135cbac60>]}
[0m15:00:03.723631 [debug] [MainThread]: Flushing usage events
[0m15:02:24.447423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c739e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863ce60>]}


============================== 15:02:24.454648 | dd034d84-f350-4593-9626-2451ab7b5be9 ==============================
[0m15:02:24.454648 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:02:24.456629 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'write_json': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'empty': 'False', 'quiet': 'False', 'use_colors': 'True', 'debug': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'cache_selected_only': 'False', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'static_parser': 'True', 'warn_error': 'None'}
[0m15:02:27.869049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd034d84-f350-4593-9626-2451ab7b5be9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1348d03b0>]}
[0m15:02:27.956653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd034d84-f350-4593-9626-2451ab7b5be9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075488f0>]}
[0m15:02:27.958805 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:02:27.991704 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:02:28.269205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:02:28.270164 [debug] [MainThread]: Partial parsing: updated file: stock_calc://models/input/data_cleaned.sql
[0m15:02:28.627608 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:02:28.647272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd034d84-f350-4593-9626-2451ab7b5be9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134e7b860>]}
[0m15:02:28.797318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd034d84-f350-4593-9626-2451ab7b5be9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134bb5310>]}
[0m15:02:28.798479 [info ] [MainThread]: Found 3 models, 2 sources, 459 macros
[0m15:02:28.799162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd034d84-f350-4593-9626-2451ab7b5be9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134d60a70>]}
[0m15:02:28.802635 [info ] [MainThread]: 
[0m15:02:28.803838 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:02:28.811337 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m15:02:28.830673 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m15:02:28.831307 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m15:02:28.831756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:29.599732 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.765 seconds
[0m15:02:29.606035 [debug] [ThreadPool]: On list_lab2: Close
[0m15:02:29.764087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m15:02:29.782662 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:02:29.783350 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:02:29.783869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:30.531192 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.747 seconds
[0m15:02:30.536638 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:02:30.719110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd034d84-f350-4593-9626-2451ab7b5be9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134e23860>]}
[0m15:02:30.720751 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:02:30.721804 [info ] [MainThread]: 
[0m15:02:30.727628 [debug] [Thread-1 (]: Began running node model.stock_calc.data_cleaned
[0m15:02:30.728974 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.data_cleaned ............................. [RUN]
[0m15:02:30.730069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.stock_calc.data_cleaned)
[0m15:02:30.730757 [debug] [Thread-1 (]: Began compiling node model.stock_calc.data_cleaned
[0m15:02:30.743745 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.data_cleaned"
[0m15:02:30.745068 [debug] [Thread-1 (]: Began executing node model.stock_calc.data_cleaned
[0m15:02:30.789114 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.data_cleaned"
[0m15:02:30.790755 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.data_cleaned"
[0m15:02:30.791324 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.data_cleaned"} */
create or replace   view lab2.analytics.data_cleaned
  
   as (
    SELECT
	date,
	close,
	symbol
FROM lab2.raw_data.stock_price
ORDER BY date DESC;
[0m15:02:30.791808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:31.460350 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b854c6-0004-2be6-0002-65f300010596
[0m15:02:31.461267 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 18 unexpected ';'.
[0m15:02:31.462289 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: Close
[0m15:02:31.654490 [debug] [Thread-1 (]: Database Error in model data_cleaned (models/input/data_cleaned.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 18 unexpected ';'.
  compiled code at target/run/stock_calc/models/input/data_cleaned.sql
[0m15:02:31.657344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd034d84-f350-4593-9626-2451ab7b5be9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be53a0>]}
[0m15:02:31.658669 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model analytics.data_cleaned .................... [[31mERROR[0m in 0.93s]
[0m15:02:31.660573 [debug] [Thread-1 (]: Finished running node model.stock_calc.data_cleaned
[0m15:02:31.661420 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_rsi
[0m15:02:31.663583 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.stock_rsi ............................... [RUN]
[0m15:02:31.664600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.data_cleaned, now model.stock_calc.stock_rsi)
[0m15:02:31.665301 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_rsi
[0m15:02:31.668287 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_rsi"
[0m15:02:31.670842 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_rsi
[0m15:02:31.703188 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_rsi"
[0m15:02:31.707408 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_rsi"
[0m15:02:31.708160 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_rsi"} */
create or replace transient table lab2.analytics.stock_rsi
         as
        (WITH price_changes AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM analytics.data_cleaned
),
gains_losses AS (
    SELECT 
        symbol,
        date,
        close,
        previous_close,
        close - previous_close AS price_change,
        CASE 
            WHEN close - previous_close > 0 THEN close - previous_close 
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close - previous_close < 0 THEN ABS(close - previous_close) 
            ELSE 0 
        END AS loss
    FROM price_changes
    WHERE previous_close IS NOT NULL
),
average_gain_loss AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_losses
),
relative_strength AS (
    SELECT
        symbol,
        date,
        avg_gain,
        avg_loss,
        CASE 
            WHEN avg_loss = 0 THEN NULL
            ELSE avg_gain / avg_loss 
        END AS rs
    FROM average_gain_loss
),
rsi_values AS (
    SELECT
        symbol,
        date,
        CASE
            WHEN rs IS NULL THEN NULL
            ELSE 100 - (100 / (1 + rs))
        END AS rsi
    FROM relative_strength
)

SELECT symbol, date, rsi
FROM rsi_values
WHERE rsi IS NOT NULL
ORDER BY symbol, date DESC
        );
[0m15:02:31.708805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:33.729680 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.020 seconds
[0m15:02:33.773362 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: Close
[0m15:02:33.920472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd034d84-f350-4593-9626-2451ab7b5be9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1350f16d0>]}
[0m15:02:33.922421 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.stock_rsi .......................... [[32mSUCCESS 1[0m in 2.26s]
[0m15:02:33.926693 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_rsi
[0m15:02:33.928383 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_moving_avg
[0m15:02:33.929791 [info ] [Thread-1 (]: 3 of 3 SKIP relation analytics.stock_moving_avg ................................ [[33mSKIP[0m]
[0m15:02:33.930906 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_moving_avg
[0m15:02:33.933649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:33.934426 [debug] [MainThread]: Connection 'model.stock_calc.stock_rsi' was properly closed.
[0m15:02:33.935333 [info ] [MainThread]: 
[0m15:02:33.936155 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 5.13 seconds (5.13s).
[0m15:02:33.937850 [debug] [MainThread]: Command end result
[0m15:02:33.973691 [info ] [MainThread]: 
[0m15:02:33.974394 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:02:33.974904 [info ] [MainThread]: 
[0m15:02:33.975465 [error] [MainThread]:   Database Error in model data_cleaned (models/input/data_cleaned.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 18 unexpected ';'.
  compiled code at target/run/stock_calc/models/input/data_cleaned.sql
[0m15:02:33.976080 [info ] [MainThread]: 
[0m15:02:33.976621 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m15:02:33.982167 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.651017, "process_user_time": 5.458391, "process_kernel_time": 1.358206, "process_mem_max_rss": "180207616", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:02:33.983873 [debug] [MainThread]: Command `dbt run` failed at 15:02:33.983497 after 9.65 seconds
[0m15:02:33.984604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056256d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108097320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089100b0>]}
[0m15:02:33.985207 [debug] [MainThread]: Flushing usage events
[0m15:02:48.128024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112400b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e55280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e54f20>]}


============================== 15:02:48.134240 | 421e699b-49cb-452b-8669-693cb0373bad ==============================
[0m15:02:48.134240 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:02:48.135213 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'use_colors': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'no_print': 'None', 'partial_parse': 'True', 'warn_error': 'None', 'empty': 'False', 'write_json': 'True', 'version_check': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'quiet': 'False', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'printer_width': '80', 'fail_fast': 'False', 'cache_selected_only': 'False'}
[0m15:02:50.425564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '421e699b-49cb-452b-8669-693cb0373bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cbb020>]}
[0m15:02:50.511586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '421e699b-49cb-452b-8669-693cb0373bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117aba1b0>]}
[0m15:02:50.513967 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:02:50.546071 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:02:50.812145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:02:50.813131 [debug] [MainThread]: Partial parsing: updated file: stock_calc://models/input/data_cleaned.sql
[0m15:02:51.193838 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:02:51.212139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '421e699b-49cb-452b-8669-693cb0373bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f6838c0>]}
[0m15:02:51.348516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '421e699b-49cb-452b-8669-693cb0373bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f447110>]}
[0m15:02:51.349324 [info ] [MainThread]: Found 3 models, 2 sources, 459 macros
[0m15:02:51.349860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '421e699b-49cb-452b-8669-693cb0373bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f683080>]}
[0m15:02:51.352945 [info ] [MainThread]: 
[0m15:02:51.353937 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:02:51.360745 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m15:02:51.380327 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m15:02:51.380979 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m15:02:51.381476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:52.084442 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.703 seconds
[0m15:02:52.089045 [debug] [ThreadPool]: On list_lab2: Close
[0m15:02:52.228071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m15:02:52.242321 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:02:52.242977 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:02:52.243434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:52.884065 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.640 seconds
[0m15:02:52.889819 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:02:53.035300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '421e699b-49cb-452b-8669-693cb0373bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e84350>]}
[0m15:02:53.037155 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:02:53.038287 [info ] [MainThread]: 
[0m15:02:53.044097 [debug] [Thread-1 (]: Began running node model.stock_calc.data_cleaned
[0m15:02:53.045907 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.data_cleaned ............................. [RUN]
[0m15:02:53.047151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.stock_calc.data_cleaned)
[0m15:02:53.048020 [debug] [Thread-1 (]: Began compiling node model.stock_calc.data_cleaned
[0m15:02:53.061804 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.data_cleaned"
[0m15:02:53.063185 [debug] [Thread-1 (]: Began executing node model.stock_calc.data_cleaned
[0m15:02:53.110216 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.data_cleaned"
[0m15:02:53.111908 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.data_cleaned"
[0m15:02:53.112518 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.data_cleaned"} */
create or replace   view lab2.analytics.data_cleaned
  
   as (
    SELECT
	date,
	close,
	symbol
FROM lab2.raw_data.stock_price
ORDER BY date DESC
  );
[0m15:02:53.113023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:54.107714 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.994 seconds
[0m15:02:54.151602 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: Close
[0m15:02:54.310186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '421e699b-49cb-452b-8669-693cb0373bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112401460>]}
[0m15:02:54.311478 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.data_cleaned ........................ [[32mSUCCESS 1[0m in 1.26s]
[0m15:02:54.312785 [debug] [Thread-1 (]: Finished running node model.stock_calc.data_cleaned
[0m15:02:54.313518 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_rsi
[0m15:02:54.314415 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.stock_rsi ............................... [RUN]
[0m15:02:54.315361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.data_cleaned, now model.stock_calc.stock_rsi)
[0m15:02:54.315955 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_rsi
[0m15:02:54.318652 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_rsi"
[0m15:02:54.319815 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_rsi
[0m15:02:54.363464 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_rsi"
[0m15:02:54.367741 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_rsi"
[0m15:02:54.368744 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_rsi"} */
create or replace transient table lab2.analytics.stock_rsi
         as
        (WITH price_changes AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM analytics.data_cleaned
),
gains_losses AS (
    SELECT 
        symbol,
        date,
        close,
        previous_close,
        close - previous_close AS price_change,
        CASE 
            WHEN close - previous_close > 0 THEN close - previous_close 
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close - previous_close < 0 THEN ABS(close - previous_close) 
            ELSE 0 
        END AS loss
    FROM price_changes
    WHERE previous_close IS NOT NULL
),
average_gain_loss AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_losses
),
relative_strength AS (
    SELECT
        symbol,
        date,
        avg_gain,
        avg_loss,
        CASE 
            WHEN avg_loss = 0 THEN NULL
            ELSE avg_gain / avg_loss 
        END AS rs
    FROM average_gain_loss
),
rsi_values AS (
    SELECT
        symbol,
        date,
        CASE
            WHEN rs IS NULL THEN NULL
            ELSE 100 - (100 / (1 + rs))
        END AS rsi
    FROM relative_strength
)

SELECT symbol, date, rsi
FROM rsi_values
WHERE rsi IS NOT NULL
ORDER BY symbol, date DESC
        );
[0m15:02:54.369475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:56.258875 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.889 seconds
[0m15:02:56.262951 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: Close
[0m15:02:56.772100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '421e699b-49cb-452b-8669-693cb0373bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f8fc740>]}
[0m15:02:56.774717 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.stock_rsi .......................... [[32mSUCCESS 1[0m in 2.46s]
[0m15:02:56.776769 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_rsi
[0m15:02:56.777823 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_moving_avg
[0m15:02:56.779233 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.stock_moving_avg ........................ [RUN]
[0m15:02:56.780370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.stock_rsi, now model.stock_calc.stock_moving_avg)
[0m15:02:56.781432 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_moving_avg
[0m15:02:56.788600 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_moving_avg"
[0m15:02:56.790727 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_moving_avg
[0m15:02:56.794686 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_moving_avg"
[0m15:02:56.796246 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_moving_avg"
[0m15:02:56.796905 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_moving_avg"} */
create or replace transient table lab2.analytics.stock_moving_avg
         as
        (SELECT
	symbol,
	date,
	AVG(close) OVER (
		PARTITION BY symbol
		ORDER BY date
		ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
	) AS moving_avg
FROM
	lab2.analytics.data_cleaned
        );
[0m15:02:56.797476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:58.597794 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.800 seconds
[0m15:02:58.604427 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: Close
[0m15:02:58.750722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '421e699b-49cb-452b-8669-693cb0373bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f4477d0>]}
[0m15:02:58.752316 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.stock_moving_avg ................... [[32mSUCCESS 1[0m in 1.97s]
[0m15:02:58.753781 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_moving_avg
[0m15:02:58.756845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:58.757526 [debug] [MainThread]: Connection 'model.stock_calc.stock_moving_avg' was properly closed.
[0m15:02:58.758296 [info ] [MainThread]: 
[0m15:02:58.759332 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 7.40 seconds (7.40s).
[0m15:02:58.761234 [debug] [MainThread]: Command end result
[0m15:02:58.800820 [info ] [MainThread]: 
[0m15:02:58.802191 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:02:58.802808 [info ] [MainThread]: 
[0m15:02:58.803348 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:02:58.811342 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.793281, "process_user_time": 5.683294, "process_kernel_time": 1.183955, "process_mem_max_rss": "179343360", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:02:58.812403 [debug] [MainThread]: Command `dbt run` succeeded at 15:02:58.812218 after 10.79 seconds
[0m15:02:58.813039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f683230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e55070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e54f20>]}
[0m15:02:58.813595 [debug] [MainThread]: Flushing usage events
[0m15:03:14.800468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048cf170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105389130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105388e00>]}


============================== 15:03:14.806198 | a052a08d-99bd-4b8e-893d-162dd7d4a9c0 ==============================
[0m15:03:14.806198 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:03:14.807178 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'write_json': 'True', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'debug': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'empty': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'no_print': 'None', 'static_parser': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'printer_width': '80', 'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True'}
[0m15:03:17.127517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a052a08d-99bd-4b8e-893d-162dd7d4a9c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106040470>]}
[0m15:03:17.212510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a052a08d-99bd-4b8e-893d-162dd7d4a9c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a373bc0>]}
[0m15:03:17.214964 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:03:17.243541 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:03:17.490416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:03:17.491056 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:03:17.499440 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:03:17.543064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a052a08d-99bd-4b8e-893d-162dd7d4a9c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131833d40>]}
[0m15:03:17.684925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a052a08d-99bd-4b8e-893d-162dd7d4a9c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131a88110>]}
[0m15:03:17.685805 [info ] [MainThread]: Found 3 models, 2 sources, 459 macros
[0m15:03:17.686430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a052a08d-99bd-4b8e-893d-162dd7d4a9c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1317c65d0>]}
[0m15:03:17.689464 [info ] [MainThread]: 
[0m15:03:17.690910 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:03:17.697634 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m15:03:17.725212 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m15:03:17.726061 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m15:03:17.726555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:18.519559 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.793 seconds
[0m15:03:18.524779 [debug] [ThreadPool]: On list_lab2: Close
[0m15:03:18.664284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m15:03:18.683919 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:03:18.684565 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:03:18.685030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:03:19.401841 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.717 seconds
[0m15:03:19.407029 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:03:19.589054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a052a08d-99bd-4b8e-893d-162dd7d4a9c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1317fb350>]}
[0m15:03:19.590467 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:03:19.591763 [info ] [MainThread]: 
[0m15:03:19.596919 [debug] [Thread-1 (]: Began running node model.stock_calc.data_cleaned
[0m15:03:19.598985 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.data_cleaned ............................. [RUN]
[0m15:03:19.600397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.stock_calc.data_cleaned)
[0m15:03:19.601633 [debug] [Thread-1 (]: Began compiling node model.stock_calc.data_cleaned
[0m15:03:19.615704 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.data_cleaned"
[0m15:03:19.617031 [debug] [Thread-1 (]: Began executing node model.stock_calc.data_cleaned
[0m15:03:19.668007 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.data_cleaned"
[0m15:03:19.669976 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.data_cleaned"
[0m15:03:19.670914 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.data_cleaned"} */
create or replace   view lab2.analytics.data_cleaned
  
   as (
    SELECT
	date,
	close,
	symbol
FROM lab2.raw_data.stock_price
ORDER BY date DESC
  );
[0m15:03:19.671488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:20.526460 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.855 seconds
[0m15:03:20.570239 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: Close
[0m15:03:20.714620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a052a08d-99bd-4b8e-893d-162dd7d4a9c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10492d730>]}
[0m15:03:20.716234 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.data_cleaned ........................ [[32mSUCCESS 1[0m in 1.11s]
[0m15:03:20.717606 [debug] [Thread-1 (]: Finished running node model.stock_calc.data_cleaned
[0m15:03:20.718544 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_rsi
[0m15:03:20.720653 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.stock_rsi ............................... [RUN]
[0m15:03:20.722630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.data_cleaned, now model.stock_calc.stock_rsi)
[0m15:03:20.723499 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_rsi
[0m15:03:20.726636 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_rsi"
[0m15:03:20.728314 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_rsi
[0m15:03:20.764486 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_rsi"
[0m15:03:20.769873 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_rsi"
[0m15:03:20.770626 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_rsi"} */
create or replace transient table lab2.analytics.stock_rsi
         as
        (WITH price_changes AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM analytics.data_cleaned
),
gains_losses AS (
    SELECT 
        symbol,
        date,
        close,
        previous_close,
        close - previous_close AS price_change,
        CASE 
            WHEN close - previous_close > 0 THEN close - previous_close 
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close - previous_close < 0 THEN ABS(close - previous_close) 
            ELSE 0 
        END AS loss
    FROM price_changes
    WHERE previous_close IS NOT NULL
),
average_gain_loss AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_losses
),
relative_strength AS (
    SELECT
        symbol,
        date,
        avg_gain,
        avg_loss,
        CASE 
            WHEN avg_loss = 0 THEN NULL
            ELSE avg_gain / avg_loss 
        END AS rs
    FROM average_gain_loss
),
rsi_values AS (
    SELECT
        symbol,
        date,
        CASE
            WHEN rs IS NULL THEN NULL
            ELSE 100 - (100 / (1 + rs))
        END AS rsi
    FROM relative_strength
)

SELECT symbol, date, rsi
FROM rsi_values
WHERE rsi IS NOT NULL
ORDER BY symbol, date DESC
        );
[0m15:03:20.771230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:22.270564 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.499 seconds
[0m15:03:22.276764 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: Close
[0m15:03:22.424519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a052a08d-99bd-4b8e-893d-162dd7d4a9c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131831820>]}
[0m15:03:22.426352 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.stock_rsi .......................... [[32mSUCCESS 1[0m in 1.70s]
[0m15:03:22.428207 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_rsi
[0m15:03:22.429593 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_moving_avg
[0m15:03:22.430904 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.stock_moving_avg ........................ [RUN]
[0m15:03:22.432007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.stock_rsi, now model.stock_calc.stock_moving_avg)
[0m15:03:22.432994 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_moving_avg
[0m15:03:22.438506 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_moving_avg"
[0m15:03:22.439958 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_moving_avg
[0m15:03:22.444222 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_moving_avg"
[0m15:03:22.445905 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_moving_avg"
[0m15:03:22.446549 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_moving_avg"} */
create or replace transient table lab2.analytics.stock_moving_avg
         as
        (SELECT
	symbol,
	date,
	AVG(close) OVER (
		PARTITION BY symbol
		ORDER BY date
		ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
	) AS moving_avg
FROM
	lab2.analytics.data_cleaned
        );
[0m15:03:22.447106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:24.064869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.617 seconds
[0m15:03:24.070534 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: Close
[0m15:03:24.206819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a052a08d-99bd-4b8e-893d-162dd7d4a9c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131bff3e0>]}
[0m15:03:24.208647 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.stock_moving_avg ................... [[32mSUCCESS 1[0m in 1.77s]
[0m15:03:24.210402 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_moving_avg
[0m15:03:24.213189 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:24.213997 [debug] [MainThread]: Connection 'model.stock_calc.stock_moving_avg' was properly closed.
[0m15:03:24.214833 [info ] [MainThread]: 
[0m15:03:24.215660 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 6.52 seconds (6.52s).
[0m15:03:24.217677 [debug] [MainThread]: Command end result
[0m15:03:24.256273 [info ] [MainThread]: 
[0m15:03:24.257010 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:03:24.257492 [info ] [MainThread]: 
[0m15:03:24.258012 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:03:24.260616 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.564969, "process_user_time": 5.406616, "process_kernel_time": 1.26686, "process_mem_max_rss": "176373760", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:03:24.261530 [debug] [MainThread]: Command `dbt run` succeeded at 15:03:24.261365 after 9.57 seconds
[0m15:03:24.262349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053890d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de3710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051f1be0>]}
[0m15:03:24.262923 [debug] [MainThread]: Flushing usage events
[0m15:07:41.943581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbe47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5691c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e568e60>]}


============================== 15:07:41.954663 | 340af3aa-12d5-4663-b552-cc2488e60061 ==============================
[0m15:07:41.954663 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:07:41.956601 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'partial_parse': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'version_check': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'introspect': 'True', 'use_colors': 'True', 'log_format': 'default', 'debug': 'False', 'warn_error': 'None', 'printer_width': '80', 'static_parser': 'True', 'write_json': 'True', 'invocation_command': 'dbt run', 'no_print': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m15:07:45.430104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '340af3aa-12d5-4663-b552-cc2488e60061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a51ce00>]}
[0m15:07:45.519989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '340af3aa-12d5-4663-b552-cc2488e60061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118b6480>]}
[0m15:07:45.522242 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:07:45.538427 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m15:07:45.546190 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.728533, "process_user_time": 4.099543, "process_kernel_time": 1.300051, "process_mem_max_rss": "164143104", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:07:45.547670 [debug] [MainThread]: Command `dbt run` failed at 15:07:45.547382 after 3.73 seconds
[0m15:07:45.548692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5690d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d2b740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a8a4920>]}
[0m15:07:45.549447 [debug] [MainThread]: Flushing usage events
[0m15:09:00.446070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11191af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fb5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fb4c20>]}


============================== 15:09:00.460513 | 9952bc64-9725-4056-8668-55171ca28e24 ==============================
[0m15:09:00.460513 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:09:00.461998 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'cache_selected_only': 'False', 'target_path': 'None', 'quiet': 'False', 'use_colors': 'True', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'static_parser': 'True', 'debug': 'False', 'write_json': 'True', 'introspect': 'True', 'empty': 'False', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'log_format': 'default', 'printer_width': '80', 'partial_parse': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'no_print': 'None'}
[0m15:09:03.615405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9952bc64-9725-4056-8668-55171ca28e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb271a0>]}
[0m15:09:03.704000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9952bc64-9725-4056-8668-55171ca28e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e0d0d40>]}
[0m15:09:03.706747 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:09:03.722757 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m15:09:03.729300 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.4010553, "process_user_time": 4.11643, "process_kernel_time": 1.232044, "process_mem_max_rss": "163983360", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:09:03.730641 [debug] [MainThread]: Command `dbt run` failed at 15:09:03.730415 after 3.40 seconds
[0m15:09:03.731607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f703b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e0ae870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e28b620>]}
[0m15:09:03.732345 [debug] [MainThread]: Flushing usage events
[0m15:09:34.428683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112888950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a35130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a34e00>]}


============================== 15:09:34.433217 | 1757479e-0fbb-4134-a958-0fab8063f0e8 ==============================
[0m15:09:34.433217 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:09:34.434151 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'version_check': 'True', 'partial_parse': 'True', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'no_print': 'None', 'write_json': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'target_path': 'None', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'empty': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run'}
[0m15:09:36.865049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1757479e-0fbb-4134-a958-0fab8063f0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fca2c60>]}
[0m15:09:36.949952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1757479e-0fbb-4134-a958-0fab8063f0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fb48f80>]}
[0m15:09:36.952661 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:09:36.984993 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:09:37.238504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:09:37.239666 [debug] [MainThread]: Partial parsing: updated file: stock_calc://models/input/data_cleaned.sql
[0m15:09:37.603442 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:09:37.621866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1757479e-0fbb-4134-a958-0fab8063f0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14016a270>]}
[0m15:09:37.759912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1757479e-0fbb-4134-a958-0fab8063f0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ffaa240>]}
[0m15:09:37.760689 [info ] [MainThread]: Found 3 models, 2 sources, 459 macros
[0m15:09:37.761317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1757479e-0fbb-4134-a958-0fab8063f0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140232780>]}
[0m15:09:37.764344 [info ] [MainThread]: 
[0m15:09:37.765388 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:09:37.772338 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m15:09:37.792197 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m15:09:37.792907 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m15:09:37.793492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:38.466689 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.673 seconds
[0m15:09:38.469560 [debug] [ThreadPool]: On list_lab2: Close
[0m15:09:38.602491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m15:09:38.621711 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:09:38.622345 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:09:38.622827 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:39.525336 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.902 seconds
[0m15:09:39.528403 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:09:39.745713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1757479e-0fbb-4134-a958-0fab8063f0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11240c6b0>]}
[0m15:09:39.746922 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:09:39.747677 [info ] [MainThread]: 
[0m15:09:39.753164 [debug] [Thread-1 (]: Began running node model.stock_calc.data_cleaned
[0m15:09:39.754392 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.data_cleaned ............................. [RUN]
[0m15:09:39.755602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.stock_calc.data_cleaned)
[0m15:09:39.756520 [debug] [Thread-1 (]: Began compiling node model.stock_calc.data_cleaned
[0m15:09:39.770001 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.data_cleaned"
[0m15:09:39.772985 [debug] [Thread-1 (]: Began executing node model.stock_calc.data_cleaned
[0m15:09:39.820011 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.data_cleaned"
[0m15:09:39.821702 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.data_cleaned"
[0m15:09:39.822302 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.data_cleaned"} */
create or replace   view lab2.analytics.data_cleaned
  
   as (
    SELECT
	DISTINCT (date, symbol),
	close
FROM lab2.raw_data.stock_price
ORDER BY date DESC
  );
[0m15:09:39.822796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:40.520595 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b854cd-0004-2be6-0002-65f3000105ae
[0m15:09:40.521880 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m15:09:40.523040 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: Close
[0m15:09:40.665827 [debug] [Thread-1 (]: Database Error in model data_cleaned (models/input/data_cleaned.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target/run/stock_calc/models/input/data_cleaned.sql
[0m15:09:40.669603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1757479e-0fbb-4134-a958-0fab8063f0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fe74170>]}
[0m15:09:40.671124 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model analytics.data_cleaned .................... [[31mERROR[0m in 0.91s]
[0m15:09:40.673775 [debug] [Thread-1 (]: Finished running node model.stock_calc.data_cleaned
[0m15:09:40.675311 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_rsi
[0m15:09:40.676571 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.stock_rsi ............................... [RUN]
[0m15:09:40.679422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.data_cleaned, now model.stock_calc.stock_rsi)
[0m15:09:40.680418 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_rsi
[0m15:09:40.684872 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_rsi"
[0m15:09:40.686510 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_rsi
[0m15:09:40.719231 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_rsi"
[0m15:09:40.722543 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_rsi"
[0m15:09:40.723382 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_rsi"} */
create or replace transient table lab2.analytics.stock_rsi
         as
        (WITH price_changes AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM analytics.data_cleaned
),
gains_losses AS (
    SELECT 
        symbol,
        date,
        close,
        previous_close,
        close - previous_close AS price_change,
        CASE 
            WHEN close - previous_close > 0 THEN close - previous_close 
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close - previous_close < 0 THEN ABS(close - previous_close) 
            ELSE 0 
        END AS loss
    FROM price_changes
    WHERE previous_close IS NOT NULL
),
average_gain_loss AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_losses
),
relative_strength AS (
    SELECT
        symbol,
        date,
        avg_gain,
        avg_loss,
        CASE 
            WHEN avg_loss = 0 THEN NULL
            ELSE avg_gain / avg_loss 
        END AS rs
    FROM average_gain_loss
),
rsi_values AS (
    SELECT
        symbol,
        date,
        CASE
            WHEN rs IS NULL THEN NULL
            ELSE 100 - (100 / (1 + rs))
        END AS rsi
    FROM relative_strength
)

SELECT symbol, date, rsi
FROM rsi_values
WHERE rsi IS NOT NULL
ORDER BY symbol, date DESC
        );
[0m15:09:40.724198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:41.992372 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.268 seconds
[0m15:09:42.038048 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: Close
[0m15:09:42.236227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1757479e-0fbb-4134-a958-0fab8063f0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404e60c0>]}
[0m15:09:42.238109 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.stock_rsi .......................... [[32mSUCCESS 1[0m in 1.56s]
[0m15:09:42.241157 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_rsi
[0m15:09:42.243073 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_moving_avg
[0m15:09:42.244408 [info ] [Thread-1 (]: 3 of 3 SKIP relation analytics.stock_moving_avg ................................ [[33mSKIP[0m]
[0m15:09:42.245496 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_moving_avg
[0m15:09:42.248114 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:42.248940 [debug] [MainThread]: Connection 'model.stock_calc.stock_rsi' was properly closed.
[0m15:09:42.250163 [info ] [MainThread]: 
[0m15:09:42.250961 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m15:09:42.252596 [debug] [MainThread]: Command end result
[0m15:09:42.293182 [info ] [MainThread]: 
[0m15:09:42.294050 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:09:42.294578 [info ] [MainThread]: 
[0m15:09:42.295155 [error] [MainThread]:   Database Error in model data_cleaned (models/input/data_cleaned.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target/run/stock_calc/models/input/data_cleaned.sql
[0m15:09:42.295616 [info ] [MainThread]: 
[0m15:09:42.296081 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m15:09:42.302279 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.9675364, "process_user_time": 5.287196, "process_kernel_time": 1.081235, "process_mem_max_rss": "180736000", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:09:42.303270 [debug] [MainThread]: Command `dbt run` failed at 15:09:42.303101 after 7.97 seconds
[0m15:09:42.304016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139010d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a350a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a350d0>]}
[0m15:09:42.304569 [debug] [MainThread]: Flushing usage events
[0m15:14:51.120125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff75fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11137cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11137cc50>]}


============================== 15:14:51.136716 | 003e5fa2-e7a2-463c-b871-4adaf6f1c2cd ==============================
[0m15:14:51.136716 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:14:51.137806 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'fail_fast': 'False', 'printer_width': '80', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'write_json': 'True', 'log_format': 'default', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'debug': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'quiet': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'empty': 'False', 'use_experimental_parser': 'False'}
[0m15:14:54.724007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '003e5fa2-e7a2-463c-b871-4adaf6f1c2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d3f740>]}
[0m15:14:54.811711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '003e5fa2-e7a2-463c-b871-4adaf6f1c2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11055f5f0>]}
[0m15:14:54.813958 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:14:54.848581 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:14:55.109238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:14:55.110325 [debug] [MainThread]: Partial parsing: updated file: stock_calc://models/input/data_cleaned.sql
[0m15:14:55.488947 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:14:55.512124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '003e5fa2-e7a2-463c-b871-4adaf6f1c2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d800590>]}
[0m15:14:55.679253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '003e5fa2-e7a2-463c-b871-4adaf6f1c2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108c30e0>]}
[0m15:14:55.680180 [info ] [MainThread]: Found 3 models, 2 sources, 459 macros
[0m15:14:55.680712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '003e5fa2-e7a2-463c-b871-4adaf6f1c2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13dbe9100>]}
[0m15:14:55.683491 [info ] [MainThread]: 
[0m15:14:55.684606 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:14:55.691004 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m15:14:55.711800 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m15:14:55.712424 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m15:14:55.712908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:56.381818 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.668 seconds
[0m15:14:56.387180 [debug] [ThreadPool]: On list_lab2: Close
[0m15:14:56.530082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m15:14:56.550264 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:14:56.551018 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:14:56.551526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:57.180129 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.628 seconds
[0m15:14:57.185792 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:14:57.326509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '003e5fa2-e7a2-463c-b871-4adaf6f1c2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d92faa0>]}
[0m15:14:57.328176 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:14:57.329050 [info ] [MainThread]: 
[0m15:14:57.337106 [debug] [Thread-1 (]: Began running node model.stock_calc.data_cleaned
[0m15:14:57.338504 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.data_cleaned ............................. [RUN]
[0m15:14:57.339512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.stock_calc.data_cleaned)
[0m15:14:57.340220 [debug] [Thread-1 (]: Began compiling node model.stock_calc.data_cleaned
[0m15:14:57.356403 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.data_cleaned"
[0m15:14:57.359199 [debug] [Thread-1 (]: Began executing node model.stock_calc.data_cleaned
[0m15:14:57.406333 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.data_cleaned"
[0m15:14:57.409013 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.data_cleaned"
[0m15:14:57.409774 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.data_cleaned"} */
create or replace   view lab2.analytics.data_cleaned
  
   as (
    SELECT
	date,
	close,
	symbol,
	PRIMARY KEY (date, symbol)
FROM lab2.raw_data.stock_price
ORDER BY date DESC
  );
[0m15:14:57.410314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:58.058229 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b854d2-0004-26af-0002-65f30001155a
[0m15:14:58.059592 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 13 unexpected '('.
syntax error line 11 at position 2 unexpected ')'.
[0m15:14:58.060960 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: Close
[0m15:14:58.223347 [debug] [Thread-1 (]: Database Error in model data_cleaned (models/input/data_cleaned.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 13 unexpected '('.
  syntax error line 11 at position 2 unexpected ')'.
  compiled code at target/run/stock_calc/models/input/data_cleaned.sql
[0m15:14:58.226745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '003e5fa2-e7a2-463c-b871-4adaf6f1c2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13dd46210>]}
[0m15:14:58.228378 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model analytics.data_cleaned .................... [[31mERROR[0m in 0.89s]
[0m15:14:58.230726 [debug] [Thread-1 (]: Finished running node model.stock_calc.data_cleaned
[0m15:14:58.231706 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_rsi
[0m15:14:58.234389 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.stock_rsi ............................... [RUN]
[0m15:14:58.235685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.data_cleaned, now model.stock_calc.stock_rsi)
[0m15:14:58.236757 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_rsi
[0m15:14:58.240347 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_rsi"
[0m15:14:58.244255 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_rsi
[0m15:14:58.277126 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_rsi"
[0m15:14:58.282071 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_rsi"
[0m15:14:58.282782 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_rsi"} */
create or replace transient table lab2.analytics.stock_rsi
         as
        (WITH price_changes AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM analytics.data_cleaned
),
gains_losses AS (
    SELECT 
        symbol,
        date,
        close,
        previous_close,
        close - previous_close AS price_change,
        CASE 
            WHEN close - previous_close > 0 THEN close - previous_close 
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close - previous_close < 0 THEN ABS(close - previous_close) 
            ELSE 0 
        END AS loss
    FROM price_changes
    WHERE previous_close IS NOT NULL
),
average_gain_loss AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_losses
),
relative_strength AS (
    SELECT
        symbol,
        date,
        avg_gain,
        avg_loss,
        CASE 
            WHEN avg_loss = 0 THEN NULL
            ELSE avg_gain / avg_loss 
        END AS rs
    FROM average_gain_loss
),
rsi_values AS (
    SELECT
        symbol,
        date,
        CASE
            WHEN rs IS NULL THEN NULL
            ELSE 100 - (100 / (1 + rs))
        END AS rsi
    FROM relative_strength
)

SELECT symbol, date, rsi
FROM rsi_values
WHERE rsi IS NOT NULL
ORDER BY symbol, date DESC
        );
[0m15:14:58.283386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:59.548996 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.265 seconds
[0m15:14:59.600069 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: Close
[0m15:14:59.731305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '003e5fa2-e7a2-463c-b871-4adaf6f1c2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d774cb0>]}
[0m15:14:59.733373 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.stock_rsi .......................... [[32mSUCCESS 1[0m in 1.50s]
[0m15:14:59.737446 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_rsi
[0m15:14:59.739064 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_moving_avg
[0m15:14:59.740661 [info ] [Thread-1 (]: 3 of 3 SKIP relation analytics.stock_moving_avg ................................ [[33mSKIP[0m]
[0m15:14:59.741990 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_moving_avg
[0m15:14:59.744762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:59.745519 [debug] [MainThread]: Connection 'model.stock_calc.stock_rsi' was properly closed.
[0m15:14:59.746337 [info ] [MainThread]: 
[0m15:14:59.747301 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 4.06 seconds (4.06s).
[0m15:14:59.749482 [debug] [MainThread]: Command end result
[0m15:14:59.789948 [info ] [MainThread]: 
[0m15:14:59.790730 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:14:59.791241 [info ] [MainThread]: 
[0m15:14:59.791813 [error] [MainThread]:   Database Error in model data_cleaned (models/input/data_cleaned.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 13 unexpected '('.
  syntax error line 11 at position 2 unexpected ')'.
  compiled code at target/run/stock_calc/models/input/data_cleaned.sql
[0m15:14:59.792318 [info ] [MainThread]: 
[0m15:14:59.792874 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m15:14:59.797773 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.793946, "process_user_time": 5.494103, "process_kernel_time": 1.464421, "process_mem_max_rss": "180498432", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:14:59.798779 [debug] [MainThread]: Command `dbt run` failed at 15:14:59.798612 after 8.80 seconds
[0m15:14:59.799389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13dbc8380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11137cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11137cef0>]}
[0m15:14:59.800012 [debug] [MainThread]: Flushing usage events
[0m15:15:41.102008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052de960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d8d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d8ccb0>]}


============================== 15:15:41.110268 | 2a1560b1-86b6-4978-b8ca-1dec12304eb8 ==============================
[0m15:15:41.110268 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:15:41.111889 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'introspect': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'write_json': 'True', 'debug': 'False', 'printer_width': '80', 'partial_parse': 'True', 'version_check': 'True', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'invocation_command': 'dbt run', 'log_format': 'default', 'empty': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs'}
[0m15:15:43.489843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a1560b1-86b6-4978-b8ca-1dec12304eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d4aa20>]}
[0m15:15:43.579413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a1560b1-86b6-4978-b8ca-1dec12304eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132cf6090>]}
[0m15:15:43.581002 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:15:43.613900 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:15:43.880555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:15:43.882803 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:15:43.890964 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:15:43.932512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a1560b1-86b6-4978-b8ca-1dec12304eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1331786e0>]}
[0m15:15:44.066952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a1560b1-86b6-4978-b8ca-1dec12304eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13340c200>]}
[0m15:15:44.067706 [info ] [MainThread]: Found 3 models, 2 sources, 459 macros
[0m15:15:44.068221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a1560b1-86b6-4978-b8ca-1dec12304eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133403950>]}
[0m15:15:44.071064 [info ] [MainThread]: 
[0m15:15:44.072067 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:15:44.078480 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m15:15:44.099902 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m15:15:44.100550 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m15:15:44.101021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:44.807792 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.706 seconds
[0m15:15:44.813448 [debug] [ThreadPool]: On list_lab2: Close
[0m15:15:44.988607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m15:15:45.013090 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:15:45.014004 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:15:45.014747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:45.721857 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.707 seconds
[0m15:15:45.726274 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:15:45.895820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a1560b1-86b6-4978-b8ca-1dec12304eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1331e5df0>]}
[0m15:15:45.897391 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:15:45.898554 [info ] [MainThread]: 
[0m15:15:45.905907 [debug] [Thread-1 (]: Began running node model.stock_calc.data_cleaned
[0m15:15:45.907354 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.data_cleaned ............................. [RUN]
[0m15:15:45.908579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.stock_calc.data_cleaned)
[0m15:15:45.909461 [debug] [Thread-1 (]: Began compiling node model.stock_calc.data_cleaned
[0m15:15:45.922563 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.data_cleaned"
[0m15:15:45.925894 [debug] [Thread-1 (]: Began executing node model.stock_calc.data_cleaned
[0m15:15:45.973048 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.data_cleaned"
[0m15:15:45.974718 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.data_cleaned"
[0m15:15:45.975342 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.data_cleaned"} */
create or replace   view lab2.analytics.data_cleaned
  
   as (
    SELECT
	date,
	close,
	symbol,
	PRIMARY KEY (date, symbol)
FROM lab2.raw_data.stock_price
ORDER BY date DESC
  );
[0m15:15:45.975902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:46.623681 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b854d3-0004-26b9-0002-65f3000124c2
[0m15:15:46.624580 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 13 unexpected '('.
syntax error line 11 at position 2 unexpected ')'.
[0m15:15:46.625347 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: Close
[0m15:15:46.761237 [debug] [Thread-1 (]: Database Error in model data_cleaned (models/input/data_cleaned.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 13 unexpected '('.
  syntax error line 11 at position 2 unexpected ')'.
  compiled code at target/run/stock_calc/models/input/data_cleaned.sql
[0m15:15:46.764843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a1560b1-86b6-4978-b8ca-1dec12304eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063313d0>]}
[0m15:15:46.766241 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model analytics.data_cleaned .................... [[31mERROR[0m in 0.85s]
[0m15:15:46.768118 [debug] [Thread-1 (]: Finished running node model.stock_calc.data_cleaned
[0m15:15:46.769248 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_rsi
[0m15:15:46.771678 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.stock_rsi ............................... [RUN]
[0m15:15:46.772571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.data_cleaned, now model.stock_calc.stock_rsi)
[0m15:15:46.773215 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_rsi
[0m15:15:46.776519 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_rsi"
[0m15:15:46.777841 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_rsi
[0m15:15:46.812000 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_rsi"
[0m15:15:46.816079 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_rsi"
[0m15:15:46.817022 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_rsi"} */
create or replace transient table lab2.analytics.stock_rsi
         as
        (WITH price_changes AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM analytics.data_cleaned
),
gains_losses AS (
    SELECT 
        symbol,
        date,
        close,
        previous_close,
        close - previous_close AS price_change,
        CASE 
            WHEN close - previous_close > 0 THEN close - previous_close 
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close - previous_close < 0 THEN ABS(close - previous_close) 
            ELSE 0 
        END AS loss
    FROM price_changes
    WHERE previous_close IS NOT NULL
),
average_gain_loss AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_losses
),
relative_strength AS (
    SELECT
        symbol,
        date,
        avg_gain,
        avg_loss,
        CASE 
            WHEN avg_loss = 0 THEN NULL
            ELSE avg_gain / avg_loss 
        END AS rs
    FROM average_gain_loss
),
rsi_values AS (
    SELECT
        symbol,
        date,
        CASE
            WHEN rs IS NULL THEN NULL
            ELSE 100 - (100 / (1 + rs))
        END AS rsi
    FROM relative_strength
)

SELECT symbol, date, rsi
FROM rsi_values
WHERE rsi IS NOT NULL
ORDER BY symbol, date DESC
        );
[0m15:15:46.818172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:48.419356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.601 seconds
[0m15:15:48.463324 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: Close
[0m15:15:48.899540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a1560b1-86b6-4978-b8ca-1dec12304eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1335777d0>]}
[0m15:15:48.901622 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.stock_rsi .......................... [[32mSUCCESS 1[0m in 2.13s]
[0m15:15:48.903416 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_rsi
[0m15:15:48.904597 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_moving_avg
[0m15:15:48.905496 [info ] [Thread-1 (]: 3 of 3 SKIP relation analytics.stock_moving_avg ................................ [[33mSKIP[0m]
[0m15:15:48.906649 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_moving_avg
[0m15:15:48.909530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:48.910339 [debug] [MainThread]: Connection 'model.stock_calc.stock_rsi' was properly closed.
[0m15:15:48.911111 [info ] [MainThread]: 
[0m15:15:48.911791 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 4.84 seconds (4.84s).
[0m15:15:48.913416 [debug] [MainThread]: Command end result
[0m15:15:48.951402 [info ] [MainThread]: 
[0m15:15:48.952144 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:15:48.952651 [info ] [MainThread]: 
[0m15:15:48.953314 [error] [MainThread]:   Database Error in model data_cleaned (models/input/data_cleaned.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 13 unexpected '('.
  syntax error line 11 at position 2 unexpected ')'.
  compiled code at target/run/stock_calc/models/input/data_cleaned.sql
[0m15:15:48.954002 [info ] [MainThread]: 
[0m15:15:48.954734 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m15:15:48.962752 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.969142, "process_user_time": 5.231175, "process_kernel_time": 1.18954, "process_mem_max_rss": "177160192", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:15:48.963848 [debug] [MainThread]: Command `dbt run` failed at 15:15:48.963619 after 7.97 seconds
[0m15:15:48.964634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed7440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c540b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d8cf20>]}
[0m15:15:48.965175 [debug] [MainThread]: Flushing usage events
[0m15:16:51.249243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10651ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fcd190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fcce60>]}


============================== 15:16:51.264408 | a49670bf-915e-4964-9468-a7257d621841 ==============================
[0m15:16:51.264408 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:16:51.265515 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'no_print': 'None', 'use_colors': 'True', 'empty': 'False', 'warn_error': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'partial_parse': 'True', 'printer_width': '80', 'target_path': 'None', 'debug': 'False'}
[0m15:16:54.732088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a49670bf-915e-4964-9468-a7257d621841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13425c3b0>]}
[0m15:16:54.822902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a49670bf-915e-4964-9468-a7257d621841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a12e0>]}
[0m15:16:54.825130 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:16:54.859695 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:16:55.118460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:16:55.119529 [debug] [MainThread]: Partial parsing: updated file: stock_calc://models/input/data_cleaned.sql
[0m15:16:55.650775 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:16:55.682119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a49670bf-915e-4964-9468-a7257d621841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13440f380>]}
[0m15:16:55.858064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a49670bf-915e-4964-9468-a7257d621841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13453fdd0>]}
[0m15:16:55.858924 [info ] [MainThread]: Found 3 models, 2 sources, 459 macros
[0m15:16:55.859914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a49670bf-915e-4964-9468-a7257d621841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13440cd70>]}
[0m15:16:55.863445 [info ] [MainThread]: 
[0m15:16:55.864735 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:16:55.872000 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m15:16:55.893577 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m15:16:55.894245 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m15:16:55.894743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:56.536925 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.642 seconds
[0m15:16:56.541385 [debug] [ThreadPool]: On list_lab2: Close
[0m15:16:56.675733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m15:16:56.689652 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:16:56.690254 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:16:56.690699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:57.331994 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.641 seconds
[0m15:16:57.337712 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:16:57.499829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a49670bf-915e-4964-9468-a7257d621841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13437c9b0>]}
[0m15:16:57.501414 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:16:57.502187 [info ] [MainThread]: 
[0m15:16:57.508604 [debug] [Thread-1 (]: Began running node model.stock_calc.data_cleaned
[0m15:16:57.509869 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.data_cleaned ............................. [RUN]
[0m15:16:57.510741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.stock_calc.data_cleaned)
[0m15:16:57.511413 [debug] [Thread-1 (]: Began compiling node model.stock_calc.data_cleaned
[0m15:16:57.525147 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.data_cleaned"
[0m15:16:57.527540 [debug] [Thread-1 (]: Began executing node model.stock_calc.data_cleaned
[0m15:16:57.584163 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.data_cleaned"
[0m15:16:57.587156 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.data_cleaned"
[0m15:16:57.588301 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.data_cleaned"} */
create or replace   view lab2.analytics.data_cleaned
  
   as (
    SELECT
	date,
	close,
	symbol
FROM lab2.raw_data.stock_price
ORDER BY date DESC
  );
[0m15:16:57.588894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:58.530968 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.941 seconds
[0m15:16:58.582211 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: Close
[0m15:16:58.750639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a49670bf-915e-4964-9468-a7257d621841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107571580>]}
[0m15:16:58.752482 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.data_cleaned ........................ [[32mSUCCESS 1[0m in 1.24s]
[0m15:16:58.755108 [debug] [Thread-1 (]: Finished running node model.stock_calc.data_cleaned
[0m15:16:58.756159 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_rsi
[0m15:16:58.757528 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.stock_rsi ............................... [RUN]
[0m15:16:58.758824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.data_cleaned, now model.stock_calc.stock_rsi)
[0m15:16:58.759618 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_rsi
[0m15:16:58.762674 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_rsi"
[0m15:16:58.765103 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_rsi
[0m15:16:58.815069 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_rsi"
[0m15:16:58.818594 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_rsi"
[0m15:16:58.819570 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_rsi"} */
create or replace transient table lab2.analytics.stock_rsi
         as
        (WITH price_changes AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM analytics.data_cleaned
),
gains_losses AS (
    SELECT 
        symbol,
        date,
        close,
        previous_close,
        close - previous_close AS price_change,
        CASE 
            WHEN close - previous_close > 0 THEN close - previous_close 
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close - previous_close < 0 THEN ABS(close - previous_close) 
            ELSE 0 
        END AS loss
    FROM price_changes
    WHERE previous_close IS NOT NULL
),
average_gain_loss AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_losses
),
relative_strength AS (
    SELECT
        symbol,
        date,
        avg_gain,
        avg_loss,
        CASE 
            WHEN avg_loss = 0 THEN NULL
            ELSE avg_gain / avg_loss 
        END AS rs
    FROM average_gain_loss
),
rsi_values AS (
    SELECT
        symbol,
        date,
        CASE
            WHEN rs IS NULL THEN NULL
            ELSE 100 - (100 / (1 + rs))
        END AS rsi
    FROM relative_strength
)

SELECT symbol, date, rsi
FROM rsi_values
WHERE rsi IS NOT NULL
ORDER BY symbol, date DESC
        );
[0m15:16:58.820362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:00.276284 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.455 seconds
[0m15:17:00.282971 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: Close
[0m15:17:00.414401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a49670bf-915e-4964-9468-a7257d621841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134aa0ce0>]}
[0m15:17:00.415661 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.stock_rsi .......................... [[32mSUCCESS 1[0m in 1.66s]
[0m15:17:00.416617 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_rsi
[0m15:17:00.417349 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_moving_avg
[0m15:17:00.418132 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.stock_moving_avg ........................ [RUN]
[0m15:17:00.418826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.stock_rsi, now model.stock_calc.stock_moving_avg)
[0m15:17:00.419353 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_moving_avg
[0m15:17:00.425528 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_moving_avg"
[0m15:17:00.427826 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_moving_avg
[0m15:17:00.431732 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_moving_avg"
[0m15:17:00.433750 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_moving_avg"
[0m15:17:00.434402 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_moving_avg"} */
create or replace transient table lab2.analytics.stock_moving_avg
         as
        (SELECT
	symbol,
	date,
	AVG(close) OVER (
		PARTITION BY symbol
		ORDER BY date
		ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
	) AS moving_avg
FROM
	lab2.analytics.data_cleaned
        );
[0m15:17:00.434929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:01.954116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.519 seconds
[0m15:17:01.960990 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: Close
[0m15:17:02.146338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a49670bf-915e-4964-9468-a7257d621841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13483bb60>]}
[0m15:17:02.147959 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.stock_moving_avg ................... [[32mSUCCESS 1[0m in 1.73s]
[0m15:17:02.149473 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_moving_avg
[0m15:17:02.151853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:02.152514 [debug] [MainThread]: Connection 'model.stock_calc.stock_moving_avg' was properly closed.
[0m15:17:02.153513 [info ] [MainThread]: 
[0m15:17:02.154320 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 6.29 seconds (6.29s).
[0m15:17:02.157023 [debug] [MainThread]: Command end result
[0m15:17:02.196207 [info ] [MainThread]: 
[0m15:17:02.196959 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:17:02.197451 [info ] [MainThread]: 
[0m15:17:02.197962 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:17:02.203102 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.072364, "process_user_time": 5.84789, "process_kernel_time": 1.497808, "process_mem_max_rss": "180158464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:17:02.204473 [debug] [MainThread]: Command `dbt run` succeeded at 15:17:02.204189 after 11.07 seconds
[0m15:17:02.205570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134687500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1347ffd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134961eb0>]}
[0m15:17:02.206458 [debug] [MainThread]: Flushing usage events
[0m15:17:16.552767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a339250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb310d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb30c80>]}


============================== 15:17:16.557628 | 4be1aed9-dd49-4fc7-9db4-4dbdf50d54ca ==============================
[0m15:17:16.557628 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:17:16.558629 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'debug': 'False', 'fail_fast': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'introspect': 'True', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'static_parser': 'True', 'version_check': 'True', 'empty': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_cache_events': 'False'}
[0m15:17:18.022705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4be1aed9-dd49-4fc7-9db4-4dbdf50d54ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb60830>]}
[0m15:17:18.108236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4be1aed9-dd49-4fc7-9db4-4dbdf50d54ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b63a70>]}
[0m15:17:18.110374 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:17:18.140470 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:17:18.378590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:17:18.379550 [debug] [MainThread]: Partial parsing: updated file: stock_calc://models/input/data_cleaned.sql
[0m15:17:18.737049 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:17:18.755035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4be1aed9-dd49-4fc7-9db4-4dbdf50d54ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138206a80>]}
[0m15:17:18.893595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4be1aed9-dd49-4fc7-9db4-4dbdf50d54ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13809e6f0>]}
[0m15:17:18.894538 [info ] [MainThread]: Found 3 models, 2 sources, 459 macros
[0m15:17:18.895121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4be1aed9-dd49-4fc7-9db4-4dbdf50d54ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137f9f5c0>]}
[0m15:17:18.898316 [info ] [MainThread]: 
[0m15:17:18.899527 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:17:18.906239 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m15:17:18.925838 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m15:17:18.926474 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m15:17:18.926940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:19.661811 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.735 seconds
[0m15:17:19.667460 [debug] [ThreadPool]: On list_lab2: Close
[0m15:17:19.831744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m15:17:19.849433 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:17:19.850174 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:17:19.850677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:20.503752 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.653 seconds
[0m15:17:20.509037 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:17:20.682217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4be1aed9-dd49-4fc7-9db4-4dbdf50d54ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a43d250>]}
[0m15:17:20.684202 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:17:20.685106 [info ] [MainThread]: 
[0m15:17:20.690703 [debug] [Thread-1 (]: Began running node model.stock_calc.data_cleaned
[0m15:17:20.692003 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.data_cleaned ............................. [RUN]
[0m15:17:20.693075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.stock_calc.data_cleaned)
[0m15:17:20.693923 [debug] [Thread-1 (]: Began compiling node model.stock_calc.data_cleaned
[0m15:17:20.706673 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.data_cleaned"
[0m15:17:20.707949 [debug] [Thread-1 (]: Began executing node model.stock_calc.data_cleaned
[0m15:17:20.753410 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.data_cleaned"
[0m15:17:20.755020 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.data_cleaned"
[0m15:17:20.755588 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.data_cleaned"} */
create or replace   view lab2.analytics.data_cleaned
  
   as (
    SELECT
	date,
	close,
	symbol
FROM lab2.raw_data.stock_price
ORDER BY symbol, date DESC
  );
[0m15:17:20.756075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:21.644661 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.888 seconds
[0m15:17:21.686694 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: Close
[0m15:17:21.855433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be1aed9-dd49-4fc7-9db4-4dbdf50d54ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137eac6b0>]}
[0m15:17:21.857420 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.data_cleaned ........................ [[32mSUCCESS 1[0m in 1.16s]
[0m15:17:21.859188 [debug] [Thread-1 (]: Finished running node model.stock_calc.data_cleaned
[0m15:17:21.860287 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_rsi
[0m15:17:21.861854 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.stock_rsi ............................... [RUN]
[0m15:17:21.863037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.data_cleaned, now model.stock_calc.stock_rsi)
[0m15:17:21.863908 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_rsi
[0m15:17:21.867105 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_rsi"
[0m15:17:21.868648 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_rsi
[0m15:17:21.905655 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_rsi"
[0m15:17:21.908887 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_rsi"
[0m15:17:21.909924 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_rsi"} */
create or replace transient table lab2.analytics.stock_rsi
         as
        (WITH price_changes AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM analytics.data_cleaned
),
gains_losses AS (
    SELECT 
        symbol,
        date,
        close,
        previous_close,
        close - previous_close AS price_change,
        CASE 
            WHEN close - previous_close > 0 THEN close - previous_close 
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close - previous_close < 0 THEN ABS(close - previous_close) 
            ELSE 0 
        END AS loss
    FROM price_changes
    WHERE previous_close IS NOT NULL
),
average_gain_loss AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_losses
),
relative_strength AS (
    SELECT
        symbol,
        date,
        avg_gain,
        avg_loss,
        CASE 
            WHEN avg_loss = 0 THEN NULL
            ELSE avg_gain / avg_loss 
        END AS rs
    FROM average_gain_loss
),
rsi_values AS (
    SELECT
        symbol,
        date,
        CASE
            WHEN rs IS NULL THEN NULL
            ELSE 100 - (100 / (1 + rs))
        END AS rsi
    FROM relative_strength
)

SELECT symbol, date, rsi
FROM rsi_values
WHERE rsi IS NOT NULL
ORDER BY symbol, date DESC
        );
[0m15:17:21.911077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:23.335531 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.424 seconds
[0m15:17:23.342867 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: Close
[0m15:17:23.490295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be1aed9-dd49-4fc7-9db4-4dbdf50d54ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138519670>]}
[0m15:17:23.492129 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.stock_rsi .......................... [[32mSUCCESS 1[0m in 1.63s]
[0m15:17:23.494105 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_rsi
[0m15:17:23.495284 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_moving_avg
[0m15:17:23.496705 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.stock_moving_avg ........................ [RUN]
[0m15:17:23.498237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.stock_rsi, now model.stock_calc.stock_moving_avg)
[0m15:17:23.499228 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_moving_avg
[0m15:17:23.506436 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_moving_avg"
[0m15:17:23.507984 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_moving_avg
[0m15:17:23.512032 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_moving_avg"
[0m15:17:23.513670 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_moving_avg"
[0m15:17:23.514239 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_moving_avg"} */
create or replace transient table lab2.analytics.stock_moving_avg
         as
        (SELECT
	symbol,
	date,
	AVG(close) OVER (
		PARTITION BY symbol
		ORDER BY date
		ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
	) AS moving_avg
FROM
	lab2.analytics.data_cleaned
        );
[0m15:17:23.514753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:24.955784 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.441 seconds
[0m15:17:24.959861 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: Close
[0m15:17:25.119937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be1aed9-dd49-4fc7-9db4-4dbdf50d54ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1384cf200>]}
[0m15:17:25.121816 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.stock_moving_avg ................... [[32mSUCCESS 1[0m in 1.62s]
[0m15:17:25.123881 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_moving_avg
[0m15:17:25.127510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:25.128379 [debug] [MainThread]: Connection 'model.stock_calc.stock_moving_avg' was properly closed.
[0m15:17:25.129603 [info ] [MainThread]: 
[0m15:17:25.130803 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 6.23 seconds (6.23s).
[0m15:17:25.132976 [debug] [MainThread]: Command end result
[0m15:17:25.174754 [info ] [MainThread]: 
[0m15:17:25.175702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:17:25.176598 [info ] [MainThread]: 
[0m15:17:25.177486 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:17:25.182696 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.723583, "process_user_time": 5.153089, "process_kernel_time": 0.855543, "process_mem_max_rss": "179884032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:17:25.183931 [debug] [MainThread]: Command `dbt run` succeeded at 15:17:25.183643 after 8.72 seconds
[0m15:17:25.184820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb30ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138004f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b58b3b0>]}
[0m15:17:25.185517 [debug] [MainThread]: Flushing usage events
[0m15:18:16.033847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4acdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef753a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef75070>]}


============================== 15:18:16.044132 | 1307380e-a6c7-475d-800f-004dac3118c7 ==============================
[0m15:18:16.044132 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:18:16.045159 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error': 'None', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'debug': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'fail_fast': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'quiet': 'False', 'empty': 'False', 'use_colors': 'True'}
[0m15:18:19.003003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1307380e-a6c7-475d-800f-004dac3118c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de48680>]}
[0m15:18:19.087434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1307380e-a6c7-475d-800f-004dac3118c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc20680>]}
[0m15:18:19.090231 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:18:19.121565 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:18:19.382714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:18:19.383665 [debug] [MainThread]: Partial parsing: updated file: stock_calc://models/input/data_cleaned.sql
[0m15:18:19.733965 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:18:19.751373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1307380e-a6c7-475d-800f-004dac3118c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b7a3500>]}
[0m15:18:19.881624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1307380e-a6c7-475d-800f-004dac3118c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b4de300>]}
[0m15:18:19.882498 [info ] [MainThread]: Found 3 models, 2 sources, 459 macros
[0m15:18:19.883098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1307380e-a6c7-475d-800f-004dac3118c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b7a3d70>]}
[0m15:18:19.886193 [info ] [MainThread]: 
[0m15:18:19.887242 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:18:19.894260 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m15:18:19.913468 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m15:18:19.914102 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m15:18:19.914574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:20.660210 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.744 seconds
[0m15:18:20.665019 [debug] [ThreadPool]: On list_lab2: Close
[0m15:18:20.811143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m15:18:20.827514 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:18:20.828156 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:18:20.829131 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:21.504680 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.676 seconds
[0m15:18:21.507825 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:18:21.664457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1307380e-a6c7-475d-800f-004dac3118c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d849190>]}
[0m15:18:21.666199 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:21.667303 [info ] [MainThread]: 
[0m15:18:21.673700 [debug] [Thread-1 (]: Began running node model.stock_calc.data_cleaned
[0m15:18:21.675225 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.data_cleaned ............................. [RUN]
[0m15:18:21.676377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.stock_calc.data_cleaned)
[0m15:18:21.677249 [debug] [Thread-1 (]: Began compiling node model.stock_calc.data_cleaned
[0m15:18:21.691342 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.data_cleaned"
[0m15:18:21.693251 [debug] [Thread-1 (]: Began executing node model.stock_calc.data_cleaned
[0m15:18:21.746082 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.data_cleaned"
[0m15:18:21.748042 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.data_cleaned"
[0m15:18:21.748680 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.data_cleaned"} */
create or replace   view lab2.analytics.data_cleaned
  
   as (
    SELECT
	date,
	close,
	symbol
FROM lab2.raw_data.stock_price
ORDER BY date DESC, symbol
  );
[0m15:18:21.749219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:22.593612 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.844 seconds
[0m15:18:22.633703 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: Close
[0m15:18:22.771370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1307380e-a6c7-475d-800f-004dac3118c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b2f0560>]}
[0m15:18:22.773020 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.data_cleaned ........................ [[32mSUCCESS 1[0m in 1.09s]
[0m15:18:22.776823 [debug] [Thread-1 (]: Finished running node model.stock_calc.data_cleaned
[0m15:18:22.777921 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_rsi
[0m15:18:22.779301 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.stock_rsi ............................... [RUN]
[0m15:18:22.780374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.data_cleaned, now model.stock_calc.stock_rsi)
[0m15:18:22.781151 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_rsi
[0m15:18:22.784136 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_rsi"
[0m15:18:22.785703 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_rsi
[0m15:18:22.821375 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_rsi"
[0m15:18:22.825205 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_rsi"
[0m15:18:22.825972 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_rsi"} */
create or replace transient table lab2.analytics.stock_rsi
         as
        (WITH price_changes AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM analytics.data_cleaned
),
gains_losses AS (
    SELECT 
        symbol,
        date,
        close,
        previous_close,
        close - previous_close AS price_change,
        CASE 
            WHEN close - previous_close > 0 THEN close - previous_close 
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close - previous_close < 0 THEN ABS(close - previous_close) 
            ELSE 0 
        END AS loss
    FROM price_changes
    WHERE previous_close IS NOT NULL
),
average_gain_loss AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_losses
),
relative_strength AS (
    SELECT
        symbol,
        date,
        avg_gain,
        avg_loss,
        CASE 
            WHEN avg_loss = 0 THEN NULL
            ELSE avg_gain / avg_loss 
        END AS rs
    FROM average_gain_loss
),
rsi_values AS (
    SELECT
        symbol,
        date,
        CASE
            WHEN rs IS NULL THEN NULL
            ELSE 100 - (100 / (1 + rs))
        END AS rsi
    FROM relative_strength
)

SELECT symbol, date, rsi
FROM rsi_values
WHERE rsi IS NOT NULL
ORDER BY symbol, date DESC
        );
[0m15:18:22.827271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:24.853730 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.026 seconds
[0m15:18:24.860360 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: Close
[0m15:18:25.004301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1307380e-a6c7-475d-800f-004dac3118c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ba44aa0>]}
[0m15:18:25.006100 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.stock_rsi .......................... [[32mSUCCESS 1[0m in 2.22s]
[0m15:18:25.007866 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_rsi
[0m15:18:25.009100 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_moving_avg
[0m15:18:25.010286 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.stock_moving_avg ........................ [RUN]
[0m15:18:25.011389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.stock_rsi, now model.stock_calc.stock_moving_avg)
[0m15:18:25.012218 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_moving_avg
[0m15:18:25.019343 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_moving_avg"
[0m15:18:25.020841 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_moving_avg
[0m15:18:25.024860 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_moving_avg"
[0m15:18:25.026647 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_moving_avg"
[0m15:18:25.027294 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_moving_avg"} */
create or replace transient table lab2.analytics.stock_moving_avg
         as
        (SELECT
	symbol,
	date,
	AVG(close) OVER (
		PARTITION BY symbol
		ORDER BY date
		ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
	) AS moving_avg
FROM
	lab2.analytics.data_cleaned
        );
[0m15:18:25.027833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:26.954629 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.926 seconds
[0m15:18:26.960811 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: Close
[0m15:18:27.108794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1307380e-a6c7-475d-800f-004dac3118c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b90f140>]}
[0m15:18:27.110006 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.stock_moving_avg ................... [[32mSUCCESS 1[0m in 2.10s]
[0m15:18:27.111270 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_moving_avg
[0m15:18:27.113538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:27.114147 [debug] [MainThread]: Connection 'model.stock_calc.stock_moving_avg' was properly closed.
[0m15:18:27.114799 [info ] [MainThread]: 
[0m15:18:27.115420 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 7.23 seconds (7.23s).
[0m15:18:27.117023 [debug] [MainThread]: Command end result
[0m15:18:27.163039 [info ] [MainThread]: 
[0m15:18:27.164078 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:27.164826 [info ] [MainThread]: 
[0m15:18:27.165656 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:18:27.173531 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.257347, "process_user_time": 5.66581, "process_kernel_time": 1.310955, "process_mem_max_rss": "179867648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:18:27.174949 [debug] [MainThread]: Command `dbt run` succeeded at 15:18:27.174703 after 11.26 seconds
[0m15:18:27.176043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b6edbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef75310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef752b0>]}
[0m15:18:27.176839 [debug] [MainThread]: Flushing usage events
[0m15:19:01.489519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b10290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b3d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b3ce00>]}


============================== 15:19:01.495606 | ef207b63-1aa4-4f36-90ed-7ce7910aa002 ==============================
[0m15:19:01.495606 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:19:01.496663 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'target_path': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'write_json': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'no_print': 'None', 'empty': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'quiet': 'False', 'introspect': 'True', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'log_format': 'default'}
[0m15:19:03.689779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef207b63-1aa4-4f36-90ed-7ce7910aa002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ebc6e0>]}
[0m15:19:03.776511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef207b63-1aa4-4f36-90ed-7ce7910aa002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ebc680>]}
[0m15:19:03.779291 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:19:03.809084 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:19:04.051984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:19:04.052937 [debug] [MainThread]: Partial parsing: updated file: stock_calc://models/input/data_cleaned.sql
[0m15:19:04.414560 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:19:04.433127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef207b63-1aa4-4f36-90ed-7ce7910aa002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1323678c0>]}
[0m15:19:04.565422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef207b63-1aa4-4f36-90ed-7ce7910aa002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1320a6120>]}
[0m15:19:04.566193 [info ] [MainThread]: Found 3 models, 2 sources, 459 macros
[0m15:19:04.566701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef207b63-1aa4-4f36-90ed-7ce7910aa002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131f71e50>]}
[0m15:19:04.569506 [info ] [MainThread]: 
[0m15:19:04.570554 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:19:04.577008 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m15:19:04.596514 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m15:19:04.597149 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m15:19:04.597612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:05.232363 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.635 seconds
[0m15:19:05.236722 [debug] [ThreadPool]: On list_lab2: Close
[0m15:19:05.382995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m15:19:05.399429 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:19:05.400085 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:19:05.400586 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:06.125012 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.724 seconds
[0m15:19:06.130026 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:19:06.302145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef207b63-1aa4-4f36-90ed-7ce7910aa002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104444ec0>]}
[0m15:19:06.304456 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:19:06.305949 [info ] [MainThread]: 
[0m15:19:06.312644 [debug] [Thread-1 (]: Began running node model.stock_calc.data_cleaned
[0m15:19:06.314734 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.data_cleaned ............................. [RUN]
[0m15:19:06.316343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.stock_calc.data_cleaned)
[0m15:19:06.317315 [debug] [Thread-1 (]: Began compiling node model.stock_calc.data_cleaned
[0m15:19:06.329780 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.data_cleaned"
[0m15:19:06.331180 [debug] [Thread-1 (]: Began executing node model.stock_calc.data_cleaned
[0m15:19:06.381345 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.data_cleaned"
[0m15:19:06.384782 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.data_cleaned"
[0m15:19:06.385521 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.data_cleaned"} */
create or replace   view lab2.analytics.data_cleaned
  
   as (
    SELECT
	date,
	close,
	symbol
FROM lab2.raw_data.stock_price
ORDER BY symbol, date DESC
  );
[0m15:19:06.386122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:07.309752 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.923 seconds
[0m15:19:07.356967 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: Close
[0m15:19:07.558913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef207b63-1aa4-4f36-90ed-7ce7910aa002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131eb0980>]}
[0m15:19:07.560770 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.data_cleaned ........................ [[32mSUCCESS 1[0m in 1.24s]
[0m15:19:07.562327 [debug] [Thread-1 (]: Finished running node model.stock_calc.data_cleaned
[0m15:19:07.563534 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_rsi
[0m15:19:07.564694 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.stock_rsi ............................... [RUN]
[0m15:19:07.565848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.data_cleaned, now model.stock_calc.stock_rsi)
[0m15:19:07.566706 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_rsi
[0m15:19:07.570205 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_rsi"
[0m15:19:07.571537 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_rsi
[0m15:19:07.609061 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_rsi"
[0m15:19:07.612279 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_rsi"
[0m15:19:07.613037 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_rsi"} */
create or replace transient table lab2.analytics.stock_rsi
         as
        (WITH price_changes AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM analytics.data_cleaned
),
gains_losses AS (
    SELECT 
        symbol,
        date,
        close,
        previous_close,
        close - previous_close AS price_change,
        CASE 
            WHEN close - previous_close > 0 THEN close - previous_close 
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close - previous_close < 0 THEN ABS(close - previous_close) 
            ELSE 0 
        END AS loss
    FROM price_changes
    WHERE previous_close IS NOT NULL
),
average_gain_loss AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_losses
),
relative_strength AS (
    SELECT
        symbol,
        date,
        avg_gain,
        avg_loss,
        CASE 
            WHEN avg_loss = 0 THEN NULL
            ELSE avg_gain / avg_loss 
        END AS rs
    FROM average_gain_loss
),
rsi_values AS (
    SELECT
        symbol,
        date,
        CASE
            WHEN rs IS NULL THEN NULL
            ELSE 100 - (100 / (1 + rs))
        END AS rsi
    FROM relative_strength
)

SELECT symbol, date, rsi
FROM rsi_values
WHERE rsi IS NOT NULL
ORDER BY symbol, date DESC
        );
[0m15:19:07.613645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:09.246939 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.633 seconds
[0m15:19:09.253044 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: Close
[0m15:19:09.385586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef207b63-1aa4-4f36-90ed-7ce7910aa002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132605af0>]}
[0m15:19:09.387734 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.stock_rsi .......................... [[32mSUCCESS 1[0m in 1.82s]
[0m15:19:09.389237 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_rsi
[0m15:19:09.390122 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_moving_avg
[0m15:19:09.391023 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.stock_moving_avg ........................ [RUN]
[0m15:19:09.392817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.stock_rsi, now model.stock_calc.stock_moving_avg)
[0m15:19:09.393987 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_moving_avg
[0m15:19:09.400616 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_moving_avg"
[0m15:19:09.402031 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_moving_avg
[0m15:19:09.405997 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_moving_avg"
[0m15:19:09.407802 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_moving_avg"
[0m15:19:09.408496 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_moving_avg"} */
create or replace transient table lab2.analytics.stock_moving_avg
         as
        (SELECT
	symbol,
	date,
	AVG(close) OVER (
		PARTITION BY symbol
		ORDER BY date
		ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
	) AS moving_avg
FROM
	lab2.analytics.data_cleaned
        );
[0m15:19:09.409049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:11.111364 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.702 seconds
[0m15:19:11.117169 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: Close
[0m15:19:11.272435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef207b63-1aa4-4f36-90ed-7ce7910aa002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1324ea480>]}
[0m15:19:11.273904 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.stock_moving_avg ................... [[32mSUCCESS 1[0m in 1.88s]
[0m15:19:11.275341 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_moving_avg
[0m15:19:11.277911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:11.278656 [debug] [MainThread]: Connection 'model.stock_calc.stock_moving_avg' was properly closed.
[0m15:19:11.279420 [info ] [MainThread]: 
[0m15:19:11.280136 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 6.71 seconds (6.71s).
[0m15:19:11.282130 [debug] [MainThread]: Command end result
[0m15:19:11.319102 [info ] [MainThread]: 
[0m15:19:11.320097 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:19:11.321239 [info ] [MainThread]: 
[0m15:19:11.322832 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:19:11.327759 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.942571, "process_user_time": 5.581543, "process_kernel_time": 1.207393, "process_mem_max_rss": "179191808", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:19:11.328941 [debug] [MainThread]: Command `dbt run` succeeded at 15:19:11.328710 after 9.94 seconds
[0m15:19:11.329661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059cad20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132265790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1322b5e80>]}
[0m15:19:11.330246 [debug] [MainThread]: Flushing usage events
[0m15:19:44.951400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063021b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10633d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10633ce00>]}


============================== 15:19:44.958059 | c41c7e08-c286-43d1-937f-54f93eb2f261 ==============================
[0m15:19:44.958059 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:19:44.959216 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'static_parser': 'True', 'warn_error': 'None', 'version_check': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'partial_parse': 'True', 'quiet': 'False', 'empty': 'False', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'use_colors': 'True'}
[0m15:19:48.286453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c41c7e08-c286-43d1-937f-54f93eb2f261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132763830>]}
[0m15:19:48.374394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c41c7e08-c286-43d1-937f-54f93eb2f261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051baf00>]}
[0m15:19:48.376588 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:19:48.409635 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:19:48.648878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:19:48.649856 [debug] [MainThread]: Partial parsing: updated file: stock_calc://models/input/data_cleaned.sql
[0m15:19:49.007758 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:19:49.026934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c41c7e08-c286-43d1-937f-54f93eb2f261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106176960>]}
[0m15:19:49.158785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c41c7e08-c286-43d1-937f-54f93eb2f261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132924980>]}
[0m15:19:49.159582 [info ] [MainThread]: Found 3 models, 2 sources, 459 macros
[0m15:19:49.160222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c41c7e08-c286-43d1-937f-54f93eb2f261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ff8f0>]}
[0m15:19:49.163140 [info ] [MainThread]: 
[0m15:19:49.164169 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:19:49.170814 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m15:19:49.190085 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m15:19:49.190734 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m15:19:49.191195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:50.354227 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.163 seconds
[0m15:19:50.356880 [debug] [ThreadPool]: On list_lab2: Close
[0m15:19:50.492447 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m15:19:50.513695 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:19:50.514881 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:19:50.515699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:51.208061 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.692 seconds
[0m15:19:51.213290 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:19:51.356842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c41c7e08-c286-43d1-937f-54f93eb2f261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1328ad520>]}
[0m15:19:51.358600 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:19:51.359606 [info ] [MainThread]: 
[0m15:19:51.366303 [debug] [Thread-1 (]: Began running node model.stock_calc.data_cleaned
[0m15:19:51.367631 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.data_cleaned ............................. [RUN]
[0m15:19:51.368713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.stock_calc.data_cleaned)
[0m15:19:51.369538 [debug] [Thread-1 (]: Began compiling node model.stock_calc.data_cleaned
[0m15:19:51.382915 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.data_cleaned"
[0m15:19:51.384988 [debug] [Thread-1 (]: Began executing node model.stock_calc.data_cleaned
[0m15:19:51.433579 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.data_cleaned"
[0m15:19:51.435306 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.data_cleaned"
[0m15:19:51.435907 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.data_cleaned"} */
create or replace   view lab2.analytics.data_cleaned
  
   as (
    SELECT
	DINSTINCT date,
	close,
	symbol
FROM lab2.raw_data.stock_price
ORDER BY symbol, date DESC
  );
[0m15:19:51.436411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:52.113155 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b854d7-0004-26b9-0002-65f3000124da
[0m15:19:52.114205 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 1
invalid identifier 'DINSTINCT'
[0m15:19:52.115131 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: Close
[0m15:19:52.265947 [debug] [Thread-1 (]: Database Error in model data_cleaned (models/input/data_cleaned.sql)
  000904 (42000): SQL compilation error: error line 5 at position 1
  invalid identifier 'DINSTINCT'
  compiled code at target/run/stock_calc/models/input/data_cleaned.sql
[0m15:19:52.269657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c41c7e08-c286-43d1-937f-54f93eb2f261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1328ad1f0>]}
[0m15:19:52.271046 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model analytics.data_cleaned .................... [[31mERROR[0m in 0.90s]
[0m15:19:52.272609 [debug] [Thread-1 (]: Finished running node model.stock_calc.data_cleaned
[0m15:19:52.273546 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_rsi
[0m15:19:52.276160 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.stock_rsi ............................... [RUN]
[0m15:19:52.277720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.data_cleaned, now model.stock_calc.stock_rsi)
[0m15:19:52.278685 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_rsi
[0m15:19:52.282418 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_rsi"
[0m15:19:52.284041 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_rsi
[0m15:19:52.319077 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_rsi"
[0m15:19:52.322101 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_rsi"
[0m15:19:52.322826 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_rsi"} */
create or replace transient table lab2.analytics.stock_rsi
         as
        (WITH price_changes AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM analytics.data_cleaned
),
gains_losses AS (
    SELECT 
        symbol,
        date,
        close,
        previous_close,
        close - previous_close AS price_change,
        CASE 
            WHEN close - previous_close > 0 THEN close - previous_close 
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close - previous_close < 0 THEN ABS(close - previous_close) 
            ELSE 0 
        END AS loss
    FROM price_changes
    WHERE previous_close IS NOT NULL
),
average_gain_loss AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_losses
),
relative_strength AS (
    SELECT
        symbol,
        date,
        avg_gain,
        avg_loss,
        CASE 
            WHEN avg_loss = 0 THEN NULL
            ELSE avg_gain / avg_loss 
        END AS rs
    FROM average_gain_loss
),
rsi_values AS (
    SELECT
        symbol,
        date,
        CASE
            WHEN rs IS NULL THEN NULL
            ELSE 100 - (100 / (1 + rs))
        END AS rsi
    FROM relative_strength
)

SELECT symbol, date, rsi
FROM rsi_values
WHERE rsi IS NOT NULL
ORDER BY symbol, date DESC
        );
[0m15:19:52.323558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:53.893827 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.570 seconds
[0m15:19:53.935735 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: Close
[0m15:19:54.097647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c41c7e08-c286-43d1-937f-54f93eb2f261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132e67560>]}
[0m15:19:54.099450 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.stock_rsi .......................... [[32mSUCCESS 1[0m in 1.82s]
[0m15:19:54.101460 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_rsi
[0m15:19:54.103406 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_moving_avg
[0m15:19:54.104975 [info ] [Thread-1 (]: 3 of 3 SKIP relation analytics.stock_moving_avg ................................ [[33mSKIP[0m]
[0m15:19:54.106468 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_moving_avg
[0m15:19:54.109686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:54.110600 [debug] [MainThread]: Connection 'model.stock_calc.stock_rsi' was properly closed.
[0m15:19:54.111655 [info ] [MainThread]: 
[0m15:19:54.112769 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 4.95 seconds (4.95s).
[0m15:19:54.115504 [debug] [MainThread]: Command end result
[0m15:19:54.177243 [info ] [MainThread]: 
[0m15:19:54.178392 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:19:54.179260 [info ] [MainThread]: 
[0m15:19:54.180542 [error] [MainThread]:   Database Error in model data_cleaned (models/input/data_cleaned.sql)
  000904 (42000): SQL compilation error: error line 5 at position 1
  invalid identifier 'DINSTINCT'
  compiled code at target/run/stock_calc/models/input/data_cleaned.sql
[0m15:19:54.181678 [info ] [MainThread]: 
[0m15:19:54.182703 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m15:19:54.187524 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.353455, "process_user_time": 5.621109, "process_kernel_time": 1.313449, "process_mem_max_rss": "180776960", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:19:54.188771 [debug] [MainThread]: Command `dbt run` failed at 15:19:54.188484 after 9.35 seconds
[0m15:19:54.189845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096bcef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10633d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10633d070>]}
[0m15:19:54.190671 [debug] [MainThread]: Flushing usage events
[0m15:20:04.897178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c958860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec51250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec50f20>]}


============================== 15:20:04.902937 | 982ff6c9-bfa6-473d-afbe-0ac0a00e56a4 ==============================
[0m15:20:04.902937 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:20:04.903899 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'introspect': 'True', 'quiet': 'False', 'invocation_command': 'dbt run', 'debug': 'False', 'no_print': 'None', 'printer_width': '80', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'indirect_selection': 'eager', 'version_check': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'fail_fast': 'False', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'empty': 'False', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs'}
[0m15:20:06.415223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '982ff6c9-bfa6-473d-afbe-0ac0a00e56a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138330b0>]}
[0m15:20:06.499779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '982ff6c9-bfa6-473d-afbe-0ac0a00e56a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111feac30>]}
[0m15:20:06.501108 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:20:06.529380 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:20:06.717376 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:20:06.718344 [debug] [MainThread]: Partial parsing: updated file: stock_calc://models/input/data_cleaned.sql
[0m15:20:07.081878 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:20:07.099920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '982ff6c9-bfa6-473d-afbe-0ac0a00e56a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b477620>]}
[0m15:20:07.216025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '982ff6c9-bfa6-473d-afbe-0ac0a00e56a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b1b2720>]}
[0m15:20:07.216760 [info ] [MainThread]: Found 3 models, 2 sources, 459 macros
[0m15:20:07.217277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '982ff6c9-bfa6-473d-afbe-0ac0a00e56a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b234620>]}
[0m15:20:07.220082 [info ] [MainThread]: 
[0m15:20:07.221030 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:20:07.227625 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m15:20:07.246881 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m15:20:07.247515 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m15:20:07.247987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:08.043109 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.795 seconds
[0m15:20:08.048000 [debug] [ThreadPool]: On list_lab2: Close
[0m15:20:08.205368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m15:20:08.219891 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:20:08.220517 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:20:08.220982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:08.845444 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.624 seconds
[0m15:20:08.850802 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:20:09.017035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '982ff6c9-bfa6-473d-afbe-0ac0a00e56a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b473cb0>]}
[0m15:20:09.018721 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:20:09.020292 [info ] [MainThread]: 
[0m15:20:09.027335 [debug] [Thread-1 (]: Began running node model.stock_calc.data_cleaned
[0m15:20:09.028939 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.data_cleaned ............................. [RUN]
[0m15:20:09.030370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.stock_calc.data_cleaned)
[0m15:20:09.031203 [debug] [Thread-1 (]: Began compiling node model.stock_calc.data_cleaned
[0m15:20:09.045704 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.data_cleaned"
[0m15:20:09.047054 [debug] [Thread-1 (]: Began executing node model.stock_calc.data_cleaned
[0m15:20:09.092300 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.data_cleaned"
[0m15:20:09.094070 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.data_cleaned"
[0m15:20:09.094664 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.data_cleaned"} */
create or replace   view lab2.analytics.data_cleaned
  
   as (
    SELECT
	DISTINCT date,
	close,
	symbol
FROM lab2.raw_data.stock_price
ORDER BY symbol, date DESC
  );
[0m15:20:09.095175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:10.026086 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.931 seconds
[0m15:20:10.067961 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: Close
[0m15:20:10.224203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '982ff6c9-bfa6-473d-afbe-0ac0a00e56a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13afbc770>]}
[0m15:20:10.225745 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.data_cleaned ........................ [[32mSUCCESS 1[0m in 1.19s]
[0m15:20:10.227215 [debug] [Thread-1 (]: Finished running node model.stock_calc.data_cleaned
[0m15:20:10.228227 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_rsi
[0m15:20:10.229675 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.stock_rsi ............................... [RUN]
[0m15:20:10.230680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.data_cleaned, now model.stock_calc.stock_rsi)
[0m15:20:10.231382 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_rsi
[0m15:20:10.234453 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_rsi"
[0m15:20:10.236093 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_rsi
[0m15:20:10.271060 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_rsi"
[0m15:20:10.275286 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_rsi"
[0m15:20:10.276308 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_rsi"} */
create or replace transient table lab2.analytics.stock_rsi
         as
        (WITH price_changes AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM analytics.data_cleaned
),
gains_losses AS (
    SELECT 
        symbol,
        date,
        close,
        previous_close,
        close - previous_close AS price_change,
        CASE 
            WHEN close - previous_close > 0 THEN close - previous_close 
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close - previous_close < 0 THEN ABS(close - previous_close) 
            ELSE 0 
        END AS loss
    FROM price_changes
    WHERE previous_close IS NOT NULL
),
average_gain_loss AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_losses
),
relative_strength AS (
    SELECT
        symbol,
        date,
        avg_gain,
        avg_loss,
        CASE 
            WHEN avg_loss = 0 THEN NULL
            ELSE avg_gain / avg_loss 
        END AS rs
    FROM average_gain_loss
),
rsi_values AS (
    SELECT
        symbol,
        date,
        CASE
            WHEN rs IS NULL THEN NULL
            ELSE 100 - (100 / (1 + rs))
        END AS rsi
    FROM relative_strength
)

SELECT symbol, date, rsi
FROM rsi_values
WHERE rsi IS NOT NULL
ORDER BY symbol, date DESC
        );
[0m15:20:10.277133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:11.918667 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.641 seconds
[0m15:20:11.924666 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: Close
[0m15:20:12.078809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '982ff6c9-bfa6-473d-afbe-0ac0a00e56a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b715460>]}
[0m15:20:12.079820 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.stock_rsi .......................... [[32mSUCCESS 1[0m in 1.85s]
[0m15:20:12.080855 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_rsi
[0m15:20:12.081498 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_moving_avg
[0m15:20:12.082290 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.stock_moving_avg ........................ [RUN]
[0m15:20:12.083206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.stock_rsi, now model.stock_calc.stock_moving_avg)
[0m15:20:12.084090 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_moving_avg
[0m15:20:12.089727 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_moving_avg"
[0m15:20:12.090969 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_moving_avg
[0m15:20:12.094516 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_moving_avg"
[0m15:20:12.097105 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_moving_avg"
[0m15:20:12.097856 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_moving_avg"} */
create or replace transient table lab2.analytics.stock_moving_avg
         as
        (SELECT
	symbol,
	date,
	AVG(close) OVER (
		PARTITION BY symbol
		ORDER BY date
		ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
	) AS moving_avg
FROM
	lab2.analytics.data_cleaned
        );
[0m15:20:12.098394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:13.539204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.441 seconds
[0m15:20:13.545398 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: Close
[0m15:20:13.691254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '982ff6c9-bfa6-473d-afbe-0ac0a00e56a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b473cb0>]}
[0m15:20:13.693537 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.stock_moving_avg ................... [[32mSUCCESS 1[0m in 1.61s]
[0m15:20:13.695382 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_moving_avg
[0m15:20:13.698126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:13.698886 [debug] [MainThread]: Connection 'model.stock_calc.stock_moving_avg' was properly closed.
[0m15:20:13.699718 [info ] [MainThread]: 
[0m15:20:13.701216 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 6.48 seconds (6.48s).
[0m15:20:13.704106 [debug] [MainThread]: Command end result
[0m15:20:13.745058 [info ] [MainThread]: 
[0m15:20:13.745970 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:20:13.746546 [info ] [MainThread]: 
[0m15:20:13.747142 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:20:13.753441 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.955113, "process_user_time": 5.33932, "process_kernel_time": 1.000833, "process_mem_max_rss": "179064832", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:20:13.754670 [debug] [MainThread]: Command `dbt run` succeeded at 15:20:13.754448 after 8.96 seconds
[0m15:20:13.755490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5fb020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec511c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec50f20>]}
[0m15:20:13.756310 [debug] [MainThread]: Flushing usage events
[0m15:21:18.627633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8a87a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf3d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf3cce0>]}


============================== 15:21:18.644303 | 17f62959-6539-417e-9bd6-84c587013c20 ==============================
[0m15:21:18.644303 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:21:18.645409 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'indirect_selection': 'eager', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'warn_error': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'static_parser': 'True', 'introspect': 'True', 'use_colors': 'True', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'fail_fast': 'False'}
[0m15:21:21.614548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17f62959-6539-417e-9bd6-84c587013c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9e4980>]}
[0m15:21:21.699890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17f62959-6539-417e-9bd6-84c587013c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fa11c0>]}
[0m15:21:21.702189 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:21:21.733447 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:21:21.979805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:21:21.980555 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:21:21.988967 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:21:22.029164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17f62959-6539-417e-9bd6-84c587013c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138363c80>]}
[0m15:21:22.169634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17f62959-6539-417e-9bd6-84c587013c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1386b05f0>]}
[0m15:21:22.170533 [info ] [MainThread]: Found 3 models, 2 sources, 459 macros
[0m15:21:22.171056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17f62959-6539-417e-9bd6-84c587013c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f303290>]}
[0m15:21:22.173866 [info ] [MainThread]: 
[0m15:21:22.174798 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:21:22.181643 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m15:21:22.202673 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m15:21:22.203402 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m15:21:22.203912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:22.982614 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.778 seconds
[0m15:21:22.986375 [debug] [ThreadPool]: On list_lab2: Close
[0m15:21:23.142692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m15:21:23.160308 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:21:23.160999 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:21:23.161499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:23.992812 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.831 seconds
[0m15:21:23.996562 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:21:24.153555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17f62959-6539-417e-9bd6-84c587013c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a84cb30>]}
[0m15:21:24.155192 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:21:24.156130 [info ] [MainThread]: 
[0m15:21:24.162647 [debug] [Thread-1 (]: Began running node model.stock_calc.data_cleaned
[0m15:21:24.164318 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.data_cleaned ............................. [RUN]
[0m15:21:24.165508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.stock_calc.data_cleaned)
[0m15:21:24.166479 [debug] [Thread-1 (]: Began compiling node model.stock_calc.data_cleaned
[0m15:21:24.179196 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.data_cleaned"
[0m15:21:24.180401 [debug] [Thread-1 (]: Began executing node model.stock_calc.data_cleaned
[0m15:21:24.225292 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.data_cleaned"
[0m15:21:24.227127 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.data_cleaned"
[0m15:21:24.227750 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.data_cleaned"} */
create or replace   view lab2.analytics.data_cleaned
  
   as (
    SELECT
	DISTINCT date,
	close,
	symbol
FROM lab2.raw_data.stock_price
ORDER BY symbol, date DESC
  );
[0m15:21:24.228357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:25.110699 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.882 seconds
[0m15:21:25.152211 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: Close
[0m15:21:25.298126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17f62959-6539-417e-9bd6-84c587013c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4e93a0>]}
[0m15:21:25.299806 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.data_cleaned ........................ [[32mSUCCESS 1[0m in 1.13s]
[0m15:21:25.302885 [debug] [Thread-1 (]: Finished running node model.stock_calc.data_cleaned
[0m15:21:25.305012 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_rsi
[0m15:21:25.307450 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.stock_rsi ............................... [RUN]
[0m15:21:25.309243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.data_cleaned, now model.stock_calc.stock_rsi)
[0m15:21:25.310441 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_rsi
[0m15:21:25.315445 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_rsi"
[0m15:21:25.317740 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_rsi
[0m15:21:25.352782 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_rsi"
[0m15:21:25.356217 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_rsi"
[0m15:21:25.356988 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_rsi"} */
create or replace transient table lab2.analytics.stock_rsi
         as
        (WITH price_changes AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM analytics.data_cleaned
),
gains_losses AS (
    SELECT 
        symbol,
        date,
        close,
        previous_close,
        close - previous_close AS price_change,
        CASE 
            WHEN close - previous_close > 0 THEN close - previous_close 
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close - previous_close < 0 THEN ABS(close - previous_close) 
            ELSE 0 
        END AS loss
    FROM price_changes
    WHERE previous_close IS NOT NULL
),
average_gain_loss AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_losses
),
relative_strength AS (
    SELECT
        symbol,
        date,
        avg_gain,
        avg_loss,
        CASE 
            WHEN avg_loss = 0 THEN NULL
            ELSE avg_gain / avg_loss 
        END AS rs
    FROM average_gain_loss
),
rsi_values AS (
    SELECT
        symbol,
        date,
        CASE
            WHEN rs IS NULL THEN NULL
            ELSE 100 - (100 / (1 + rs))
        END AS rsi
    FROM relative_strength
)

SELECT symbol, date, rsi
FROM rsi_values
WHERE rsi IS NOT NULL
ORDER BY symbol, date DESC
        );
[0m15:21:25.357609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:27.061174 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.704 seconds
[0m15:21:27.066217 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: Close
[0m15:21:27.207463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17f62959-6539-417e-9bd6-84c587013c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a84c7a0>]}
[0m15:21:27.209128 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.stock_rsi .......................... [[32mSUCCESS 1[0m in 1.90s]
[0m15:21:27.210790 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_rsi
[0m15:21:27.212111 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_moving_avg
[0m15:21:27.213361 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.stock_moving_avg ........................ [RUN]
[0m15:21:27.214188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.stock_rsi, now model.stock_calc.stock_moving_avg)
[0m15:21:27.214785 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_moving_avg
[0m15:21:27.218961 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_moving_avg"
[0m15:21:27.220851 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_moving_avg
[0m15:21:27.227430 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_moving_avg"
[0m15:21:27.229461 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_moving_avg"
[0m15:21:27.230193 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_moving_avg"} */
create or replace transient table lab2.analytics.stock_moving_avg
         as
        (SELECT
	symbol,
	date,
	AVG(close) OVER (
		PARTITION BY symbol
		ORDER BY date
		ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
	) AS moving_avg
FROM
	lab2.analytics.data_cleaned
        );
[0m15:21:27.231259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:28.850747 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.619 seconds
[0m15:21:28.856996 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: Close
[0m15:21:29.029148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17f62959-6539-417e-9bd6-84c587013c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1387e4d70>]}
[0m15:21:29.031010 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.stock_moving_avg ................... [[32mSUCCESS 1[0m in 1.81s]
[0m15:21:29.033127 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_moving_avg
[0m15:21:29.036143 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:29.036949 [debug] [MainThread]: Connection 'model.stock_calc.stock_moving_avg' was properly closed.
[0m15:21:29.037790 [info ] [MainThread]: 
[0m15:21:29.038608 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 6.86 seconds (6.86s).
[0m15:21:29.040930 [debug] [MainThread]: Command end result
[0m15:21:29.083585 [info ] [MainThread]: 
[0m15:21:29.084330 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:21:29.084870 [info ] [MainThread]: 
[0m15:21:29.085412 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:21:29.091136 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.577286, "process_user_time": 5.298905, "process_kernel_time": 1.344586, "process_mem_max_rss": "175890432", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:21:29.092344 [debug] [MainThread]: Command `dbt run` succeeded at 15:21:29.092126 after 10.58 seconds
[0m15:21:29.092945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf3d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbf88c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1386a74d0>]}
[0m15:21:29.093465 [debug] [MainThread]: Flushing usage events
[0m15:22:08.782767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109019c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ea9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ea8e30>]}


============================== 15:22:08.803879 | f554a2a3-3262-44f1-b693-87918e8e75d1 ==============================
[0m15:22:08.803879 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:22:08.805013 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'write_json': 'True', 'partial_parse': 'True', 'printer_width': '80', 'no_print': 'None', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'indirect_selection': 'eager', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'debug': 'False', 'version_check': 'True', 'warn_error': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'quiet': 'False', 'static_parser': 'True', 'target_path': 'None'}
[0m15:22:12.185995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f554a2a3-3262-44f1-b693-87918e8e75d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136070770>]}
[0m15:22:12.271618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f554a2a3-3262-44f1-b693-87918e8e75d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eba930>]}
[0m15:22:12.274056 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:22:12.306893 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:22:12.575190 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:12.575851 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:12.584283 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:22:12.625124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f554a2a3-3262-44f1-b693-87918e8e75d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eab2c0>]}
[0m15:22:12.762652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f554a2a3-3262-44f1-b693-87918e8e75d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136550590>]}
[0m15:22:12.763501 [info ] [MainThread]: Found 3 models, 2 sources, 459 macros
[0m15:22:12.764065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f554a2a3-3262-44f1-b693-87918e8e75d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e6cb00>]}
[0m15:22:12.767218 [info ] [MainThread]: 
[0m15:22:12.768253 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:22:12.776664 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m15:22:12.799565 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m15:22:12.800200 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m15:22:12.800709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:13.500964 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.699 seconds
[0m15:22:13.503552 [debug] [ThreadPool]: On list_lab2: Close
[0m15:22:13.702081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m15:22:13.720368 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:22:13.721055 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:22:13.721545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:14.394646 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.673 seconds
[0m15:22:14.399923 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:22:14.585515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f554a2a3-3262-44f1-b693-87918e8e75d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13620cc20>]}
[0m15:22:14.587106 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:22:14.587886 [info ] [MainThread]: 
[0m15:22:14.596028 [debug] [Thread-1 (]: Began running node model.stock_calc.data_cleaned
[0m15:22:14.597388 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.data_cleaned ............................. [RUN]
[0m15:22:14.598606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.stock_calc.data_cleaned)
[0m15:22:14.599506 [debug] [Thread-1 (]: Began compiling node model.stock_calc.data_cleaned
[0m15:22:14.613274 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.data_cleaned"
[0m15:22:14.614610 [debug] [Thread-1 (]: Began executing node model.stock_calc.data_cleaned
[0m15:22:14.664193 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.data_cleaned"
[0m15:22:14.666017 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.data_cleaned"
[0m15:22:14.666841 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.data_cleaned"} */
create or replace   view lab2.analytics.data_cleaned
  
   as (
    SELECT
	DISTINCT date,
	close,
	symbol
FROM lab2.raw_data.stock_price
ORDER BY symbol, date DESC
  );
[0m15:22:14.667784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:15.646331 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.978 seconds
[0m15:22:15.687488 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: Close
[0m15:22:15.845572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f554a2a3-3262-44f1-b693-87918e8e75d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109451700>]}
[0m15:22:15.847454 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.data_cleaned ........................ [[32mSUCCESS 1[0m in 1.24s]
[0m15:22:15.850332 [debug] [Thread-1 (]: Finished running node model.stock_calc.data_cleaned
[0m15:22:15.852078 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_rsi
[0m15:22:15.853712 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.stock_rsi ............................... [RUN]
[0m15:22:15.855040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.data_cleaned, now model.stock_calc.stock_rsi)
[0m15:22:15.855945 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_rsi
[0m15:22:15.860074 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_rsi"
[0m15:22:15.861675 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_rsi
[0m15:22:15.895680 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_rsi"
[0m15:22:15.898828 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_rsi"
[0m15:22:15.899493 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_rsi"} */
create or replace transient table lab2.analytics.stock_rsi
         as
        (WITH price_changes AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM analytics.data_cleaned
),
gains_losses AS (
    SELECT 
        symbol,
        date,
        close,
        previous_close,
        close - previous_close AS price_change,
        CASE 
            WHEN close - previous_close > 0 THEN close - previous_close 
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close - previous_close < 0 THEN ABS(close - previous_close) 
            ELSE 0 
        END AS loss
    FROM price_changes
    WHERE previous_close IS NOT NULL
),
average_gain_loss AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_losses
),
relative_strength AS (
    SELECT
        symbol,
        date,
        avg_gain,
        avg_loss,
        CASE 
            WHEN avg_loss = 0 THEN NULL
            ELSE avg_gain / avg_loss 
        END AS rs
    FROM average_gain_loss
),
rsi_values AS (
    SELECT
        symbol,
        date,
        CASE
            WHEN rs IS NULL THEN NULL
            ELSE 100 - (100 / (1 + rs))
        END AS rsi
    FROM relative_strength
)

SELECT symbol, date, rsi
FROM rsi_values
WHERE rsi IS NOT NULL
ORDER BY symbol, date DESC
        );
[0m15:22:15.900053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:17.764602 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.864 seconds
[0m15:22:17.773351 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: Close
[0m15:22:17.933275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f554a2a3-3262-44f1-b693-87918e8e75d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136529280>]}
[0m15:22:17.935150 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.stock_rsi .......................... [[32mSUCCESS 1[0m in 2.08s]
[0m15:22:17.937014 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_rsi
[0m15:22:17.938094 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_moving_avg
[0m15:22:17.939416 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.stock_moving_avg ........................ [RUN]
[0m15:22:17.940551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.stock_rsi, now model.stock_calc.stock_moving_avg)
[0m15:22:17.941369 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_moving_avg
[0m15:22:17.946717 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_moving_avg"
[0m15:22:17.948261 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_moving_avg
[0m15:22:17.952272 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_moving_avg"
[0m15:22:17.954053 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_moving_avg"
[0m15:22:17.954714 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_moving_avg"} */
create or replace transient table lab2.analytics.stock_moving_avg
         as
        (SELECT
	symbol,
	date,
	AVG(close) OVER (
		PARTITION BY symbol
		ORDER BY date
		ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
	) AS moving_avg
FROM
	lab2.analytics.data_cleaned
        );
[0m15:22:17.955289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:19.272787 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.317 seconds
[0m15:22:19.277945 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: Close
[0m15:22:19.407584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f554a2a3-3262-44f1-b693-87918e8e75d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1367ca6f0>]}
[0m15:22:19.408906 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.stock_moving_avg ................... [[32mSUCCESS 1[0m in 1.47s]
[0m15:22:19.410197 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_moving_avg
[0m15:22:19.412662 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:19.413471 [debug] [MainThread]: Connection 'model.stock_calc.stock_moving_avg' was properly closed.
[0m15:22:19.414175 [info ] [MainThread]: 
[0m15:22:19.414713 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 6.65 seconds (6.65s).
[0m15:22:19.416344 [debug] [MainThread]: Command end result
[0m15:22:19.462813 [info ] [MainThread]: 
[0m15:22:19.463630 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:19.464144 [info ] [MainThread]: 
[0m15:22:19.464703 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:22:19.470022 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.819225, "process_user_time": 5.391693, "process_kernel_time": 1.389227, "process_mem_max_rss": "176152576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:22:19.471054 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:19.470870 after 10.82 seconds
[0m15:22:19.471685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d78200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109903530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1363371d0>]}
[0m15:22:19.472237 [debug] [MainThread]: Flushing usage events
[0m15:23:11.948848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a88fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a88c80>]}


============================== 15:23:11.955225 | f6053600-9846-4676-a08b-84f3640bc4d8 ==============================
[0m15:23:11.955225 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:23:11.956276 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'introspect': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'empty': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'no_print': 'None', 'quiet': 'False'}
[0m15:23:15.007158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6053600-9846-4676-a08b-84f3640bc4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054c6a20>]}
[0m15:23:15.094419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6053600-9846-4676-a08b-84f3640bc4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131cb2600>]}
[0m15:23:15.096761 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:23:15.129138 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:23:15.376527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:23:15.377165 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:23:15.384893 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:23:15.425766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6053600-9846-4676-a08b-84f3640bc4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131da6ed0>]}
[0m15:23:15.564338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6053600-9846-4676-a08b-84f3640bc4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13215bfb0>]}
[0m15:23:15.565139 [info ] [MainThread]: Found 3 models, 2 sources, 459 macros
[0m15:23:15.565658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6053600-9846-4676-a08b-84f3640bc4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131f42f60>]}
[0m15:23:15.568428 [info ] [MainThread]: 
[0m15:23:15.569310 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:23:15.576076 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m15:23:15.597234 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m15:23:15.597858 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m15:23:15.598317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:16.308742 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.710 seconds
[0m15:23:16.313519 [debug] [ThreadPool]: On list_lab2: Close
[0m15:23:16.450847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m15:23:16.468386 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:23:16.469087 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:23:16.469600 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:17.156701 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.687 seconds
[0m15:23:17.159991 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:23:17.351146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6053600-9846-4676-a08b-84f3640bc4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043791f0>]}
[0m15:23:17.352827 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:17.353860 [info ] [MainThread]: 
[0m15:23:17.360218 [debug] [Thread-1 (]: Began running node model.stock_calc.data_cleaned
[0m15:23:17.361499 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.data_cleaned ............................. [RUN]
[0m15:23:17.362785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.stock_calc.data_cleaned)
[0m15:23:17.363628 [debug] [Thread-1 (]: Began compiling node model.stock_calc.data_cleaned
[0m15:23:17.377588 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.data_cleaned"
[0m15:23:17.379497 [debug] [Thread-1 (]: Began executing node model.stock_calc.data_cleaned
[0m15:23:17.430036 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.data_cleaned"
[0m15:23:17.431728 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.data_cleaned"
[0m15:23:17.432388 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.data_cleaned"} */
create or replace   view lab2.analytics.data_cleaned
  
   as (
    SELECT
	DISTINCT date,
	close,
	symbol
FROM lab2.raw_data.stock_price
ORDER BY symbol, date DESC
  );
[0m15:23:17.432926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:18.252205 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.819 seconds
[0m15:23:18.286669 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: Close
[0m15:23:18.494785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6053600-9846-4676-a08b-84f3640bc4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131de8650>]}
[0m15:23:18.496687 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.data_cleaned ........................ [[32mSUCCESS 1[0m in 1.13s]
[0m15:23:18.498491 [debug] [Thread-1 (]: Finished running node model.stock_calc.data_cleaned
[0m15:23:18.499581 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_rsi
[0m15:23:18.500919 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.stock_rsi ............................... [RUN]
[0m15:23:18.502350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.data_cleaned, now model.stock_calc.stock_rsi)
[0m15:23:18.503350 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_rsi
[0m15:23:18.506770 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_rsi"
[0m15:23:18.508462 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_rsi
[0m15:23:18.547106 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_rsi"
[0m15:23:18.550214 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_rsi"
[0m15:23:18.551124 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_rsi"} */
create or replace transient table lab2.analytics.stock_rsi
         as
        (WITH price_changes AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM analytics.data_cleaned
),
gains_losses AS (
    SELECT 
        symbol,
        date,
        close,
        previous_close,
        close - previous_close AS price_change,
        CASE 
            WHEN close - previous_close > 0 THEN close - previous_close 
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close - previous_close < 0 THEN ABS(close - previous_close) 
            ELSE 0 
        END AS loss
    FROM price_changes
    WHERE previous_close IS NOT NULL
),
average_gain_loss AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_losses
),
relative_strength AS (
    SELECT
        symbol,
        date,
        avg_gain,
        avg_loss,
        CASE 
            WHEN avg_loss = 0 THEN NULL
            ELSE avg_gain / avg_loss 
        END AS rs
    FROM average_gain_loss
),
rsi_values AS (
    SELECT
        symbol,
        date,
        CASE
            WHEN rs IS NULL THEN NULL
            ELSE 100 - (100 / (1 + rs))
        END AS rsi
    FROM relative_strength
)

SELECT symbol, date, rsi
FROM rsi_values
WHERE rsi IS NOT NULL
ORDER BY symbol, date DESC
        );
[0m15:23:18.552169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:19.963265 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.411 seconds
[0m15:23:19.969742 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: Close
[0m15:23:20.138206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6053600-9846-4676-a08b-84f3640bc4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1323a9f10>]}
[0m15:23:20.139746 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.stock_rsi .......................... [[32mSUCCESS 1[0m in 1.64s]
[0m15:23:20.141153 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_rsi
[0m15:23:20.142128 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_moving_avg
[0m15:23:20.143811 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.stock_moving_avg ........................ [RUN]
[0m15:23:20.144874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.stock_rsi, now model.stock_calc.stock_moving_avg)
[0m15:23:20.145628 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_moving_avg
[0m15:23:20.150028 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_moving_avg"
[0m15:23:20.151501 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_moving_avg
[0m15:23:20.155163 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_moving_avg"
[0m15:23:20.156674 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_moving_avg"
[0m15:23:20.157227 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_moving_avg"} */
create or replace transient table lab2.analytics.stock_moving_avg
         as
        (SELECT
	symbol,
	date,
	AVG(close) OVER (
		PARTITION BY symbol
		ORDER BY date
		ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
	) AS moving_avg
FROM
	lab2.analytics.data_cleaned
        );
[0m15:23:20.157718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:21.496434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.338 seconds
[0m15:23:21.502676 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: Close
[0m15:23:21.663509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6053600-9846-4676-a08b-84f3640bc4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1323c57f0>]}
[0m15:23:21.665367 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.stock_moving_avg ................... [[32mSUCCESS 1[0m in 1.52s]
[0m15:23:21.667513 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_moving_avg
[0m15:23:21.670325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:21.671098 [debug] [MainThread]: Connection 'model.stock_calc.stock_moving_avg' was properly closed.
[0m15:23:21.671955 [info ] [MainThread]: 
[0m15:23:21.672781 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 6.10 seconds (6.10s).
[0m15:23:21.674831 [debug] [MainThread]: Command end result
[0m15:23:21.716080 [info ] [MainThread]: 
[0m15:23:21.717054 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:23:21.717730 [info ] [MainThread]: 
[0m15:23:21.718317 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:23:21.726114 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.882338, "process_user_time": 5.418645, "process_kernel_time": 1.325742, "process_mem_max_rss": "176058368", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:23:21.727492 [debug] [MainThread]: Command `dbt run` succeeded at 15:23:21.727236 after 9.88 seconds
[0m15:23:21.728313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105015430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a88d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a88ef0>]}
[0m15:23:21.728926 [debug] [MainThread]: Flushing usage events
[0m15:23:46.396284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105249250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105299100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105298da0>]}


============================== 15:23:46.402206 | de2d1bb9-90b0-4fa8-8098-b35b236b6b26 ==============================
[0m15:23:46.402206 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:23:46.403430 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'target_path': 'None', 'use_colors': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'cache_selected_only': 'False', 'version_check': 'True', 'no_print': 'None', 'debug': 'False', 'partial_parse': 'True', 'quiet': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'empty': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True'}
[0m15:23:48.670722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de2d1bb9-90b0-4fa8-8098-b35b236b6b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b31310>]}
[0m15:23:48.762482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de2d1bb9-90b0-4fa8-8098-b35b236b6b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf7e60>]}
[0m15:23:48.764320 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:23:48.794685 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:23:49.035858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:23:49.036512 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:23:49.045331 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:23:49.089980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de2d1bb9-90b0-4fa8-8098-b35b236b6b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13175ff80>]}
[0m15:23:49.233188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de2d1bb9-90b0-4fa8-8098-b35b236b6b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1319801d0>]}
[0m15:23:49.234355 [info ] [MainThread]: Found 3 models, 2 sources, 459 macros
[0m15:23:49.234959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de2d1bb9-90b0-4fa8-8098-b35b236b6b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131729fa0>]}
[0m15:23:49.237758 [info ] [MainThread]: 
[0m15:23:49.238667 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:23:49.245681 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m15:23:49.269028 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m15:23:49.269660 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m15:23:49.270132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:49.939017 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.669 seconds
[0m15:23:49.942243 [debug] [ThreadPool]: On list_lab2: Close
[0m15:23:50.104236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m15:23:50.119106 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:23:50.119982 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:23:50.120563 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:50.945101 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.824 seconds
[0m15:23:50.950224 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:23:51.077358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de2d1bb9-90b0-4fa8-8098-b35b236b6b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13195b050>]}
[0m15:23:51.078669 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:51.079801 [info ] [MainThread]: 
[0m15:23:51.086216 [debug] [Thread-1 (]: Began running node model.stock_calc.data_cleaned
[0m15:23:51.087768 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.data_cleaned ............................. [RUN]
[0m15:23:51.090006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.stock_calc.data_cleaned)
[0m15:23:51.092010 [debug] [Thread-1 (]: Began compiling node model.stock_calc.data_cleaned
[0m15:23:51.111244 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.data_cleaned"
[0m15:23:51.113238 [debug] [Thread-1 (]: Began executing node model.stock_calc.data_cleaned
[0m15:23:51.174342 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.data_cleaned"
[0m15:23:51.176011 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.data_cleaned"
[0m15:23:51.176730 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.data_cleaned"} */
create or replace   view lab2.analytics.data_cleaned
  
   as (
    SELECT
	DISTINCT date,
	close,
	symbol
FROM lab2.raw_data.stock_price
ORDER BY symbol, date DESC
  );
[0m15:23:51.177293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:51.979683 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.802 seconds
[0m15:23:52.022636 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: Close
[0m15:23:52.168462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de2d1bb9-90b0-4fa8-8098-b35b236b6b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104835610>]}
[0m15:23:52.169676 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.data_cleaned ........................ [[32mSUCCESS 1[0m in 1.08s]
[0m15:23:52.170762 [debug] [Thread-1 (]: Finished running node model.stock_calc.data_cleaned
[0m15:23:52.171468 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_rsi
[0m15:23:52.172191 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.stock_rsi ............................... [RUN]
[0m15:23:52.173262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.data_cleaned, now model.stock_calc.stock_rsi)
[0m15:23:52.173926 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_rsi
[0m15:23:52.176664 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_rsi"
[0m15:23:52.177862 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_rsi
[0m15:23:52.215891 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_rsi"
[0m15:23:52.219507 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_rsi"
[0m15:23:52.220263 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_rsi"} */
create or replace transient table lab2.analytics.stock_rsi
         as
        (WITH price_changes AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM analytics.data_cleaned
),
gains_losses AS (
    SELECT 
        symbol,
        date,
        close,
        previous_close,
        close - previous_close AS price_change,
        CASE 
            WHEN close - previous_close > 0 THEN close - previous_close 
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close - previous_close < 0 THEN ABS(close - previous_close) 
            ELSE 0 
        END AS loss
    FROM price_changes
    WHERE previous_close IS NOT NULL
),
average_gain_loss AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_losses
),
relative_strength AS (
    SELECT
        symbol,
        date,
        avg_gain,
        avg_loss,
        CASE 
            WHEN avg_loss = 0 THEN NULL
            ELSE avg_gain / avg_loss 
        END AS rs
    FROM average_gain_loss
),
rsi_values AS (
    SELECT
        symbol,
        date,
        CASE
            WHEN rs IS NULL THEN NULL
            ELSE 100 - (100 / (1 + rs))
        END AS rsi
    FROM relative_strength
)

SELECT symbol, date, rsi
FROM rsi_values
WHERE rsi IS NOT NULL
ORDER BY symbol, date DESC
        );
[0m15:23:52.220869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:53.959988 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.739 seconds
[0m15:23:53.966092 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: Close
[0m15:23:54.109557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de2d1bb9-90b0-4fa8-8098-b35b236b6b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131b034a0>]}
[0m15:23:54.111411 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.stock_rsi .......................... [[32mSUCCESS 1[0m in 1.94s]
[0m15:23:54.113139 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_rsi
[0m15:23:54.114468 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_moving_avg
[0m15:23:54.115754 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.stock_moving_avg ........................ [RUN]
[0m15:23:54.116889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.stock_rsi, now model.stock_calc.stock_moving_avg)
[0m15:23:54.117720 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_moving_avg
[0m15:23:54.123025 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_moving_avg"
[0m15:23:54.124545 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_moving_avg
[0m15:23:54.128724 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_moving_avg"
[0m15:23:54.130416 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_moving_avg"
[0m15:23:54.131039 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_moving_avg"} */
create or replace transient table lab2.analytics.stock_moving_avg
         as
        (SELECT
	symbol,
	date,
	AVG(close) OVER (
		PARTITION BY symbol
		ORDER BY date
		ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
	) AS moving_avg
FROM
	lab2.analytics.data_cleaned
        );
[0m15:23:54.131599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:55.494098 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.362 seconds
[0m15:23:55.498244 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: Close
[0m15:23:55.624222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de2d1bb9-90b0-4fa8-8098-b35b236b6b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131c067e0>]}
[0m15:23:55.626025 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.stock_moving_avg ................... [[32mSUCCESS 1[0m in 1.51s]
[0m15:23:55.627765 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_moving_avg
[0m15:23:55.631084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:55.631875 [debug] [MainThread]: Connection 'model.stock_calc.stock_moving_avg' was properly closed.
[0m15:23:55.632699 [info ] [MainThread]: 
[0m15:23:55.633498 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 6.39 seconds (6.39s).
[0m15:23:55.635686 [debug] [MainThread]: Command end result
[0m15:23:55.673231 [info ] [MainThread]: 
[0m15:23:55.673986 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:23:55.674600 [info ] [MainThread]: 
[0m15:23:55.675119 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:23:55.679164 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.3904505, "process_user_time": 5.412044, "process_kernel_time": 1.21245, "process_mem_max_rss": "175529984", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:23:55.680440 [debug] [MainThread]: Command `dbt run` succeeded at 15:23:55.680230 after 9.39 seconds
[0m15:23:55.681149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1312f62d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1316be1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ce1af0>]}
[0m15:23:55.681888 [debug] [MainThread]: Flushing usage events
[0m15:25:18.882472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f668a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106341220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106340ec0>]}


============================== 15:25:18.888723 | db388ff6-6dcb-49ef-be3a-42f3e8aeff7e ==============================
[0m15:25:18.888723 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:25:18.889708 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'no_print': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'version_check': 'True', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'quiet': 'False', 'static_parser': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'empty': 'False', 'debug': 'False'}
[0m15:25:21.786550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db388ff6-6dcb-49ef-be3a-42f3e8aeff7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1326bd0d0>]}
[0m15:25:21.870950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db388ff6-6dcb-49ef-be3a-42f3e8aeff7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105250260>]}
[0m15:25:21.873608 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:25:21.905051 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:25:22.149739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:25:22.150871 [debug] [MainThread]: Partial parsing: updated file: stock_calc://models/sources.yml
[0m15:25:22.407985 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:25:22.424523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db388ff6-6dcb-49ef-be3a-42f3e8aeff7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132a1f170>]}
[0m15:25:22.559737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db388ff6-6dcb-49ef-be3a-42f3e8aeff7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132ac8a70>]}
[0m15:25:22.560479 [info ] [MainThread]: Found 3 models, 3 sources, 459 macros
[0m15:25:22.561007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db388ff6-6dcb-49ef-be3a-42f3e8aeff7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106328740>]}
[0m15:25:22.563759 [info ] [MainThread]: 
[0m15:25:22.564709 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:25:22.570962 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m15:25:22.590762 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m15:25:22.591386 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m15:25:22.591869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:23.272645 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.680 seconds
[0m15:25:23.277704 [debug] [ThreadPool]: On list_lab2: Close
[0m15:25:23.450468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m15:25:23.469626 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:25:23.470247 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:25:23.470694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:24.134794 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.664 seconds
[0m15:25:24.140906 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:25:24.329925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db388ff6-6dcb-49ef-be3a-42f3e8aeff7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1326bc980>]}
[0m15:25:24.331560 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:25:24.332615 [info ] [MainThread]: 
[0m15:25:24.338288 [debug] [Thread-1 (]: Began running node model.stock_calc.data_cleaned
[0m15:25:24.339726 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.data_cleaned ............................. [RUN]
[0m15:25:24.340848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.stock_calc.data_cleaned)
[0m15:25:24.341547 [debug] [Thread-1 (]: Began compiling node model.stock_calc.data_cleaned
[0m15:25:24.354567 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.data_cleaned"
[0m15:25:24.355830 [debug] [Thread-1 (]: Began executing node model.stock_calc.data_cleaned
[0m15:25:24.415981 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.data_cleaned"
[0m15:25:24.418571 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.data_cleaned"
[0m15:25:24.419503 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.data_cleaned"} */
create or replace   view lab2.analytics.data_cleaned
  
   as (
    SELECT
	DISTINCT date,
	close,
	symbol
FROM lab2.raw_data.stock_price
ORDER BY symbol, date DESC
  );
[0m15:25:24.420504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:25.200605 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.780 seconds
[0m15:25:25.243496 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: Close
[0m15:25:25.379817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db388ff6-6dcb-49ef-be3a-42f3e8aeff7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13268c830>]}
[0m15:25:25.381347 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.data_cleaned ........................ [[32mSUCCESS 1[0m in 1.04s]
[0m15:25:25.382784 [debug] [Thread-1 (]: Finished running node model.stock_calc.data_cleaned
[0m15:25:25.384248 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_rsi
[0m15:25:25.385905 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.stock_rsi ............................... [RUN]
[0m15:25:25.387107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.data_cleaned, now model.stock_calc.stock_rsi)
[0m15:25:25.387949 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_rsi
[0m15:25:25.391129 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_rsi"
[0m15:25:25.392571 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_rsi
[0m15:25:25.427585 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_rsi"
[0m15:25:25.430539 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_rsi"
[0m15:25:25.431163 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_rsi"} */
create or replace transient table lab2.analytics.stock_rsi
         as
        (WITH price_changes AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM analytics.data_cleaned
),
gains_losses AS (
    SELECT 
        symbol,
        date,
        close,
        previous_close,
        close - previous_close AS price_change,
        CASE 
            WHEN close - previous_close > 0 THEN close - previous_close 
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close - previous_close < 0 THEN ABS(close - previous_close) 
            ELSE 0 
        END AS loss
    FROM price_changes
    WHERE previous_close IS NOT NULL
),
average_gain_loss AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_losses
),
relative_strength AS (
    SELECT
        symbol,
        date,
        avg_gain,
        avg_loss,
        CASE 
            WHEN avg_loss = 0 THEN NULL
            ELSE avg_gain / avg_loss 
        END AS rs
    FROM average_gain_loss
),
rsi_values AS (
    SELECT
        symbol,
        date,
        CASE
            WHEN rs IS NULL THEN NULL
            ELSE 100 - (100 / (1 + rs))
        END AS rsi
    FROM relative_strength
)

SELECT symbol, date, rsi
FROM rsi_values
WHERE rsi IS NOT NULL
ORDER BY symbol, date DESC
        );
[0m15:25:25.431718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:27.051285 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.619 seconds
[0m15:25:27.058699 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: Close
[0m15:25:27.249739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db388ff6-6dcb-49ef-be3a-42f3e8aeff7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132ac84d0>]}
[0m15:25:27.251840 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.stock_rsi .......................... [[32mSUCCESS 1[0m in 1.86s]
[0m15:25:27.253568 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_rsi
[0m15:25:27.254567 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_moving_avg
[0m15:25:27.256139 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.stock_moving_avg ........................ [RUN]
[0m15:25:27.257475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.stock_rsi, now model.stock_calc.stock_moving_avg)
[0m15:25:27.258352 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_moving_avg
[0m15:25:27.263288 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_moving_avg"
[0m15:25:27.265023 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_moving_avg
[0m15:25:27.269028 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_moving_avg"
[0m15:25:27.270807 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_moving_avg"
[0m15:25:27.271627 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_moving_avg"} */
create or replace transient table lab2.analytics.stock_moving_avg
         as
        (SELECT
	symbol,
	date,
	AVG(close) OVER (
		PARTITION BY symbol
		ORDER BY date
		ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
	) AS moving_avg
FROM
	lab2.analytics.data_cleaned
        );
[0m15:25:27.272382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:28.578933 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.306 seconds
[0m15:25:28.584403 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: Close
[0m15:25:28.739372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db388ff6-6dcb-49ef-be3a-42f3e8aeff7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132dc1160>]}
[0m15:25:28.741208 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.stock_moving_avg ................... [[32mSUCCESS 1[0m in 1.48s]
[0m15:25:28.742912 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_moving_avg
[0m15:25:28.745746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:28.746511 [debug] [MainThread]: Connection 'model.stock_calc.stock_moving_avg' was properly closed.
[0m15:25:28.747332 [info ] [MainThread]: 
[0m15:25:28.748138 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 6.18 seconds (6.18s).
[0m15:25:28.750274 [debug] [MainThread]: Command end result
[0m15:25:28.787882 [info ] [MainThread]: 
[0m15:25:28.788703 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:25:28.789324 [info ] [MainThread]: 
[0m15:25:28.789881 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:25:28.794499 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.014384, "process_user_time": 5.432646, "process_kernel_time": 1.20275, "process_mem_max_rss": "179281920", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:25:28.795867 [debug] [MainThread]: Command `dbt run` succeeded at 15:25:28.795554 after 10.02 seconds
[0m15:25:28.797163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d4200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b31d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106304590>]}
[0m15:25:28.798109 [debug] [MainThread]: Flushing usage events
[0m15:29:41.904353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10874e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10877d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10877ce00>]}


============================== 15:29:41.931814 | 0e1ddc81-7915-4d1c-9a6c-0b0196dfc6c2 ==============================
[0m15:29:41.931814 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:29:41.933009 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'static_parser': 'True', 'debug': 'False', 'invocation_command': 'dbt run', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'fail_fast': 'False', 'partial_parse': 'True'}
[0m15:29:59.694080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e1ddc81-7915-4d1c-9a6c-0b0196dfc6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce7ad0>]}
[0m15:29:59.817645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e1ddc81-7915-4d1c-9a6c-0b0196dfc6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087305c0>]}
[0m15:29:59.819662 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:29:59.874398 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:30:00.153574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m15:30:00.154487 [debug] [MainThread]: Partial parsing: added file: stock_calc://models/packages.yml
[0m15:30:00.155129 [debug] [MainThread]: Partial parsing: added file: stock_calc://models/schema.yml
[0m15:30:00.242001 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:30:00.242813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0e1ddc81-7915-4d1c-9a6c-0b0196dfc6c2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10877fec0>]}
[0m15:30:00.581864 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:30:00.601516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e1ddc81-7915-4d1c-9a6c-0b0196dfc6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134f722d0>]}
[0m15:30:00.773803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e1ddc81-7915-4d1c-9a6c-0b0196dfc6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134f72a50>]}
[0m15:30:00.774543 [info ] [MainThread]: Found 3 models, 7 data tests, 3 sources, 459 macros
[0m15:30:00.775068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e1ddc81-7915-4d1c-9a6c-0b0196dfc6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134faac00>]}
[0m15:30:00.778089 [info ] [MainThread]: 
[0m15:30:00.779052 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:30:00.785800 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m15:30:00.806631 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m15:30:00.807458 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m15:30:00.808015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:01.577162 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.769 seconds
[0m15:30:01.582017 [debug] [ThreadPool]: On list_lab2: Close
[0m15:30:01.761147 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m15:30:01.779236 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:30:01.779987 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:30:01.780509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:02.442349 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.662 seconds
[0m15:30:02.447456 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:30:02.644204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e1ddc81-7915-4d1c-9a6c-0b0196dfc6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707d2b0>]}
[0m15:30:02.646332 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:30:02.648111 [info ] [MainThread]: 
[0m15:30:02.655135 [debug] [Thread-1 (]: Began running node model.stock_calc.data_cleaned
[0m15:30:02.656478 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.data_cleaned ............................. [RUN]
[0m15:30:02.657529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.stock_calc.data_cleaned)
[0m15:30:02.658325 [debug] [Thread-1 (]: Began compiling node model.stock_calc.data_cleaned
[0m15:30:02.670865 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.data_cleaned"
[0m15:30:02.672274 [debug] [Thread-1 (]: Began executing node model.stock_calc.data_cleaned
[0m15:30:02.724017 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.data_cleaned"
[0m15:30:02.726735 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.data_cleaned"
[0m15:30:02.727554 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.data_cleaned"} */
create or replace   view lab2.analytics.data_cleaned
  
   as (
    SELECT
	DISTINCT date,
	close,
	symbol
FROM lab2.raw_data.stock_price
ORDER BY symbol, date DESC
  );
[0m15:30:02.728290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:03.635222 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.907 seconds
[0m15:30:03.674138 [debug] [Thread-1 (]: On model.stock_calc.data_cleaned: Close
[0m15:30:03.819196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1ddc81-7915-4d1c-9a6c-0b0196dfc6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134aecb90>]}
[0m15:30:03.820261 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.data_cleaned ........................ [[32mSUCCESS 1[0m in 1.16s]
[0m15:30:03.821238 [debug] [Thread-1 (]: Finished running node model.stock_calc.data_cleaned
[0m15:30:03.821893 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_rsi
[0m15:30:03.822697 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.stock_rsi ............................... [RUN]
[0m15:30:03.823489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.data_cleaned, now model.stock_calc.stock_rsi)
[0m15:30:03.824185 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_rsi
[0m15:30:03.826816 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_rsi"
[0m15:30:03.828538 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_rsi
[0m15:30:03.870399 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_rsi"
[0m15:30:03.874506 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_rsi"
[0m15:30:03.875347 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_rsi"} */
create or replace transient table lab2.analytics.stock_rsi
         as
        (WITH price_changes AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM analytics.data_cleaned
),
gains_losses AS (
    SELECT 
        symbol,
        date,
        close,
        previous_close,
        close - previous_close AS price_change,
        CASE 
            WHEN close - previous_close > 0 THEN close - previous_close 
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close - previous_close < 0 THEN ABS(close - previous_close) 
            ELSE 0 
        END AS loss
    FROM price_changes
    WHERE previous_close IS NOT NULL
),
average_gain_loss AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_losses
),
relative_strength AS (
    SELECT
        symbol,
        date,
        avg_gain,
        avg_loss,
        CASE 
            WHEN avg_loss = 0 THEN NULL
            ELSE avg_gain / avg_loss 
        END AS rs
    FROM average_gain_loss
),
rsi_values AS (
    SELECT
        symbol,
        date,
        CASE
            WHEN rs IS NULL THEN NULL
            ELSE 100 - (100 / (1 + rs))
        END AS rsi
    FROM relative_strength
)

SELECT symbol, date, rsi
FROM rsi_values
WHERE rsi IS NOT NULL
ORDER BY symbol, date DESC
        );
[0m15:30:03.876012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:05.480530 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.604 seconds
[0m15:30:05.486463 [debug] [Thread-1 (]: On model.stock_calc.stock_rsi: Close
[0m15:30:05.627406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1ddc81-7915-4d1c-9a6c-0b0196dfc6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1350895b0>]}
[0m15:30:05.628646 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.stock_rsi .......................... [[32mSUCCESS 1[0m in 1.80s]
[0m15:30:05.630072 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_rsi
[0m15:30:05.630877 [debug] [Thread-1 (]: Began running node model.stock_calc.stock_moving_avg
[0m15:30:05.631741 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.stock_moving_avg ........................ [RUN]
[0m15:30:05.632632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_calc.stock_rsi, now model.stock_calc.stock_moving_avg)
[0m15:30:05.633287 [debug] [Thread-1 (]: Began compiling node model.stock_calc.stock_moving_avg
[0m15:30:05.637564 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_calc.stock_moving_avg"
[0m15:30:05.639756 [debug] [Thread-1 (]: Began executing node model.stock_calc.stock_moving_avg
[0m15:30:05.643776 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_calc.stock_moving_avg"
[0m15:30:05.645610 [debug] [Thread-1 (]: Using snowflake connection "model.stock_calc.stock_moving_avg"
[0m15:30:05.646352 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "model.stock_calc.stock_moving_avg"} */
create or replace transient table lab2.analytics.stock_moving_avg
         as
        (SELECT
	symbol,
	date,
	AVG(close) OVER (
		PARTITION BY symbol
		ORDER BY date
		ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
	) AS moving_avg
FROM
	lab2.analytics.data_cleaned
        );
[0m15:30:05.647076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:07.425148 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.778 seconds
[0m15:30:07.430585 [debug] [Thread-1 (]: On model.stock_calc.stock_moving_avg: Close
[0m15:30:07.592148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1ddc81-7915-4d1c-9a6c-0b0196dfc6c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1352a3cb0>]}
[0m15:30:07.594801 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.stock_moving_avg ................... [[32mSUCCESS 1[0m in 1.96s]
[0m15:30:07.596716 [debug] [Thread-1 (]: Finished running node model.stock_calc.stock_moving_avg
[0m15:30:07.599897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:07.600812 [debug] [MainThread]: Connection 'model.stock_calc.stock_moving_avg' was properly closed.
[0m15:30:07.601955 [info ] [MainThread]: 
[0m15:30:07.603678 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 6.82 seconds (6.82s).
[0m15:30:07.608015 [debug] [MainThread]: Command end result
[0m15:30:07.666465 [info ] [MainThread]: 
[0m15:30:07.667218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:30:07.667883 [info ] [MainThread]: 
[0m15:30:07.668880 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:30:07.682413 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 25.901173, "process_user_time": 5.735441, "process_kernel_time": 1.612846, "process_mem_max_rss": "180441088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:30:07.683448 [debug] [MainThread]: Command `dbt run` succeeded at 15:30:07.683263 after 25.90 seconds
[0m15:30:07.684178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13519b320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10877d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1352bd7f0>]}
[0m15:30:07.684754 [debug] [MainThread]: Flushing usage events
[0m15:31:13.023921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10733a5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e0ce0>]}


============================== 15:31:13.049647 | 5b991fd7-5631-4be3-a63d-d31275a181a6 ==============================
[0m15:31:13.049647 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:31:13.050886 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/jiyoonlee/.dbt', 'empty': 'None', 'debug': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt test', 'log_format': 'default', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'version_check': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'no_print': 'None', 'introspect': 'True', 'static_parser': 'True', 'printer_width': '80', 'warn_error': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'write_json': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m15:31:16.359776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b991fd7-5631-4be3-a63d-d31275a181a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7d1f0>]}
[0m15:31:16.445324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b991fd7-5631-4be3-a63d-d31275a181a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10781c3e0>]}
[0m15:31:16.447060 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:31:16.479112 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:31:16.746833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:31:16.747480 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:31:16.755832 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:31:16.818510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b991fd7-5631-4be3-a63d-d31275a181a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1338abe00>]}
[0m15:31:17.008082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b991fd7-5631-4be3-a63d-d31275a181a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133daa9c0>]}
[0m15:31:17.008896 [info ] [MainThread]: Found 3 models, 7 data tests, 3 sources, 459 macros
[0m15:31:17.009469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b991fd7-5631-4be3-a63d-d31275a181a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133d6abd0>]}
[0m15:31:17.012987 [info ] [MainThread]: 
[0m15:31:17.014130 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:31:17.021488 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_analytics'
[0m15:31:17.047570 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:31:17.048409 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:31:17.049402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:18.081579 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.031 seconds
[0m15:31:18.084821 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:31:18.246050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b991fd7-5631-4be3-a63d-d31275a181a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133d8f590>]}
[0m15:31:18.247357 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:31:18.248083 [info ] [MainThread]: 
[0m15:31:18.253407 [debug] [Thread-1 (]: Began running node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc
[0m15:31:18.254340 [info ] [Thread-1 (]: 1 of 7 START test dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date  [RUN]
[0m15:31:18.255386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc)
[0m15:31:18.256293 [debug] [Thread-1 (]: Began compiling node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc
[0m15:31:18.291664 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:31:18.292792 [error] [Thread-1 (]: 1 of 7 ERROR dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date .... [[31mERROR[0m in 0.04s]
[0m15:31:18.294307 [debug] [Thread-1 (]: Finished running node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc
[0m15:31:18.295057 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:31:18.295618 [info ] [Thread-1 (]: 2 of 7 START test not_null_stock_moving_avg_date ............................... [RUN]
[0m15:31:18.299149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc, now test.stock_calc.not_null_stock_moving_avg_date.bd96888016)
[0m15:31:18.300817 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:31:18.314089 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"
[0m15:31:18.315460 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:31:18.357554 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"
[0m15:31:18.359525 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"
[0m15:31:18.360306 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_date.bd96888016: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2.analytics.stock_moving_avg
where date is null



      
    ) dbt_internal_test
[0m15:31:18.361093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:19.107026 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.746 seconds
[0m15:31:19.119918 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_date.bd96888016: Close
[0m15:31:19.282956 [info ] [Thread-1 (]: 2 of 7 PASS not_null_stock_moving_avg_date ..................................... [[32mPASS[0m in 0.98s]
[0m15:31:19.286424 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:31:19.288398 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_moving_avg_moving_average.81b707c3e3
[0m15:31:19.290336 [info ] [Thread-1 (]: 3 of 7 START test not_null_stock_moving_avg_moving_average ..................... [RUN]
[0m15:31:19.291903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_moving_avg_date.bd96888016, now test.stock_calc.not_null_stock_moving_avg_moving_average.81b707c3e3)
[0m15:31:19.293252 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_moving_avg_moving_average.81b707c3e3
[0m15:31:19.301107 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_moving_avg_moving_average.81b707c3e3"
[0m15:31:19.302394 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_moving_avg_moving_average.81b707c3e3
[0m15:31:19.306092 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_moving_avg_moving_average.81b707c3e3"
[0m15:31:19.307550 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_moving_avg_moving_average.81b707c3e3"
[0m15:31:19.308130 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_moving_average.81b707c3e3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_moving_avg_moving_average.81b707c3e3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average
from lab2.analytics.stock_moving_avg
where moving_average is null



      
    ) dbt_internal_test
[0m15:31:19.308630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:19.926762 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b854e3-0004-26cb-0002-65f3000180ae
[0m15:31:19.927575 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MOVING_AVERAGE'
[0m15:31:19.928426 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_moving_average.81b707c3e3: Close
[0m15:31:20.064196 [debug] [Thread-1 (]: Database Error in test not_null_stock_moving_avg_moving_average (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MOVING_AVERAGE'
  compiled code at target/run/stock_calc/models/schema.yml/not_null_stock_moving_avg_moving_average.sql
[0m15:31:20.065172 [error] [Thread-1 (]: 3 of 7 ERROR not_null_stock_moving_avg_moving_average .......................... [[31mERROR[0m in 0.77s]
[0m15:31:20.066174 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_moving_avg_moving_average.81b707c3e3
[0m15:31:20.066872 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:31:20.067636 [info ] [Thread-1 (]: 4 of 7 START test not_null_stock_moving_avg_symbol ............................. [RUN]
[0m15:31:20.068460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_moving_avg_moving_average.81b707c3e3, now test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07)
[0m15:31:20.069060 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:31:20.075348 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"
[0m15:31:20.076567 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:31:20.079877 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"
[0m15:31:20.081425 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"
[0m15:31:20.082020 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2.analytics.stock_moving_avg
where symbol is null



      
    ) dbt_internal_test
[0m15:31:20.082536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:20.771368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m15:31:20.774791 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07: Close
[0m15:31:20.914621 [info ] [Thread-1 (]: 4 of 7 PASS not_null_stock_moving_avg_symbol ................................... [[32mPASS[0m in 0.85s]
[0m15:31:20.915929 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:31:20.916789 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:31:20.917860 [info ] [Thread-1 (]: 5 of 7 START test not_null_stock_rsi_date ...................................... [RUN]
[0m15:31:20.918884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07, now test.stock_calc.not_null_stock_rsi_date.5bcea16269)
[0m15:31:20.919617 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:31:20.926078 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_rsi_date.5bcea16269"
[0m15:31:20.927180 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:31:20.930644 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_rsi_date.5bcea16269"
[0m15:31:20.932100 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_rsi_date.5bcea16269"
[0m15:31:20.932677 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_date.5bcea16269: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_rsi_date.5bcea16269"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2.analytics.stock_rsi
where date is null



      
    ) dbt_internal_test
[0m15:31:20.933174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:21.668279 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.735 seconds
[0m15:31:21.671999 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_date.5bcea16269: Close
[0m15:31:21.808386 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stock_rsi_date ............................................ [[32mPASS[0m in 0.89s]
[0m15:31:21.809467 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:31:21.810153 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_rsi_moving_average.1143a99e47
[0m15:31:21.810819 [info ] [Thread-1 (]: 6 of 7 START test not_null_stock_rsi_moving_average ............................ [RUN]
[0m15:31:21.811562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_rsi_date.5bcea16269, now test.stock_calc.not_null_stock_rsi_moving_average.1143a99e47)
[0m15:31:21.812104 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_rsi_moving_average.1143a99e47
[0m15:31:21.818096 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_rsi_moving_average.1143a99e47"
[0m15:31:21.820277 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_rsi_moving_average.1143a99e47
[0m15:31:21.826372 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_rsi_moving_average.1143a99e47"
[0m15:31:21.828149 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_rsi_moving_average.1143a99e47"
[0m15:31:21.828887 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_moving_average.1143a99e47: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_rsi_moving_average.1143a99e47"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average
from lab2.analytics.stock_rsi
where moving_average is null



      
    ) dbt_internal_test
[0m15:31:21.829899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:22.533808 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b854e3-0004-26b9-0002-65f3000124fe
[0m15:31:22.535679 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MOVING_AVERAGE'
[0m15:31:22.537278 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_moving_average.1143a99e47: Close
[0m15:31:22.692520 [debug] [Thread-1 (]: Database Error in test not_null_stock_rsi_moving_average (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MOVING_AVERAGE'
  compiled code at target/run/stock_calc/models/schema.yml/not_null_stock_rsi_moving_average.sql
[0m15:31:22.693324 [error] [Thread-1 (]: 6 of 7 ERROR not_null_stock_rsi_moving_average ................................. [[31mERROR[0m in 0.88s]
[0m15:31:22.694314 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_rsi_moving_average.1143a99e47
[0m15:31:22.694960 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:31:22.695639 [info ] [Thread-1 (]: 7 of 7 START test not_null_stock_rsi_symbol .................................... [RUN]
[0m15:31:22.696563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_rsi_moving_average.1143a99e47, now test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0)
[0m15:31:22.697149 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:31:22.703196 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"
[0m15:31:22.704340 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:31:22.707647 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"
[0m15:31:22.708954 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"
[0m15:31:22.709510 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2.analytics.stock_rsi
where symbol is null



      
    ) dbt_internal_test
[0m15:31:22.710010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:23.265033 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.555 seconds
[0m15:31:23.270855 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0: Close
[0m15:31:23.418944 [info ] [Thread-1 (]: 7 of 7 PASS not_null_stock_rsi_symbol .......................................... [[32mPASS[0m in 0.72s]
[0m15:31:23.420356 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:31:23.422994 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:23.423929 [debug] [MainThread]: Connection 'test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0' was properly closed.
[0m15:31:23.424691 [info ] [MainThread]: 
[0m15:31:23.425501 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 6.41 seconds (6.41s).
[0m15:31:23.428874 [debug] [MainThread]: Command end result
[0m15:31:23.479013 [info ] [MainThread]: 
[0m15:31:23.480043 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:31:23.481116 [info ] [MainThread]: 
[0m15:31:23.482230 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:31:23.483669 [info ] [MainThread]: 
[0m15:31:23.485257 [error] [MainThread]:   Database Error in test not_null_stock_moving_avg_moving_average (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MOVING_AVERAGE'
  compiled code at target/run/stock_calc/models/schema.yml/not_null_stock_moving_avg_moving_average.sql
[0m15:31:23.486440 [info ] [MainThread]: 
[0m15:31:23.487587 [error] [MainThread]:   Database Error in test not_null_stock_rsi_moving_average (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MOVING_AVERAGE'
  compiled code at target/run/stock_calc/models/schema.yml/not_null_stock_rsi_moving_average.sql
[0m15:31:23.488514 [info ] [MainThread]: 
[0m15:31:23.489538 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
[0m15:31:23.494913 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 10.598057, "process_user_time": 5.564409, "process_kernel_time": 1.480677, "process_mem_max_rss": "180219904", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:31:23.496383 [debug] [MainThread]: Command `dbt test` failed at 15:31:23.496034 after 10.60 seconds
[0m15:31:23.497483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e0e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e0f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e0ce0>]}
[0m15:31:23.498408 [debug] [MainThread]: Flushing usage events
[0m15:34:35.453953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfd38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca58f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca58c20>]}


============================== 15:34:35.478090 | 3507a688-0700-427c-95ef-2eac72f15209 ==============================
[0m15:34:35.478090 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:34:35.479236 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'fail_fast': 'False', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'warn_error': 'None', 'debug': 'False', 'target_path': 'None', 'invocation_command': 'dbt test', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'introspect': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'printer_width': '80', 'empty': 'None'}
[0m15:34:52.778544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3507a688-0700-427c-95ef-2eac72f15209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7192e0>]}
[0m15:34:52.867878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3507a688-0700-427c-95ef-2eac72f15209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122638c0>]}
[0m15:34:52.869714 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:34:52.919152 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:34:53.208839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:34:53.210163 [debug] [MainThread]: Partial parsing: updated file: stock_calc://models/schema.yml
[0m15:34:53.557515 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:34:53.558306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3507a688-0700-427c-95ef-2eac72f15209', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca88140>]}
[0m15:34:53.860537 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:34:53.879742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3507a688-0700-427c-95ef-2eac72f15209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1391c0290>]}
[0m15:34:54.075312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3507a688-0700-427c-95ef-2eac72f15209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1395dde50>]}
[0m15:34:54.076053 [info ] [MainThread]: Found 3 models, 7 data tests, 3 sources, 459 macros
[0m15:34:54.076561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3507a688-0700-427c-95ef-2eac72f15209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138e96450>]}
[0m15:34:54.080128 [info ] [MainThread]: 
[0m15:34:54.081608 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:34:54.088482 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_analytics'
[0m15:34:54.118501 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:34:54.119273 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:34:54.119846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:54.896543 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.776 seconds
[0m15:34:54.902100 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:34:55.062734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3507a688-0700-427c-95ef-2eac72f15209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13938c0e0>]}
[0m15:34:55.065891 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:34:55.066815 [info ] [MainThread]: 
[0m15:34:55.073315 [debug] [Thread-1 (]: Began running node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc
[0m15:34:55.074501 [info ] [Thread-1 (]: 1 of 7 START test dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date  [RUN]
[0m15:34:55.075823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc)
[0m15:34:55.076676 [debug] [Thread-1 (]: Began compiling node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc
[0m15:34:55.106436 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:34:55.107971 [error] [Thread-1 (]: 1 of 7 ERROR dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date .... [[31mERROR[0m in 0.03s]
[0m15:34:55.108981 [debug] [Thread-1 (]: Finished running node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc
[0m15:34:55.109668 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:34:55.110496 [info ] [Thread-1 (]: 2 of 7 START test not_null_stock_moving_avg_date ............................... [RUN]
[0m15:34:55.112565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc, now test.stock_calc.not_null_stock_moving_avg_date.bd96888016)
[0m15:34:55.113240 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:34:55.125611 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"
[0m15:34:55.128065 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:34:55.159728 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"
[0m15:34:55.162030 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"
[0m15:34:55.162688 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_date.bd96888016: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2.analytics.stock_moving_avg
where date is null



      
    ) dbt_internal_test
[0m15:34:55.163212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:55.770809 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.607 seconds
[0m15:34:55.791825 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_date.bd96888016: Close
[0m15:34:55.946636 [info ] [Thread-1 (]: 2 of 7 PASS not_null_stock_moving_avg_date ..................................... [[32mPASS[0m in 0.83s]
[0m15:34:55.948902 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:34:55.950048 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27
[0m15:34:55.951094 [info ] [Thread-1 (]: 3 of 7 START test not_null_stock_moving_avg_moving_avg ......................... [RUN]
[0m15:34:55.952218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_moving_avg_date.bd96888016, now test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27)
[0m15:34:55.953069 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27
[0m15:34:55.960855 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27"
[0m15:34:55.962185 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27
[0m15:34:55.966212 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27"
[0m15:34:55.967794 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27"
[0m15:34:55.968373 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg
from lab2.analytics.stock_moving_avg
where moving_avg is null



      
    ) dbt_internal_test
[0m15:34:55.968880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:56.818197 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.849 seconds
[0m15:34:56.821267 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27: Close
[0m15:34:56.994898 [info ] [Thread-1 (]: 3 of 7 PASS not_null_stock_moving_avg_moving_avg ............................... [[32mPASS[0m in 1.04s]
[0m15:34:56.996515 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27
[0m15:34:56.997502 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:34:56.998880 [info ] [Thread-1 (]: 4 of 7 START test not_null_stock_moving_avg_symbol ............................. [RUN]
[0m15:34:57.000058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27, now test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07)
[0m15:34:57.000955 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:34:57.010651 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"
[0m15:34:57.012409 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:34:57.109043 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"
[0m15:34:57.110618 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"
[0m15:34:57.111194 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2.analytics.stock_moving_avg
where symbol is null



      
    ) dbt_internal_test
[0m15:34:57.111708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:57.841347 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.730 seconds
[0m15:34:57.844070 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07: Close
[0m15:34:57.988635 [info ] [Thread-1 (]: 4 of 7 PASS not_null_stock_moving_avg_symbol ................................... [[32mPASS[0m in 0.99s]
[0m15:34:57.990585 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:34:57.991856 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:34:57.993148 [info ] [Thread-1 (]: 5 of 7 START test not_null_stock_rsi_date ...................................... [RUN]
[0m15:34:57.994301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07, now test.stock_calc.not_null_stock_rsi_date.5bcea16269)
[0m15:34:57.995284 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:34:58.003687 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_rsi_date.5bcea16269"
[0m15:34:58.005234 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:34:58.008991 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_rsi_date.5bcea16269"
[0m15:34:58.011138 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_rsi_date.5bcea16269"
[0m15:34:58.011951 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_date.5bcea16269: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_rsi_date.5bcea16269"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2.analytics.stock_rsi
where date is null



      
    ) dbt_internal_test
[0m15:34:58.012750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:58.764970 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.752 seconds
[0m15:34:58.769750 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_date.5bcea16269: Close
[0m15:34:58.914538 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stock_rsi_date ............................................ [[32mPASS[0m in 0.92s]
[0m15:34:58.915570 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:34:58.916207 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_rsi_rsi.154ae97906
[0m15:34:58.916769 [info ] [Thread-1 (]: 6 of 7 START test not_null_stock_rsi_rsi ....................................... [RUN]
[0m15:34:58.917514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_rsi_date.5bcea16269, now test.stock_calc.not_null_stock_rsi_rsi.154ae97906)
[0m15:34:58.918088 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_rsi_rsi.154ae97906
[0m15:34:58.924011 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_rsi_rsi.154ae97906"
[0m15:34:58.925235 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_rsi_rsi.154ae97906
[0m15:34:58.928583 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_rsi_rsi.154ae97906"
[0m15:34:58.929945 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_rsi_rsi.154ae97906"
[0m15:34:58.930536 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_rsi.154ae97906: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_rsi_rsi.154ae97906"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi
from lab2.analytics.stock_rsi
where rsi is null



      
    ) dbt_internal_test
[0m15:34:58.931027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:59.788106 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.857 seconds
[0m15:34:59.791117 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_rsi.154ae97906: Close
[0m15:34:59.938640 [info ] [Thread-1 (]: 6 of 7 PASS not_null_stock_rsi_rsi ............................................. [[32mPASS[0m in 1.02s]
[0m15:34:59.941094 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_rsi_rsi.154ae97906
[0m15:34:59.943141 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:34:59.944605 [info ] [Thread-1 (]: 7 of 7 START test not_null_stock_rsi_symbol .................................... [RUN]
[0m15:34:59.945790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_rsi_rsi.154ae97906, now test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0)
[0m15:34:59.946847 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:34:59.954695 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"
[0m15:34:59.956122 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:34:59.960169 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"
[0m15:34:59.961849 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"
[0m15:34:59.962414 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2.analytics.stock_rsi
where symbol is null



      
    ) dbt_internal_test
[0m15:34:59.962908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:00.528160 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m15:35:00.531727 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0: Close
[0m15:35:00.672172 [info ] [Thread-1 (]: 7 of 7 PASS not_null_stock_rsi_symbol .......................................... [[32mPASS[0m in 0.73s]
[0m15:35:00.673942 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:35:00.676894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:00.677786 [debug] [MainThread]: Connection 'test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0' was properly closed.
[0m15:35:00.678570 [info ] [MainThread]: 
[0m15:35:00.679455 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 6.60 seconds (6.60s).
[0m15:35:00.682608 [debug] [MainThread]: Command end result
[0m15:35:00.728436 [info ] [MainThread]: 
[0m15:35:00.729135 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:35:00.729626 [info ] [MainThread]: 
[0m15:35:00.730184 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:35:00.730642 [info ] [MainThread]: 
[0m15:35:00.731104 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m15:35:00.743703 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 25.408005, "process_user_time": 6.12393, "process_kernel_time": 1.625093, "process_mem_max_rss": "184532992", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:35:00.744781 [debug] [MainThread]: Command `dbt test` failed at 15:35:00.744585 after 25.41 seconds
[0m15:35:00.745443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca58d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca5a3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1395bb740>]}
[0m15:35:00.745959 [debug] [MainThread]: Flushing usage events
[0m15:35:47.528113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ecaf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10704d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10704cd70>]}


============================== 15:35:47.535599 | 8648b177-4a67-4446-afac-6a4cb2086553 ==============================
[0m15:35:47.535599 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:35:47.536662 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'invocation_command': 'dbt test', 'printer_width': '80', 'log_cache_events': 'False', 'partial_parse': 'True', 'version_check': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'write_json': 'True', 'log_format': 'default', 'use_colors': 'True'}
[0m15:35:49.815604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8648b177-4a67-4446-afac-6a4cb2086553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13341aae0>]}
[0m15:35:49.902502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8648b177-4a67-4446-afac-6a4cb2086553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b7e330>]}
[0m15:35:49.904603 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:35:49.937017 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:35:50.215499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:35:50.216688 [debug] [MainThread]: Partial parsing: updated file: stock_calc://models/schema.yml
[0m15:35:50.548850 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:35:50.549644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8648b177-4a67-4446-afac-6a4cb2086553', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1337477d0>]}
[0m15:35:50.832541 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:35:50.850584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8648b177-4a67-4446-afac-6a4cb2086553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1338afec0>]}
[0m15:35:51.030992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8648b177-4a67-4446-afac-6a4cb2086553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133bc2990>]}
[0m15:35:51.031791 [info ] [MainThread]: Found 3 models, 8 data tests, 3 sources, 459 macros
[0m15:35:51.032382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8648b177-4a67-4446-afac-6a4cb2086553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1334b3800>]}
[0m15:35:51.035640 [info ] [MainThread]: 
[0m15:35:51.036552 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:35:51.045327 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_analytics'
[0m15:35:51.073560 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:35:51.074629 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:35:51.075300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:51.762075 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.687 seconds
[0m15:35:51.768142 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:35:51.912503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8648b177-4a67-4446-afac-6a4cb2086553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1333f0bf0>]}
[0m15:35:51.914221 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:35:51.915356 [info ] [MainThread]: 
[0m15:35:51.921312 [debug] [Thread-1 (]: Began running node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088
[0m15:35:51.922410 [info ] [Thread-1 (]: 1 of 8 START test dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date  [RUN]
[0m15:35:51.923485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088)
[0m15:35:51.924319 [debug] [Thread-1 (]: Began compiling node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088
[0m15:35:51.956124 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:35:51.957015 [error] [Thread-1 (]: 1 of 8 ERROR dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date  [[31mERROR[0m in 0.03s]
[0m15:35:51.957835 [debug] [Thread-1 (]: Finished running node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088
[0m15:35:51.958445 [debug] [Thread-1 (]: Began running node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc
[0m15:35:51.958955 [info ] [Thread-1 (]: 2 of 8 START test dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date  [RUN]
[0m15:35:51.959652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088, now test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc)
[0m15:35:51.961296 [debug] [Thread-1 (]: Began compiling node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc
[0m15:35:51.969290 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:35:51.970221 [error] [Thread-1 (]: 2 of 8 ERROR dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date .... [[31mERROR[0m in 0.01s]
[0m15:35:51.971100 [debug] [Thread-1 (]: Finished running node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc
[0m15:35:51.971703 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:35:51.972192 [info ] [Thread-1 (]: 3 of 8 START test not_null_stock_moving_avg_date ............................... [RUN]
[0m15:35:51.972803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc, now test.stock_calc.not_null_stock_moving_avg_date.bd96888016)
[0m15:35:51.973309 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:35:51.985316 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"
[0m15:35:51.986680 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:35:52.018470 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"
[0m15:35:52.020233 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"
[0m15:35:52.020840 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_date.bd96888016: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2.analytics.stock_moving_avg
where date is null



      
    ) dbt_internal_test
[0m15:35:52.021345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:52.672857 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.651 seconds
[0m15:35:52.689005 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_date.bd96888016: Close
[0m15:35:52.826148 [info ] [Thread-1 (]: 3 of 8 PASS not_null_stock_moving_avg_date ..................................... [[32mPASS[0m in 0.85s]
[0m15:35:52.828580 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:35:52.829731 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27
[0m15:35:52.830865 [info ] [Thread-1 (]: 4 of 8 START test not_null_stock_moving_avg_moving_avg ......................... [RUN]
[0m15:35:52.832404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_moving_avg_date.bd96888016, now test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27)
[0m15:35:52.834097 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27
[0m15:35:52.841741 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27"
[0m15:35:52.843305 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27
[0m15:35:52.847484 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27"
[0m15:35:52.849085 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27"
[0m15:35:52.849647 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg
from lab2.analytics.stock_moving_avg
where moving_avg is null



      
    ) dbt_internal_test
[0m15:35:52.850146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:53.653893 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.803 seconds
[0m15:35:53.659197 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27: Close
[0m15:35:53.802667 [info ] [Thread-1 (]: 4 of 8 PASS not_null_stock_moving_avg_moving_avg ............................... [[32mPASS[0m in 0.97s]
[0m15:35:53.804725 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27
[0m15:35:53.805993 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:35:53.807138 [info ] [Thread-1 (]: 5 of 8 START test not_null_stock_moving_avg_symbol ............................. [RUN]
[0m15:35:53.808409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27, now test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07)
[0m15:35:53.809413 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:35:53.819976 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"
[0m15:35:53.821466 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:35:53.922024 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"
[0m15:35:53.923713 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"
[0m15:35:53.924400 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2.analytics.stock_moving_avg
where symbol is null



      
    ) dbt_internal_test
[0m15:35:53.924922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:54.497538 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.572 seconds
[0m15:35:54.505428 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07: Close
[0m15:35:54.644231 [info ] [Thread-1 (]: 5 of 8 PASS not_null_stock_moving_avg_symbol ................................... [[32mPASS[0m in 0.84s]
[0m15:35:54.645819 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:35:54.646717 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:35:54.647320 [info ] [Thread-1 (]: 6 of 8 START test not_null_stock_rsi_date ...................................... [RUN]
[0m15:35:54.648063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07, now test.stock_calc.not_null_stock_rsi_date.5bcea16269)
[0m15:35:54.648650 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:35:54.655043 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_rsi_date.5bcea16269"
[0m15:35:54.656336 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:35:54.659927 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_rsi_date.5bcea16269"
[0m15:35:54.661562 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_rsi_date.5bcea16269"
[0m15:35:54.662296 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_date.5bcea16269: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_rsi_date.5bcea16269"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2.analytics.stock_rsi
where date is null



      
    ) dbt_internal_test
[0m15:35:54.662899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:55.185970 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.523 seconds
[0m15:35:55.191726 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_date.5bcea16269: Close
[0m15:35:55.326285 [info ] [Thread-1 (]: 6 of 8 PASS not_null_stock_rsi_date ............................................ [[32mPASS[0m in 0.68s]
[0m15:35:55.328157 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:35:55.329189 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_rsi_rsi.154ae97906
[0m15:35:55.330050 [info ] [Thread-1 (]: 7 of 8 START test not_null_stock_rsi_rsi ....................................... [RUN]
[0m15:35:55.331182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_rsi_date.5bcea16269, now test.stock_calc.not_null_stock_rsi_rsi.154ae97906)
[0m15:35:55.332122 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_rsi_rsi.154ae97906
[0m15:35:55.340122 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_rsi_rsi.154ae97906"
[0m15:35:55.341654 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_rsi_rsi.154ae97906
[0m15:35:55.345451 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_rsi_rsi.154ae97906"
[0m15:35:55.346993 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_rsi_rsi.154ae97906"
[0m15:35:55.347562 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_rsi.154ae97906: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_rsi_rsi.154ae97906"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi
from lab2.analytics.stock_rsi
where rsi is null



      
    ) dbt_internal_test
[0m15:35:55.348067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:56.008113 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.660 seconds
[0m15:35:56.010786 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_rsi.154ae97906: Close
[0m15:35:56.156996 [info ] [Thread-1 (]: 7 of 8 PASS not_null_stock_rsi_rsi ............................................. [[32mPASS[0m in 0.83s]
[0m15:35:56.158992 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_rsi_rsi.154ae97906
[0m15:35:56.160196 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:35:56.161349 [info ] [Thread-1 (]: 8 of 8 START test not_null_stock_rsi_symbol .................................... [RUN]
[0m15:35:56.162490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_rsi_rsi.154ae97906, now test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0)
[0m15:35:56.163336 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:35:56.171708 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"
[0m15:35:56.173508 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:35:56.177287 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"
[0m15:35:56.178836 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"
[0m15:35:56.179475 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2.analytics.stock_rsi
where symbol is null



      
    ) dbt_internal_test
[0m15:35:56.179991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:56.717187 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.537 seconds
[0m15:35:56.722317 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0: Close
[0m15:35:56.870897 [info ] [Thread-1 (]: 8 of 8 PASS not_null_stock_rsi_symbol .......................................... [[32mPASS[0m in 0.71s]
[0m15:35:56.872892 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:35:56.875697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:56.876482 [debug] [MainThread]: Connection 'test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0' was properly closed.
[0m15:35:56.877268 [info ] [MainThread]: 
[0m15:35:56.877920 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 5.84 seconds (5.84s).
[0m15:35:56.880949 [debug] [MainThread]: Command end result
[0m15:35:56.924791 [info ] [MainThread]: 
[0m15:35:56.925520 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:35:56.926059 [info ] [MainThread]: 
[0m15:35:56.926797 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:35:56.927654 [info ] [MainThread]: 
[0m15:35:56.928556 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:35:56.929410 [info ] [MainThread]: 
[0m15:35:56.930451 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=0 TOTAL=8
[0m15:35:56.934488 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 9.509872, "process_user_time": 6.236631, "process_kernel_time": 1.222033, "process_mem_max_rss": "185753600", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:35:56.935627 [debug] [MainThread]: Command `dbt test` failed at 15:35:56.935421 after 9.51 seconds
[0m15:35:56.936280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ecb230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132fb9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13351dd90>]}
[0m15:35:56.936812 [debug] [MainThread]: Flushing usage events
[0m15:37:08.629778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fead80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037409b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b0d40>]}


============================== 15:37:08.636872 | 2f77c825-caad-4228-beb1-842d0e98056b ==============================
[0m15:37:08.636872 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:37:08.637997 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'debug': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'invocation_command': 'dbt test', 'printer_width': '80', 'partial_parse': 'True', 'introspect': 'True', 'log_format': 'default', 'version_check': 'True', 'log_cache_events': 'False', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'target_path': 'None', 'static_parser': 'True'}
[0m15:37:11.493250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f77c825-caad-4228-beb1-842d0e98056b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13242e360>]}
[0m15:37:11.577860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f77c825-caad-4228-beb1-842d0e98056b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105090230>]}
[0m15:37:11.580607 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:37:11.614392 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:37:11.915688 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m15:37:12.042929 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:37:12.062831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f77c825-caad-4228-beb1-842d0e98056b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132572150>]}
[0m15:37:12.240221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f77c825-caad-4228-beb1-842d0e98056b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132976a20>]}
[0m15:37:12.241047 [info ] [MainThread]: Found 3 models, 8 data tests, 3 sources, 459 macros
[0m15:37:12.241637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f77c825-caad-4228-beb1-842d0e98056b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1327b9ac0>]}
[0m15:37:12.245014 [info ] [MainThread]: 
[0m15:37:12.246076 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:37:12.253152 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_analytics'
[0m15:37:12.285024 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:37:12.285762 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:37:12.286307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:13.108544 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.821 seconds
[0m15:37:13.114972 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:37:13.254920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f77c825-caad-4228-beb1-842d0e98056b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1325722d0>]}
[0m15:37:13.256695 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:37:13.257682 [info ] [MainThread]: 
[0m15:37:13.264314 [debug] [Thread-1 (]: Began running node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088
[0m15:37:13.265544 [info ] [Thread-1 (]: 1 of 8 START test dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date  [RUN]
[0m15:37:13.267170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088)
[0m15:37:13.268203 [debug] [Thread-1 (]: Began compiling node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088
[0m15:37:13.309486 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:37:13.310631 [error] [Thread-1 (]: 1 of 8 ERROR dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date  [[31mERROR[0m in 0.04s]
[0m15:37:13.312669 [debug] [Thread-1 (]: Finished running node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088
[0m15:37:13.313574 [debug] [Thread-1 (]: Began running node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc
[0m15:37:13.315188 [info ] [Thread-1 (]: 2 of 8 START test dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date  [RUN]
[0m15:37:13.315984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088, now test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc)
[0m15:37:13.316561 [debug] [Thread-1 (]: Began compiling node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc
[0m15:37:13.323657 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:37:13.324506 [error] [Thread-1 (]: 2 of 8 ERROR dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date .... [[31mERROR[0m in 0.01s]
[0m15:37:13.325344 [debug] [Thread-1 (]: Finished running node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc
[0m15:37:13.325957 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:37:13.326472 [info ] [Thread-1 (]: 3 of 8 START test not_null_stock_moving_avg_date ............................... [RUN]
[0m15:37:13.327278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc, now test.stock_calc.not_null_stock_moving_avg_date.bd96888016)
[0m15:37:13.327877 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:37:13.340391 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"
[0m15:37:13.341758 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:37:13.379272 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"
[0m15:37:13.381102 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"
[0m15:37:13.381788 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_date.bd96888016: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2.analytics.stock_moving_avg
where date is null



      
    ) dbt_internal_test
[0m15:37:13.382338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:13.916222 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.533 seconds
[0m15:37:13.935872 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_date.bd96888016: Close
[0m15:37:14.143543 [info ] [Thread-1 (]: 3 of 8 PASS not_null_stock_moving_avg_date ..................................... [[32mPASS[0m in 0.82s]
[0m15:37:14.145577 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:37:14.146713 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27
[0m15:37:14.147476 [info ] [Thread-1 (]: 4 of 8 START test not_null_stock_moving_avg_moving_avg ......................... [RUN]
[0m15:37:14.148365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_moving_avg_date.bd96888016, now test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27)
[0m15:37:14.149043 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27
[0m15:37:14.155133 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27"
[0m15:37:14.156379 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27
[0m15:37:14.159794 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27"
[0m15:37:14.161304 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27"
[0m15:37:14.161880 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg
from lab2.analytics.stock_moving_avg
where moving_avg is null



      
    ) dbt_internal_test
[0m15:37:14.162391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:14.780158 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.617 seconds
[0m15:37:14.785483 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27: Close
[0m15:37:14.924964 [info ] [Thread-1 (]: 4 of 8 PASS not_null_stock_moving_avg_moving_avg ............................... [[32mPASS[0m in 0.78s]
[0m15:37:14.926956 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27
[0m15:37:14.928345 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:37:14.929538 [info ] [Thread-1 (]: 5 of 8 START test not_null_stock_moving_avg_symbol ............................. [RUN]
[0m15:37:14.930654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27, now test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07)
[0m15:37:14.931509 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:37:14.939631 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"
[0m15:37:14.941091 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:37:14.944884 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"
[0m15:37:14.946397 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"
[0m15:37:14.947013 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2.analytics.stock_moving_avg
where symbol is null



      
    ) dbt_internal_test
[0m15:37:14.947532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:15.594597 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.647 seconds
[0m15:37:15.597768 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07: Close
[0m15:37:15.749434 [info ] [Thread-1 (]: 5 of 8 PASS not_null_stock_moving_avg_symbol ................................... [[32mPASS[0m in 0.82s]
[0m15:37:15.750433 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:37:15.751032 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:37:15.751536 [info ] [Thread-1 (]: 6 of 8 START test not_null_stock_rsi_date ...................................... [RUN]
[0m15:37:15.752129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07, now test.stock_calc.not_null_stock_rsi_date.5bcea16269)
[0m15:37:15.752655 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:37:15.758709 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_rsi_date.5bcea16269"
[0m15:37:15.760028 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:37:15.763585 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_rsi_date.5bcea16269"
[0m15:37:15.765298 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_rsi_date.5bcea16269"
[0m15:37:15.766004 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_date.5bcea16269: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_rsi_date.5bcea16269"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2.analytics.stock_rsi
where date is null



      
    ) dbt_internal_test
[0m15:37:15.766572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:16.313926 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.547 seconds
[0m15:37:16.319398 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_date.5bcea16269: Close
[0m15:37:16.458844 [info ] [Thread-1 (]: 6 of 8 PASS not_null_stock_rsi_date ............................................ [[32mPASS[0m in 0.71s]
[0m15:37:16.460704 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:37:16.461899 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_rsi_rsi.154ae97906
[0m15:37:16.463135 [info ] [Thread-1 (]: 7 of 8 START test not_null_stock_rsi_rsi ....................................... [RUN]
[0m15:37:16.464297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_rsi_date.5bcea16269, now test.stock_calc.not_null_stock_rsi_rsi.154ae97906)
[0m15:37:16.465093 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_rsi_rsi.154ae97906
[0m15:37:16.475382 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_rsi_rsi.154ae97906"
[0m15:37:16.476750 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_rsi_rsi.154ae97906
[0m15:37:16.480656 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_rsi_rsi.154ae97906"
[0m15:37:16.482197 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_rsi_rsi.154ae97906"
[0m15:37:16.482774 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_rsi.154ae97906: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_rsi_rsi.154ae97906"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi
from lab2.analytics.stock_rsi
where rsi is null



      
    ) dbt_internal_test
[0m15:37:16.483287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:17.381746 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.898 seconds
[0m15:37:17.386224 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_rsi.154ae97906: Close
[0m15:37:17.534791 [info ] [Thread-1 (]: 7 of 8 PASS not_null_stock_rsi_rsi ............................................. [[32mPASS[0m in 1.07s]
[0m15:37:17.535994 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_rsi_rsi.154ae97906
[0m15:37:17.536723 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:37:17.537440 [info ] [Thread-1 (]: 8 of 8 START test not_null_stock_rsi_symbol .................................... [RUN]
[0m15:37:17.538247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_rsi_rsi.154ae97906, now test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0)
[0m15:37:17.539004 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:37:17.545602 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"
[0m15:37:17.546885 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:37:17.550738 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"
[0m15:37:17.552373 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"
[0m15:37:17.552997 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2.analytics.stock_rsi
where symbol is null



      
    ) dbt_internal_test
[0m15:37:17.553576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:18.294828 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.741 seconds
[0m15:37:18.299501 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0: Close
[0m15:37:18.460058 [info ] [Thread-1 (]: 8 of 8 PASS not_null_stock_rsi_symbol .......................................... [[32mPASS[0m in 0.92s]
[0m15:37:18.462003 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:37:18.465237 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:18.466143 [debug] [MainThread]: Connection 'test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0' was properly closed.
[0m15:37:18.466920 [info ] [MainThread]: 
[0m15:37:18.467717 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 6.22 seconds (6.22s).
[0m15:37:18.471174 [debug] [MainThread]: Command end result
[0m15:37:18.513514 [info ] [MainThread]: 
[0m15:37:18.514604 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:37:18.515703 [info ] [MainThread]: 
[0m15:37:18.516464 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:37:18.517060 [info ] [MainThread]: 
[0m15:37:18.517721 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:37:18.518640 [info ] [MainThread]: 
[0m15:37:18.519467 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=0 TOTAL=8
[0m15:37:18.524712 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 10.002631, "process_user_time": 5.825209, "process_kernel_time": 1.334466, "process_mem_max_rss": "180850688", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:37:18.525882 [debug] [MainThread]: Command `dbt test` failed at 15:37:18.525678 after 10.00 seconds
[0m15:37:18.526589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae61160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b91cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132c6cfb0>]}
[0m15:37:18.527205 [debug] [MainThread]: Flushing usage events
[0m15:38:59.278641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c226c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcd1010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcd0cb0>]}


============================== 15:38:59.285341 | 5af3899f-0a9a-46f8-9e58-cf081f08fc59 ==============================
[0m15:38:59.285341 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:38:59.286695 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'target_path': 'None', 'empty': 'None', 'quiet': 'False', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'use_colors': 'True', 'debug': 'False', 'warn_error': 'None', 'no_print': 'None', 'version_check': 'True', 'log_format': 'default', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'printer_width': '80', 'introspect': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'fail_fast': 'False'}
[0m15:39:02.108040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5af3899f-0a9a-46f8-9e58-cf081f08fc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129fb440>]}
[0m15:39:02.195529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5af3899f-0a9a-46f8-9e58-cf081f08fc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139d1c8f0>]}
[0m15:39:02.197742 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:39:02.229480 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:39:02.497764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:39:02.498684 [debug] [MainThread]: Partial parsing: added file: stock_calc://models/packages.yml
[0m15:39:02.499540 [debug] [MainThread]: Partial parsing: updated file: stock_calc://models/schema.yml
[0m15:39:02.836112 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:39:02.836993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5af3899f-0a9a-46f8-9e58-cf081f08fc59', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb0ce00>]}
[0m15:39:03.110901 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:39:03.128767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5af3899f-0a9a-46f8-9e58-cf081f08fc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a368b30>]}
[0m15:39:03.311307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5af3899f-0a9a-46f8-9e58-cf081f08fc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a7b6db0>]}
[0m15:39:03.312045 [info ] [MainThread]: Found 3 models, 8 data tests, 3 sources, 459 macros
[0m15:39:03.312573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5af3899f-0a9a-46f8-9e58-cf081f08fc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a7750d0>]}
[0m15:39:03.315854 [info ] [MainThread]: 
[0m15:39:03.316963 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:39:03.323378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_analytics'
[0m15:39:03.346323 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:39:03.347331 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:39:03.347880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:04.195101 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.847 seconds
[0m15:39:04.201095 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:39:04.347791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5af3899f-0a9a-46f8-9e58-cf081f08fc59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a2bc380>]}
[0m15:39:04.349705 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:39:04.350841 [info ] [MainThread]: 
[0m15:39:04.356974 [debug] [Thread-1 (]: Began running node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088
[0m15:39:04.358037 [info ] [Thread-1 (]: 1 of 8 START test dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date  [RUN]
[0m15:39:04.359089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088)
[0m15:39:04.359867 [debug] [Thread-1 (]: Began compiling node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088
[0m15:39:04.393753 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:39:04.395332 [error] [Thread-1 (]: 1 of 8 ERROR dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date  [[31mERROR[0m in 0.04s]
[0m15:39:04.396769 [debug] [Thread-1 (]: Finished running node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088
[0m15:39:04.397461 [debug] [Thread-1 (]: Began running node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc
[0m15:39:04.398009 [info ] [Thread-1 (]: 2 of 8 START test dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date  [RUN]
[0m15:39:04.398659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088, now test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc)
[0m15:39:04.399185 [debug] [Thread-1 (]: Began compiling node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc
[0m15:39:04.407577 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:39:04.408395 [error] [Thread-1 (]: 2 of 8 ERROR dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date .... [[31mERROR[0m in 0.01s]
[0m15:39:04.409445 [debug] [Thread-1 (]: Finished running node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc
[0m15:39:04.410374 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:39:04.411072 [info ] [Thread-1 (]: 3 of 8 START test not_null_stock_moving_avg_date ............................... [RUN]
[0m15:39:04.411729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc, now test.stock_calc.not_null_stock_moving_avg_date.bd96888016)
[0m15:39:04.412376 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:39:04.425366 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"
[0m15:39:04.426777 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:39:04.461461 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"
[0m15:39:04.463503 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"
[0m15:39:04.464237 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_date.bd96888016: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2.analytics.stock_moving_avg
where date is null



      
    ) dbt_internal_test
[0m15:39:04.465365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:05.071930 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.606 seconds
[0m15:39:05.091166 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_date.bd96888016: Close
[0m15:39:05.235046 [info ] [Thread-1 (]: 3 of 8 PASS not_null_stock_moving_avg_date ..................................... [[32mPASS[0m in 0.82s]
[0m15:39:05.237236 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:39:05.238561 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27
[0m15:39:05.239544 [info ] [Thread-1 (]: 4 of 8 START test not_null_stock_moving_avg_moving_avg ......................... [RUN]
[0m15:39:05.240782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_moving_avg_date.bd96888016, now test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27)
[0m15:39:05.241652 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27
[0m15:39:05.249834 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27"
[0m15:39:05.251307 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27
[0m15:39:05.255323 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27"
[0m15:39:05.256939 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27"
[0m15:39:05.257484 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg
from lab2.analytics.stock_moving_avg
where moving_avg is null



      
    ) dbt_internal_test
[0m15:39:05.257968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:06.018287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.760 seconds
[0m15:39:06.023477 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27: Close
[0m15:39:06.205783 [info ] [Thread-1 (]: 4 of 8 PASS not_null_stock_moving_avg_moving_avg ............................... [[32mPASS[0m in 0.96s]
[0m15:39:06.208077 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27
[0m15:39:06.209335 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:39:06.210477 [info ] [Thread-1 (]: 5 of 8 START test not_null_stock_moving_avg_symbol ............................. [RUN]
[0m15:39:06.211570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27, now test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07)
[0m15:39:06.212423 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:39:06.222801 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"
[0m15:39:06.224169 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:39:06.319139 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"
[0m15:39:06.320719 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"
[0m15:39:06.321296 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2.analytics.stock_moving_avg
where symbol is null



      
    ) dbt_internal_test
[0m15:39:06.321822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:06.991782 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.670 seconds
[0m15:39:06.996748 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07: Close
[0m15:39:07.155079 [info ] [Thread-1 (]: 5 of 8 PASS not_null_stock_moving_avg_symbol ................................... [[32mPASS[0m in 0.94s]
[0m15:39:07.156289 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:39:07.157065 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:39:07.157812 [info ] [Thread-1 (]: 6 of 8 START test not_null_stock_rsi_date ...................................... [RUN]
[0m15:39:07.158673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07, now test.stock_calc.not_null_stock_rsi_date.5bcea16269)
[0m15:39:07.159258 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:39:07.165661 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_rsi_date.5bcea16269"
[0m15:39:07.167094 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:39:07.170822 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_rsi_date.5bcea16269"
[0m15:39:07.172537 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_rsi_date.5bcea16269"
[0m15:39:07.173149 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_date.5bcea16269: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_rsi_date.5bcea16269"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2.analytics.stock_rsi
where date is null



      
    ) dbt_internal_test
[0m15:39:07.173653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:07.754061 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.580 seconds
[0m15:39:07.757782 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_date.5bcea16269: Close
[0m15:39:07.899518 [info ] [Thread-1 (]: 6 of 8 PASS not_null_stock_rsi_date ............................................ [[32mPASS[0m in 0.74s]
[0m15:39:07.901642 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:39:07.902909 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_rsi_moving_avg.09442a572d
[0m15:39:07.904147 [info ] [Thread-1 (]: 7 of 8 START test not_null_stock_rsi_moving_avg ................................ [RUN]
[0m15:39:07.905255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_rsi_date.5bcea16269, now test.stock_calc.not_null_stock_rsi_moving_avg.09442a572d)
[0m15:39:07.906082 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_rsi_moving_avg.09442a572d
[0m15:39:07.914744 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_rsi_moving_avg.09442a572d"
[0m15:39:07.916339 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_rsi_moving_avg.09442a572d
[0m15:39:07.920116 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_rsi_moving_avg.09442a572d"
[0m15:39:07.921735 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_rsi_moving_avg.09442a572d"
[0m15:39:07.922396 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_moving_avg.09442a572d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_rsi_moving_avg.09442a572d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg
from lab2.analytics.stock_rsi
where moving_avg is null



      
    ) dbt_internal_test
[0m15:39:07.922910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:08.554148 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b854eb-0004-26aa-0002-65f300014556
[0m15:39:08.555227 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MOVING_AVG'
[0m15:39:08.556348 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_moving_avg.09442a572d: Close
[0m15:39:08.707299 [debug] [Thread-1 (]: Database Error in test not_null_stock_rsi_moving_avg (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MOVING_AVG'
  compiled code at target/run/stock_calc/models/schema.yml/not_null_stock_rsi_moving_avg.sql
[0m15:39:08.708654 [error] [Thread-1 (]: 7 of 8 ERROR not_null_stock_rsi_moving_avg ..................................... [[31mERROR[0m in 0.80s]
[0m15:39:08.710106 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_rsi_moving_avg.09442a572d
[0m15:39:08.711472 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:39:08.712484 [info ] [Thread-1 (]: 8 of 8 START test not_null_stock_rsi_symbol .................................... [RUN]
[0m15:39:08.714455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_rsi_moving_avg.09442a572d, now test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0)
[0m15:39:08.715836 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:39:08.726219 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"
[0m15:39:08.727708 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:39:08.731539 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"
[0m15:39:08.733121 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"
[0m15:39:08.733732 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2.analytics.stock_rsi
where symbol is null



      
    ) dbt_internal_test
[0m15:39:08.734226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:09.366465 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.632 seconds
[0m15:39:09.372037 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0: Close
[0m15:39:09.506430 [info ] [Thread-1 (]: 8 of 8 PASS not_null_stock_rsi_symbol .......................................... [[32mPASS[0m in 0.79s]
[0m15:39:09.508038 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:39:09.510863 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:09.511642 [debug] [MainThread]: Connection 'test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0' was properly closed.
[0m15:39:09.512397 [info ] [MainThread]: 
[0m15:39:09.513274 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 6.20 seconds (6.20s).
[0m15:39:09.516659 [debug] [MainThread]: Command end result
[0m15:39:09.563334 [info ] [MainThread]: 
[0m15:39:09.564291 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:39:09.564799 [info ] [MainThread]: 
[0m15:39:09.565390 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:39:09.565854 [info ] [MainThread]: 
[0m15:39:09.566550 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:39:09.567113 [info ] [MainThread]: 
[0m15:39:09.567665 [error] [MainThread]:   Database Error in test not_null_stock_rsi_moving_avg (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MOVING_AVG'
  compiled code at target/run/stock_calc/models/schema.yml/not_null_stock_rsi_moving_avg.sql
[0m15:39:09.568132 [info ] [MainThread]: 
[0m15:39:09.568609 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=3 SKIP=0 TOTAL=8
[0m15:39:09.573790 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 10.405698, "process_user_time": 6.29091, "process_kernel_time": 1.330382, "process_mem_max_rss": "185180160", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:39:09.574743 [debug] [MainThread]: Command `dbt test` failed at 15:39:09.574571 after 10.41 seconds
[0m15:39:09.575340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcd0d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcd3b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a606150>]}
[0m15:39:09.575846 [debug] [MainThread]: Flushing usage events
[0m15:39:40.345809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096c9f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc4d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc4cd40>]}


============================== 15:39:40.362655 | cd912032-1dcd-466d-a504-456a00ca46d0 ==============================
[0m15:39:40.362655 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:39:40.363755 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'no_print': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'introspect': 'True', 'empty': 'None', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'invocation_command': 'dbt test', 'log_format': 'default', 'use_experimental_parser': 'False', 'debug': 'False', 'write_json': 'True', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'use_colors': 'True', 'quiet': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'partial_parse': 'True', 'printer_width': '80'}
[0m15:39:42.534263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd912032-1dcd-466d-a504-456a00ca46d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138c587d0>]}
[0m15:39:42.624040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd912032-1dcd-466d-a504-456a00ca46d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138a26780>]}
[0m15:39:42.625286 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:39:42.638990 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m15:39:42.643323 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.4057264, "process_user_time": 3.902667, "process_kernel_time": 1.005412, "process_mem_max_rss": "163553280", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:39:42.644590 [debug] [MainThread]: Command `dbt test` failed at 15:39:42.644376 after 2.41 seconds
[0m15:39:42.645394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c62d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8fcd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffcc470>]}
[0m15:39:42.646061 [debug] [MainThread]: Flushing usage events
[0m15:40:09.293232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066931d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107384cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107384950>]}


============================== 15:40:09.315960 | cc57e7f8-d7ab-4adf-96f0-8b1ffe8559f2 ==============================
[0m15:40:09.315960 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:40:09.317057 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'introspect': 'True', 'log_format': 'default', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt deps', 'use_colors': 'True', 'empty': 'None', 'version_check': 'True', 'fail_fast': 'False', 'target_path': 'None', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'no_print': 'None'}
[0m15:40:09.635491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc57e7f8-d7ab-4adf-96f0-8b1ffe8559f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10739b470>]}
[0m15:40:09.663310 [debug] [MainThread]: Set downloads directory='/var/folders/86/pc55x0t57pb6bfn08qrl0xx00000gn/T/dbt-downloads-xwfphzo0'
[0m15:40:09.664187 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:40:09.997321 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:40:09.998436 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:40:10.091660 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:40:10.108731 [info ] [MainThread]: Updating lock file in file path: /Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/package-lock.yml
[0m15:40:10.111541 [debug] [MainThread]: Set downloads directory='/var/folders/86/pc55x0t57pb6bfn08qrl0xx00000gn/T/dbt-downloads-e3zcz1pb'
[0m15:40:10.116835 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:40:10.556216 [info ] [MainThread]: Installed from version 1.3.0
[0m15:40:10.556954 [info ] [MainThread]: Up to date!
[0m15:40:10.557611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cc57e7f8-d7ab-4adf-96f0-8b1ffe8559f2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10746be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107474500>]}
[0m15:40:10.560785 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.3654246, "process_user_time": 2.251895, "process_kernel_time": 0.465894, "process_mem_max_rss": "97169408", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:40:10.561893 [debug] [MainThread]: Command `dbt deps` succeeded at 15:40:10.561686 after 1.37 seconds
[0m15:40:10.562556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107469a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b3260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10739b470>]}
[0m15:40:10.563159 [debug] [MainThread]: Flushing usage events
[0m15:40:17.802273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd1e6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0a9070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0a8d40>]}


============================== 15:40:17.809294 | 17420797-6fa4-471c-86d8-13c1d7e1248f ==============================
[0m15:40:17.809294 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:40:17.810404 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/stock_calc/logs', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/Users/jiyoonlee/.dbt', 'version_check': 'True', 'printer_width': '80', 'introspect': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt test', 'empty': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'static_parser': 'True', 'log_format': 'default', 'write_json': 'True', 'fail_fast': 'False'}
[0m15:40:20.048389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17420797-6fa4-471c-86d8-13c1d7e1248f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a4e8a40>]}
[0m15:40:20.180943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17420797-6fa4-471c-86d8-13c1d7e1248f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be80170>]}
[0m15:40:20.183155 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:40:20.234141 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:40:20.489727 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:40:20.490845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '17420797-6fa4-471c-86d8-13c1d7e1248f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d654170>]}
[0m15:40:22.920847 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:40:22.921734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '17420797-6fa4-471c-86d8-13c1d7e1248f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a4bba70>]}
[0m15:40:23.490919 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_calc.intput
[0m15:40:23.506885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17420797-6fa4-471c-86d8-13c1d7e1248f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a6123f0>]}
[0m15:40:23.700692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17420797-6fa4-471c-86d8-13c1d7e1248f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ab7a6c0>]}
[0m15:40:23.701481 [info ] [MainThread]: Found 3 models, 8 data tests, 3 sources, 575 macros
[0m15:40:23.702047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17420797-6fa4-471c-86d8-13c1d7e1248f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a7a0c80>]}
[0m15:40:23.705712 [info ] [MainThread]: 
[0m15:40:23.706903 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:40:23.713903 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_analytics'
[0m15:40:23.742668 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m15:40:23.743441 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m15:40:23.743967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:24.440593 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.696 seconds
[0m15:40:24.446823 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m15:40:24.593898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17420797-6fa4-471c-86d8-13c1d7e1248f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13abb4830>]}
[0m15:40:24.594965 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:40:24.595609 [info ] [MainThread]: 
[0m15:40:24.600415 [debug] [Thread-1 (]: Began running node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088
[0m15:40:24.601260 [info ] [Thread-1 (]: 1 of 8 START test dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date  [RUN]
[0m15:40:24.602148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088)
[0m15:40:24.602860 [debug] [Thread-1 (]: Began compiling node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088
[0m15:40:24.616909 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088"
[0m15:40:24.618782 [debug] [Thread-1 (]: Began executing node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088
[0m15:40:24.652910 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088"
[0m15:40:24.654600 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088"
[0m15:40:24.655209 [debug] [Thread-1 (]: On test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        symbol, date
    from lab2.analytics.stock_moving_avg
    group by symbol, date
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m15:40:24.655719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:25.315471 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.659 seconds
[0m15:40:25.334642 [debug] [Thread-1 (]: On test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088: Close
[0m15:40:25.467170 [info ] [Thread-1 (]: 1 of 8 PASS dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date  [[32mPASS[0m in 0.86s]
[0m15:40:25.468327 [debug] [Thread-1 (]: Finished running node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088
[0m15:40:25.469028 [debug] [Thread-1 (]: Began running node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc
[0m15:40:25.469699 [info ] [Thread-1 (]: 2 of 8 START test dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date  [RUN]
[0m15:40:25.470439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.dbt_utils_unique_combination_of_columns_stock_moving_avg_symbol__date.6136dbf088, now test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc)
[0m15:40:25.470998 [debug] [Thread-1 (]: Began compiling node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc
[0m15:40:25.477013 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc"
[0m15:40:25.478209 [debug] [Thread-1 (]: Began executing node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc
[0m15:40:25.481829 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc"
[0m15:40:25.483447 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc"
[0m15:40:25.484057 [debug] [Thread-1 (]: On test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        symbol, date
    from lab2.analytics.stock_rsi
    group by symbol, date
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m15:40:25.484584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:26.144589 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.660 seconds
[0m15:40:26.147463 [debug] [Thread-1 (]: On test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc: Close
[0m15:40:26.302992 [info ] [Thread-1 (]: 2 of 8 PASS dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date ..... [[32mPASS[0m in 0.83s]
[0m15:40:26.305028 [debug] [Thread-1 (]: Finished running node test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc
[0m15:40:26.306494 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:40:26.307529 [info ] [Thread-1 (]: 3 of 8 START test not_null_stock_moving_avg_date ............................... [RUN]
[0m15:40:26.308656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.dbt_utils_unique_combination_of_columns_stock_rsi_symbol__date.ab7b99e5dc, now test.stock_calc.not_null_stock_moving_avg_date.bd96888016)
[0m15:40:26.309521 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:40:26.324102 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"
[0m15:40:26.326030 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:40:26.330231 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"
[0m15:40:26.331761 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"
[0m15:40:26.332339 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_date.bd96888016: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_moving_avg_date.bd96888016"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2.analytics.stock_moving_avg
where date is null



      
    ) dbt_internal_test
[0m15:40:26.332848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:27.004368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m15:40:27.009770 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_date.bd96888016: Close
[0m15:40:27.173552 [info ] [Thread-1 (]: 3 of 8 PASS not_null_stock_moving_avg_date ..................................... [[32mPASS[0m in 0.86s]
[0m15:40:27.175181 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_moving_avg_date.bd96888016
[0m15:40:27.176184 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27
[0m15:40:27.177024 [info ] [Thread-1 (]: 4 of 8 START test not_null_stock_moving_avg_moving_avg ......................... [RUN]
[0m15:40:27.178356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_moving_avg_date.bd96888016, now test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27)
[0m15:40:27.179144 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27
[0m15:40:27.186710 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27"
[0m15:40:27.190156 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27
[0m15:40:27.194236 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27"
[0m15:40:27.196923 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27"
[0m15:40:27.197573 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg
from lab2.analytics.stock_moving_avg
where moving_avg is null



      
    ) dbt_internal_test
[0m15:40:27.198083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:27.824287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.626 seconds
[0m15:40:27.829523 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27: Close
[0m15:40:27.972792 [info ] [Thread-1 (]: 4 of 8 PASS not_null_stock_moving_avg_moving_avg ............................... [[32mPASS[0m in 0.79s]
[0m15:40:27.974084 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27
[0m15:40:27.974899 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:40:27.975681 [info ] [Thread-1 (]: 5 of 8 START test not_null_stock_moving_avg_symbol ............................. [RUN]
[0m15:40:27.976390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_moving_avg_moving_avg.cdf04a8a27, now test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07)
[0m15:40:27.977048 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:40:27.983834 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"
[0m15:40:27.986710 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:40:27.990413 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"
[0m15:40:27.992935 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"
[0m15:40:27.993742 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2.analytics.stock_moving_avg
where symbol is null



      
    ) dbt_internal_test
[0m15:40:27.994325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:28.620843 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.626 seconds
[0m15:40:28.626090 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07: Close
[0m15:40:28.761235 [info ] [Thread-1 (]: 5 of 8 PASS not_null_stock_moving_avg_symbol ................................... [[32mPASS[0m in 0.78s]
[0m15:40:28.763586 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07
[0m15:40:28.765025 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:40:28.766283 [info ] [Thread-1 (]: 6 of 8 START test not_null_stock_rsi_date ...................................... [RUN]
[0m15:40:28.767723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_moving_avg_symbol.6c4806ad07, now test.stock_calc.not_null_stock_rsi_date.5bcea16269)
[0m15:40:28.768644 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:40:28.776799 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_rsi_date.5bcea16269"
[0m15:40:28.778832 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:40:28.782844 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_rsi_date.5bcea16269"
[0m15:40:28.785291 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_rsi_date.5bcea16269"
[0m15:40:28.785982 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_date.5bcea16269: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_rsi_date.5bcea16269"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2.analytics.stock_rsi
where date is null



      
    ) dbt_internal_test
[0m15:40:28.786552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:29.330803 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.544 seconds
[0m15:40:29.336277 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_date.5bcea16269: Close
[0m15:40:29.486700 [info ] [Thread-1 (]: 6 of 8 PASS not_null_stock_rsi_date ............................................ [[32mPASS[0m in 0.72s]
[0m15:40:29.488629 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_rsi_date.5bcea16269
[0m15:40:29.489832 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_rsi_rsi.154ae97906
[0m15:40:29.491061 [info ] [Thread-1 (]: 7 of 8 START test not_null_stock_rsi_rsi ....................................... [RUN]
[0m15:40:29.492210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_rsi_date.5bcea16269, now test.stock_calc.not_null_stock_rsi_rsi.154ae97906)
[0m15:40:29.493287 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_rsi_rsi.154ae97906
[0m15:40:29.504155 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_rsi_rsi.154ae97906"
[0m15:40:29.506405 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_rsi_rsi.154ae97906
[0m15:40:29.510705 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_rsi_rsi.154ae97906"
[0m15:40:29.513022 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_rsi_rsi.154ae97906"
[0m15:40:29.513773 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_rsi.154ae97906: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_rsi_rsi.154ae97906"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi
from lab2.analytics.stock_rsi
where rsi is null



      
    ) dbt_internal_test
[0m15:40:29.514396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:30.039807 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.525 seconds
[0m15:40:30.045130 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_rsi.154ae97906: Close
[0m15:40:30.198229 [info ] [Thread-1 (]: 7 of 8 PASS not_null_stock_rsi_rsi ............................................. [[32mPASS[0m in 0.71s]
[0m15:40:30.200469 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_rsi_rsi.154ae97906
[0m15:40:30.201784 [debug] [Thread-1 (]: Began running node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:40:30.202856 [info ] [Thread-1 (]: 8 of 8 START test not_null_stock_rsi_symbol .................................... [RUN]
[0m15:40:30.204013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_calc.not_null_stock_rsi_rsi.154ae97906, now test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0)
[0m15:40:30.204860 [debug] [Thread-1 (]: Began compiling node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:40:30.213158 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"
[0m15:40:30.214461 [debug] [Thread-1 (]: Began executing node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:40:30.218505 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"
[0m15:40:30.220022 [debug] [Thread-1 (]: Using snowflake connection "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"
[0m15:40:30.220603 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_calc", "target_name": "dev", "node_id": "test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2.analytics.stock_rsi
where symbol is null



      
    ) dbt_internal_test
[0m15:40:30.221096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:30.819530 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.598 seconds
[0m15:40:30.823264 [debug] [Thread-1 (]: On test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0: Close
[0m15:40:30.964749 [info ] [Thread-1 (]: 8 of 8 PASS not_null_stock_rsi_symbol .......................................... [[32mPASS[0m in 0.76s]
[0m15:40:30.966351 [debug] [Thread-1 (]: Finished running node test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0
[0m15:40:30.968740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:30.969434 [debug] [MainThread]: Connection 'test.stock_calc.not_null_stock_rsi_symbol.21d458c7e0' was properly closed.
[0m15:40:30.970005 [info ] [MainThread]: 
[0m15:40:30.970594 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 7.26 seconds (7.26s).
[0m15:40:30.973248 [debug] [MainThread]: Command end result
[0m15:40:31.031938 [info ] [MainThread]: 
[0m15:40:31.032725 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:40:31.033355 [info ] [MainThread]: 
[0m15:40:31.034159 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m15:40:31.038491 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 13.34247, "process_user_time": 9.198531, "process_kernel_time": 1.234032, "process_mem_max_rss": "184553472", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:40:31.039708 [debug] [MainThread]: Command `dbt test` succeeded at 15:40:31.039414 after 13.34 seconds
[0m15:40:31.040769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0a8d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0a8d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0a9070>]}
[0m15:40:31.041920 [debug] [MainThread]: Flushing usage events
[0m16:20:41.441976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af510d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba24ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba24620>]}


============================== 16:20:41.480116 | 7a44f5c0-af74-4c4b-aaa2-86d7c28d8c35 ==============================
[0m16:20:41.480116 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:20:41.481240 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'version_check': 'True', 'use_colors': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'target_path': 'None', 'profiles_dir': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/airflow/dbt', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt clean', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'write_json': 'True', 'debug': 'False', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/airflow/dbt/logs', 'warn_error': 'None'}
[0m16:20:41.959584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a44f5c0-af74-4c4b-aaa2-86d7c28d8c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afbca40>]}
[0m16:20:42.152471 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.8347701, "process_user_time": 2.292486, "process_kernel_time": 0.672158, "process_mem_max_rss": "94781440", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:20:42.154257 [debug] [MainThread]: Command `dbt clean` succeeded at 16:20:42.153838 after 0.84 seconds
[0m16:20:42.155459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afbca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8a11c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba24560>]}
[0m16:20:42.156644 [debug] [MainThread]: Flushing usage events
[0m16:21:42.331290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051cd130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ca5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ca4d70>]}


============================== 16:21:42.365663 | 3613673b-f7d2-4263-a87f-68f5ecb712ce ==============================
[0m16:21:42.365663 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:21:42.367891 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'static_parser': 'True', 'debug': 'False', 'version_check': 'True', 'printer_width': '80', 'write_json': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'cache_selected_only': 'False', 'introspect': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/airflow/dbt/logs', 'partial_parse': 'True', 'no_print': 'None', 'profiles_dir': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True'}
[0m16:21:42.790478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3613673b-f7d2-4263-a87f-68f5ecb712ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d1bd70>]}
[0m16:21:42.833128 [debug] [MainThread]: Set downloads directory='/var/folders/86/pc55x0t57pb6bfn08qrl0xx00000gn/T/dbt-downloads-_3wiqvyi'
[0m16:21:42.833822 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:21:43.063481 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:21:43.064623 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:21:43.145761 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:21:43.158526 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:21:43.746452 [info ] [MainThread]: Installed from version 1.3.0
[0m16:21:43.747847 [info ] [MainThread]: Up to date!
[0m16:21:43.749436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3613673b-f7d2-4263-a87f-68f5ecb712ce', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dd8bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dda720>]}
[0m16:21:43.756740 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.5556943, "process_user_time": 2.44381, "process_kernel_time": 0.766588, "process_mem_max_rss": "97173504", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:21:43.758256 [debug] [MainThread]: Command `dbt deps` succeeded at 16:21:43.757950 after 1.56 seconds
[0m16:21:43.759245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ffc440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c4c6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ca4c50>]}
[0m16:21:43.760181 [debug] [MainThread]: Flushing usage events
[0m13:54:18.189439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a085460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca50e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca509e0>]}


============================== 13:54:18.211765 | 4597a86b-cb22-49f7-80d6-25c80e98e4b4 ==============================
[0m13:54:18.211765 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:54:18.213069 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'printer_width': '80', 'profiles_dir': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/airflow/dbt', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'version_check': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'empty': 'None', 'invocation_command': 'dbt clean', 'target_path': 'None', 'quiet': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/Users/jiyoonlee/Desktop/DATA 226/LAB2/airflow/dbt/logs'}
[0m13:54:18.712936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4597a86b-cb22-49f7-80d6-25c80e98e4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cad0350>]}
[0m13:54:18.754735 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.6981944, "process_user_time": 2.40728, "process_kernel_time": 0.673551, "process_mem_max_rss": "94388224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:54:18.755772 [debug] [MainThread]: Command `dbt clean` succeeded at 13:54:18.755573 after 0.70 seconds
[0m13:54:18.756643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5695e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c482c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd45c40>]}
[0m13:54:18.757270 [debug] [MainThread]: Flushing usage events
